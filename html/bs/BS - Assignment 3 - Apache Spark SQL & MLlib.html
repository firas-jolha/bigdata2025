<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        BS - Assignment 3 - Apache Spark SQL &amp; MLlib - CodiMD
    </title>
    <link rel="icon" type="image/png" href="http://localhost:3000/favicon.png">
    <link rel="apple-touch-icon" href="http://localhost:3000/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/css/bootstrap.min.css" integrity="sha256-H0KfTigpUV+0/5tn2HXC0CPwhhDhWgSawJdnFd0CGCo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fork-awesome/1.1.3/css/fork-awesome.min.css" integrity="sha256-ZhApazu+kejqTYhMF+1DzNKjIzP7KXu6AzyXcC1gMus=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.night .markdown-body blockquote{color:#bcbcbc}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.night .markdown-body h1,.night .markdown-body h2,.night .markdown-body h3,.night .markdown-body h4,.night .markdown-body h5,.night .markdown-body h6{color:#ddd}.markdown-body h1 .fa-link,.markdown-body h2 .fa-link,.markdown-body h3 .fa-link,.markdown-body h4 .fa-link,.markdown-body h5 .fa-link,.markdown-body h6 .fa-link{color:#000;vertical-align:middle;visibility:hidden;font-size:16px}.night .markdown-body h1 .fa-link,.night .markdown-body h2 .fa-link,.night .markdown-body h3 .fa-link,.night .markdown-body h4 .fa-link,.night .markdown-body h5 .fa-link,.night .markdown-body h6 .fa-link{color:#fff}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .fa-link,.markdown-body h2:hover .anchor .fa-link,.markdown-body h3:hover .anchor .fa-link,.markdown-body h4:hover .anchor .fa-link,.markdown-body h5:hover .anchor .fa-link,.markdown-body h6:hover .anchor .fa-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.night .markdown-body table tr{background-color:#5f5f5f}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.night .markdown-body table tr:nth-child(2n){background-color:#4f4f4f}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.night .markdown-body code,.night .markdown-body tt{color:#eee;background-color:hsla(0,0%,90.2%,.36)}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.night .markdown-body pre{filter:invert(100%)}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-webkit-inline-flex;display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.night .markdown-body .gist table tr:nth-child(2n){background-color:#ddd}.markdown-body code[data-gist-id]{background:none;padding:0;filter:invert(100%)}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.geo,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.night .markdown-body pre.graphviz .graph>polygon{fill:#333}.night .markdown-body pre.mermaid .sectionTitle,.night .markdown-body pre.mermaid .titleText,.night .markdown-body pre.mermaid text{fill:#fff}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.night .markdown-body .abc path{fill:#eee}.night .markdown-body .abc path.note_selected{fill:##4DD0E1}.night tspan{fill:#fefefe}.night pre rect{fill:transparent}.night pre.flow-chart path,.night pre.flow-chart rect{stroke:#fff}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body img{background-color:transparent}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;-webkit-transition:opacity .2s;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;-webkit-transition:opacity .2s;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.geo-map{width:100%;height:250px}.markmap-container{height:300px}.markmap-container>svg{width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.9;background-color:#ccc;border:none}.ui-toc-label,.ui-toc .open .ui-toc-label{-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#5f5f5f}.ui-toc-label:focus{opacity:1;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.night .ui-toc-dropdown .nav>li>a:focus,.night .ui-toc-dropdown .nav>li>a:hover{color:#fff;border-left-color:#fff}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.night .ui-toc-dropdown .nav>.active:focus>a,.night .ui-toc-dropdown .nav>.active:hover>a,.night .ui-toc-dropdown .nav>.active>a{color:#fff;border-left:2px solid #fff}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.night .ui-toc-dropdown .nav>li>a{color:#aaa}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:50px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a{padding-right:50px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:60px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a{padding-right:60px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:hover{padding-left:49px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:hover{padding-right:49px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-left:59px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-right:59px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>a{padding-left:48px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:48px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active>a{padding-left:58px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:58px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,"\30D2\30E9\30AE\30CE\89D2\30B4   Pro W3",Osaka,Meiryo,"\30E1\30A4\30EA\30AA",MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,"\5FAE\8EDF\6B63\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,"\5FAE\8EDF\6B63\9ED1UI",sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,"\5FAE\8F6F\96C5\9ED1UI",sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:rgba(0,0,0,.85)}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown{display:inline-block}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}.night .navbar{background:#333;border-bottom-color:#333;color:#eee}.night .navbar a{color:#eee}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid" lang="en"><h1 id="Assignment-3---Apache-Spark-SQL-amp-MLlib"><a class="anchor hidden-xs" href="#Assignment-3---Apache-Spark-SQL-amp-MLlib" title="Assignment-3---Apache-Spark-SQL-amp-MLlib"><i class="fa fa-link"></i></a>Assignment 3 - Apache Spark SQL &amp; MLlib</h1><p><strong>Course:</strong> Big Data - IU S25<br>
<strong>Author:</strong> Firas Jolha</p><h1 id="Dataset"><a class="anchor hidden-xs" href="#Dataset" title="Dataset"><i class="fa fa-link"></i></a>Dataset</h1><ul>
<li>A large-scale Amazon Reviews dataset, collected in 2023 by <a href="https://cseweb.ucsd.edu/~jmcauley/" target="_blank" rel="noopener">McAuley Lab</a> (~2.90GB)
<ul>
<li><a href="https://disk.yandex.com/d/h57o52NIbnc3_w" target="_blank" rel="noopener">products.jsonl</a></li>
<li><a href="https://disk.yandex.com/d/UiFMLGD4P-eURg" target="_blank" rel="noopener">reviews.jsonl</a></li>
</ul>
</li>
</ul><h1 id="Assignment-3-Colab-notebook"><a class="anchor hidden-xs" href="#Assignment-3-Colab-notebook" title="Assignment-3-Colab-notebook"><i class="fa fa-link"></i></a>Assignment 3 Colab notebook</h1><ul>
<li><a href="https://colab.research.google.com/drive/1nQmWEFqjy4Kj3K7w-RyJjNh59uBTFWx_?usp=sharing" target="_blank" rel="noopener">notebook template</a></li>
</ul><h1 id="Moodle-submission"><a class="anchor hidden-xs" href="#Moodle-submission" title="Moodle-submission"><i class="fa fa-link"></i></a>Moodle submission</h1><ul>
<li><a href="https://moodle.innopolis.university/mod/assign/view.php?id=127561" target="_blank" rel="noopener">https://moodle.innopolis.university/mod/assign/view.php?id=127561</a></li>
</ul><h1 id="Agenda"><a class="anchor hidden-xs" href="#Agenda" title="Agenda"><i class="fa fa-link"></i></a>Agenda</h1><p></p><div class="toc"><ul>
<li><a href="#Assignment-3---Apache-Spark-SQL-amp-MLlib" title="Assignment 3 - Apache Spark SQL &amp; MLlib">Assignment 3 - Apache Spark SQL &amp; MLlib</a></li>
<li><a href="#Dataset" title="Dataset">Dataset</a></li>
<li><a href="#Assignment-3-Colab-notebook" title="Assignment 3 Colab notebook">Assignment 3 Colab notebook</a></li>
<li><a href="#Moodle-submission" title="Moodle submission">Moodle submission</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li><a href="#Instructions" title="Instructions">Instructions</a></li>
<li><a href="#Assignment-Description" title="Assignment Description">Assignment Description</a></li>
<li><a href="#Dataset-Description" title="Dataset Description">Dataset Description</a></li>
<li><a href="#40-points-Tasks-on-Spark-DataFrame" title="[40 points] Tasks on Spark DataFrame">[40 points] Tasks on Spark DataFrame</a></li>
<li><a href="#15-points-Tasks-on-Spark-SQL" title="[15 points] Tasks on Spark SQL">[15 points] Tasks on Spark SQL</a></li>
<li><a href="#45-points-Tasks-on-Spark-ML-library" title="[45 points] Tasks on Spark ML library">[45 points] Tasks on Spark ML library</a></li>
</ul>
</div><p></p><h1 id="Prerequisites"><a class="anchor hidden-xs" href="#Prerequisites" title="Prerequisites"><i class="fa fa-link"></i></a>Prerequisites</h1><ul>
<li>Google account for Colab notebook</li>
</ul><h1 id="Instructions"><a class="anchor hidden-xs" href="#Instructions" title="Instructions"><i class="fa fa-link"></i></a>Instructions</h1><p>In this assignment, you will work on Colab and you must use the notebook template shared with you above. In the template, you can see how it installs PySpark and publishes the Spark UI using localtunnel. Here, you work on a Colab notebook and you need to submit only the notebook as <code>.ipynb</code> to Moodle.</p><div class="alert alert-danger">
<p><strong>Important notes:</strong></p>
<ol>
<li>The cells of the notebook should be executed and also should have outputs. The cells which do not have an output or not executed or edited but not executed again will <strong>not</strong> be evaluated.</li>
<li>Each cell should have at least an execution order and an output (if it gives an output).</li>
<li>The assignment is individual and the student is <strong>NOT</strong> allowed to copy from their colleagues nor from AI-based support tools like chatgpt. The <em>plagiarism detection</em> will be strictly applied in this assignment. Any plaigarized submission will get zero points and an appropriate action will be taken.</li>
</ol>
</div><div class="alert alert-warning">
<p><strong>Note:</strong> In this assignment, you do not work on the whole dataset files. You must take a 10% sample of the products dataframe and use it for analysis where your <strong>SID</strong> will be utilized as seed for the random state of the <code>pyspark.sql.DataFrame.sample</code> function. The shared notebook contains the code snippets to take the sample as follows:</p>
<pre><code class="wrap python hljs"><span class="hljs-comment"># df_products is the dataframe after successfully reading it from the file products.jsonl using the schema</span>
<span class="hljs-comment"># Rename some columns</span>
df_products = df_products.withColumnsRenamed(
    {
      <span class="hljs-string">"title"</span>: <span class="hljs-string">"product_title"</span>,
      <span class="hljs-string">"images"</span>: <span class="hljs-string">"product_images"</span>
    }
)


df_products_sample = df_products.sample(withReplacement=<span class="hljs-literal">False</span>, fraction = <span class="hljs-number">0.1</span>, seed = SID)

<span class="hljs-comment"># Now you can delete the original dataframe</span>
<span class="hljs-keyword">del</span> df_products 
</code></pre>
<pre><code class="wrap python hljs"><span class="hljs-comment"># df_reviews is the dataframe after successfully reading it from the file reviews.jsonl using the schema</span>
<span class="hljs-comment"># Rename some columns</span>
df_reviews = df_reviews.withColumnsRenamed(
    {
      <span class="hljs-string">"title"</span>: <span class="hljs-string">"review_title"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"review_text"</span>,
      <span class="hljs-string">"timestamp"</span>: <span class="hljs-string">"review_timestamp"</span>,
      <span class="hljs-string">"images"</span>: <span class="hljs-string">"reviewed_product_images"</span>
     }
)

cols = df_reviews.columns


<span class="hljs-comment"># Find the reviews of this dataframe</span>
df_reviews_sample = df_reviews.join(df_products_sample, on=<span class="hljs-string">'parent_asin'</span>,how=<span class="hljs-string">'inner'</span>).select(cols)

<span class="hljs-comment"># Now you can delete the original dataframe</span>
<span class="hljs-keyword">del</span> df_reviews

<span class="hljs-comment"># Now you must use only these samples for all analysis tasks.</span>
</code></pre>
</div><h1 id="Assignment-Description"><a class="anchor hidden-xs" href="#Assignment-Description" title="Assignment-Description"><i class="fa fa-link"></i></a>Assignment Description</h1><p>This assignment will be dedicated to practise on Apache Spark SQL and machine learning libraries. For this task, you can use the <code>pyspark.sql</code>, the legacy RDD-based MLlib in <code>pyspark.mllib</code> and DataFrame-based MLlib <code>pyspark.ml</code> for Python. You have to work on tasks dedicated for data analysis using Spark SQL and predictive analysis using different ML tasks on the same dataset. You also need to train a recommendation system for suggesting products to Amazon users. You have to work on a sample of Amazon products dataset.</p><center>
<img src="https://i.imgur.com/1aUDHcs.png" width="250">
</center><p>The dataset includes Amazon users who rated <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1465-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>=</mo><mn>137</mn><mo>,</mo><mn>269</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4725" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.391em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1005.34em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-4726"><span class="mi" id="MathJax-Span-4727" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-4728" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-4729" style="font-family: MathJax_Main; padding-left: 0.272em;">137</span><span class="mo" id="MathJax-Span-4730" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4731" style="font-family: MathJax_Main; padding-left: 0.164em;">269</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mn>137</mn><mo>,</mo><mn>269</mn></math></span></span><script type="math/tex" id="MathJax-Element-1465">n=137,269</script></span> products and added <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1466-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo>=</mo><mn>4</mn><mo>,</mo><mn>624</mn><mo>,</mo><mn>615</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4732" style="width: 7.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.145em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1006.09em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-4733"><span class="mi" id="MathJax-Span-4734" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-4735" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-4736" style="font-family: MathJax_Main; padding-left: 0.272em;">4</span><span class="mo" id="MathJax-Span-4737" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4738" style="font-family: MathJax_Main; padding-left: 0.164em;">624</span><span class="mo" id="MathJax-Span-4739" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4740" style="font-family: MathJax_Main; padding-left: 0.164em;">615</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>4</mn><mo>,</mo><mn>624</mn><mo>,</mo><mn>615</mn></math></span></span><script type="math/tex" id="MathJax-Element-1466">r=4,624,615</script></span> reviews. Check the description of the datasets below.</p><h1 id="Dataset-Description"><a class="anchor hidden-xs" href="#Dataset-Description" title="Dataset-Description"><i class="fa fa-link"></i></a>Dataset Description</h1><p>This dataset consists of two <code>jsonl</code> files. <code>reviews.jsonl</code> contains users’ reviews for products on Amazon. <code>products.jsonl</code> contains the product metadata. The description of fields in <code>reviews.jsonl</code> as follows:</p><ul>
<li><em>rating</em> (float) - Rating of the product (from 1.0 to 5.0).</li>
<li><em>title</em> (str) - Title of the user review.</li>
<li><em>text</em> (str) - Text body of the user review.</li>
<li><em>images</em> (list) - Images that users post after they have received the product. Each image has different sizes (small, medium, large), represented by the small_image_url, medium_image_url, and large_image_url respectively.</li>
<li><em>asin</em> (str) - ID of the product.</li>
<li><em>parent_asin</em> (str) - Parent ID of the product. Note: Products with different colors, styles, sizes usually belong to the same parent ID. Please use this parent ID to find a product meta (join column with the products table).</li>
<li><em>user_id</em> (str) - ID of the reviewer</li>
<li><em>timestamp</em> (int) - Time of the review (unix time)</li>
<li><em>verified_purchase</em> (bool) - User purchase verification</li>
<li><em>helpful_vote</em> (int) - Helpful votes of the review</li>
</ul><p>You can see below a sample of 10 records of the file <code>reviews.jsonl</code></p><pre><code class="json hljs">{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">4.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"It\u2019s pretty sexual. Not my fav"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"I\u2019m playing on ps5 and it\u2019s interesting.  It\u2019s unique, massive, and has a neat story.  People are freaking out angry about this game.  I don\u2019t think it\u2019s a top 10 game but it\u2019s definitely a good game on ps5 (played at launch)."</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B07DJWBYKP"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B07DK1H3H5"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AGCI7FAH4GL5FI65HYLKWTMFZ2CQ"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1608186804795</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Good. A bit slow"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"Nostalgic fun.  A bit slow.  I hope they don\u2019t stretch it out too far.  It\u2019s good tho"</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B00ZS80PC2"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B07SRWRH5D"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AGCI7FAH4GL5FI65HYLKWTMFZ2CQ"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1587051114941</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">false</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"... an order for my kids &amp; they have really enjoyed playing this PC game"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"This was an order for my kids &amp; they have really enjoyed playing this PC game."</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B01FEHJYUU"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B07MFMFW34"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AGXVBIUFLFGMVLATYXHJYL4A5Q7Q"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1490877431000</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Great alt to pro controller"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"These work great, They use batteries which is a bummer, but for the 40 less that i paid its worth it. Batteries last a long time. Have been using to play rocket league on the switch with no issues"</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B07GXJHRVK"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B0BCHWZX95"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AFTC6ZR5IKNRDG5JCPVNVMU3XV2Q"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1577637634017</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"solid product"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"I would recommend to anyone looking to add just a little bit of height and a lot of grip to their thumb sticks. These will not create miracles, but it will give you better leverage for shooters."</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B00HUWA45W"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B00HUWA45W"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AFTC6ZR5IKNRDG5JCPVNVMU3XV2Q"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1427591932000</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">3.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"love all the amazing colors but the black is really ..."</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"love all the amazing colors but the black is really hard to see and I always have to have another form of a light on to use the key board now"</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B016Y2BVKA"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B073SC6V1D"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AHXSBZT52TCPZUBVCBRICTHWUCBA"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1518124539574</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Will use again"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"Instant delivery!"</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B004RMK57U"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B004RMK57U"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AHZIJGKEWRTAEOZ673G5B3SNXEGQ"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1602937709361</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"if its prime day and you're contemplating, just stop -- do it."</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"you should probably get these. you'll journal about the next-level experience, or at least sit there and revel for a couple min. honestly, it's like you've never heard footsteps before. or windows systems settings. they recommend against using 7.1 surround sound on microsoft teams and skype -- but nobody said SMACK about zoom. these professors be twich streamin asmr evry time they take a drink of their 'make me talky' water. sometimes it blocks out my boyfriends nonsense caveman grumblins while hes playing rocket league and im on the sims, or i guess you can turn up the ambience and pretend you cant hear someone unironically ironically screaming POGGERS every 3 min. great deal on prime day btw. now, razer, or amazon, whoever comes first, just keep the discounts for the next year please so I can sell my last kidney to afford the rest of my pc build. thanks. cheers xx&lt;br /&gt;&lt;br /&gt;ps. half-joking about the selling my organs thing and poggers thing. kind of. hook it up for ur fav broke AF college graphic designer, would you pleaseee. :) &amp;lt;3"</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"small_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/41bzyynuwTL._SL256_.jpg"</span>, <span class="hljs-attr">"medium_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/41bzyynuwTL._SL800_.jpg"</span>, <span class="hljs-attr">"large_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/41bzyynuwTL._SL1600_.jpg"</span>, <span class="hljs-attr">"attachment_type"</span>: <span class="hljs-string">"IMAGE"</span>}, {<span class="hljs-attr">"small_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/7104ErJuizL._SL256_.jpg"</span>, <span class="hljs-attr">"medium_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/7104ErJuizL._SL800_.jpg"</span>, <span class="hljs-attr">"large_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/7104ErJuizL._SL1600_.jpg"</span>, <span class="hljs-attr">"attachment_type"</span>: <span class="hljs-string">"IMAGE"</span>}, {<span class="hljs-attr">"small_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/71IRNwL2DkL._SL256_.jpg"</span>, <span class="hljs-attr">"medium_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/71IRNwL2DkL._SL800_.jpg"</span>, <span class="hljs-attr">"large_image_url"</span>: <span class="hljs-string">"https://images-na.ssl-images-amazon.com/images/I/71IRNwL2DkL._SL1600_.jpg"</span>, <span class="hljs-attr">"attachment_type"</span>: <span class="hljs-string">"IMAGE"</span>}], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B07N85FY1G"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B0BYVN9ZK2"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AFO6QN6ICKWUFQV3UEWK5EECIQTQ"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1602718512453</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">false</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Price bumps it up from 4 stars"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"*it fits TWO wired Retro-bit 6 button controllers. Yes, the ones with the 8 ft cables.&lt;br /&gt;Plus, a cut-out area for the console, and the factory hdmi and power supply fit it the lid pouch.&lt;br /&gt;&lt;br /&gt;warning: the stock 3 button controllers won't fit&lt;br /&gt;&lt;br /&gt;great simple case with good stamp-cut foam padding"</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B08L6782X9"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B08L6782X9"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AG6BAEKWLCWH2TW3KKLVK773YF6A"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1621448670253</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
{<span class="hljs-attr">"rating"</span>: <span class="hljs-number">1.0</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"It's an Auto-renew scam"</span>, <span class="hljs-attr">"text"</span>: <span class="hljs-string">"Sony and Amazon are collaborating in an Auto-renew scam&lt;br /&gt;&lt;br /&gt;Buying this turns on Auto-renew allowing Sony to charge double the annual fee&lt;br /&gt;&lt;br /&gt;Sony is exploiting the financially challenged, Amazon gets kickbacks, and people who deserved to be burned alive are unscathed."</span>, <span class="hljs-attr">"images"</span>: [], <span class="hljs-attr">"asin"</span>: <span class="hljs-string">"B017V6YVDC"</span>, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B017V6YVDC"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">"AG6BAEKWLCWH2TW3KKLVK773YF6A"</span>, <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1607734474794</span>, <span class="hljs-attr">"helpful_vote"</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">"verified_purchase"</span>: <span class="hljs-literal">true</span>}
</code></pre><p>The description of fields in <code>products.csv</code> as follows:</p><ul>
<li><em>main_category</em> (str) - Main category (i.e., domain) of the product.</li>
<li><em>title</em> (str) - Name of the product.</li>
<li><em>average_rating</em> (float) - Rating of the product shown on the product page.</li>
<li><em>rating_number</em> (int) - Number of ratings in the product.</li>
<li><em>features</em> (list) - Bullet-point format features of the product.</li>
<li><em>description</em> (list) - Description of the product.</li>
<li><em>price</em> (float) - Price in US dollars (at time of crawling).</li>
<li><em>images</em> (list) - 	<br>
Images of the product. Each image has different sizes (thumb, large, hi_res). The “variant” field shows the position of image</li>
<li><em>videos</em> (int) - Videos of the product including title and url.</li>
<li><em>store</em> (str) - Store name of the product.</li>
<li><em>categories</em> (list) - Hierarchical categories of the product.</li>
<li><em>details</em> (dict) - Product details, including materials, brand, sizes, etc.</li>
<li><em>parent_asin</em> (str) - Parent ID of the product.</li>
<li><em>bought_together</em> (list) - Recommended bundles from the websites.</li>
</ul><p>You can see below a sample of 10 records of the file <code>products.jsonl</code></p><pre><code class="json hljs">{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Dash 8-300 Professional Add-On"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">5.0</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Features Dash 8-300 and 8-Q300 ('Q' rollout livery)"</span>, <span class="hljs-string">"Airlines - US Airways, South African Express, Bahamasair, Augsburg Airways, Lufthansa Cityline, British Airways (Union Jack), British European, FlyBe, Intersky, Wideroe, Iberia, Tyrolean, QantasLink, BWIA"</span>, <span class="hljs-string">"Airports include - London City, Frankfurt, Milan and Amsterdam Schipol"</span>, <span class="hljs-string">"Includes PSS PanelConfig and LoadEdit tools"</span>], <span class="hljs-attr">"description"</span>: [<span class="hljs-string">"The Dash 8-300 Professional Add-On lets you pilot a real commuter special. Fly two versions of the popular Dash 8-300 in a total of 17 different liveries. The Dash 8-300 is one of the most popular short-haul aircraft available and this superbly modelled version from acclaimed aircraft developers PSS is modelled in two versions with a total of 17 different liveries. The package also includes scenery for three European airports, tutorials, tutorial flights and utilities together in one fantastic package."</span>], <span class="hljs-attr">"price"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/21DVWE41A0L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/21DVWE41A0L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"Aerosoft"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"PC"</span>, <span class="hljs-string">"Games"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Package Dimensions"</span>: <span class="hljs-string">"7.5 x 5.5 x 0.6 inches; 4.8 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"CD-ROM"</span>, <span class="hljs-attr">"Rated"</span>: <span class="hljs-string">"Everyone"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"4.8 ounces"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"Aerosoft N.A. LTD"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"October 2, 2001"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B000FH0MHO"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Phantasmagoria: A Puzzle of Flesh"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">4.1</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Windows 95"</span>], <span class="hljs-attr">"description"</span>: [], <span class="hljs-attr">"price"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51pqAznTA9L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51pqAznTA9L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/71hD-k6kaxL._SL1101_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61CCFhIg4qL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61CCFhIg4qL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT01"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/81dGuRrFwAL._SL1104_.jpg"</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"Sierra"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"PC"</span>, <span class="hljs-string">"Games"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Best Sellers Rank"</span>: {<span class="hljs-attr">"Video Games"</span>: <span class="hljs-number">137612</span>, <span class="hljs-attr">"PC-compatible Games"</span>: <span class="hljs-number">6707</span>}, <span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Package Dimensions"</span>: <span class="hljs-string">"5.6 x 4.9 x 0.9 inches; 6.4 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"CD-ROM"</span>, <span class="hljs-attr">"Rated"</span>: <span class="hljs-string">"Mature"</span>, <span class="hljs-attr">"Is Discontinued By Manufacturer"</span>: <span class="hljs-string">"No"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"6.4 ounces"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"Sierra"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"March 30, 2006"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B00069EVOG"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"NBA 2K17 - Early Tip Off Edition - PlayStation 4"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">4.3</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">223</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"The #1 rated NBA video game simulation series for the last 15 years (Metacritic)."</span>, <span class="hljs-string">"The #1 selling NBA video game simulation series for the last 9 years (NPD)."</span>, <span class="hljs-string">"Over 85 awards and nominations since the launch of PlayStation 4 &amp; Xbox One."</span>, <span class="hljs-string">"BEST IN CLASS GAMEPLAY - 2K puts shot making in your hands like never before. Advanced Skill Shooting gives you complete control over the power and aim of your perimeter shots as well as your ability to finish inside the paint."</span>, <span class="hljs-string">"THE PRELUDE - Begin your MyCAREER on one of 10 licensed collegiate programs, available for free download one week prior to launch!"</span>, <span class="hljs-string">"MyCAREER - It\u2019s all-new and all about basketball in 2K17 \u2013 and you\u2019re in control. Your on-court performance and career decisions lead to different outcomes as you determine your path through an immersive new narrative, featuring Michael B. Jordan. Additionally, new player controls give you unparalleled supremacy on the court."</span>, <span class="hljs-string">"USA BASKETBALL - Take the court as Team USA with Coach K on the sidelines, or relive the glory of the \u201992 Dream Team. Earn USAB MyTEAM cards and gear up your MyPLAYER with official USAB wearables."</span>, <span class="hljs-string">"COLLEGE INTEGRATION - For the first time, play as college basketball legends with each school\u2019s all-time greats team and MyTEAM cards."</span>, <span class="hljs-string">"LEAGUE EXPANSION - For the first time, customize your MyLEAGUE and MyGM experience with league expansion. Choose your expansion team names, logos and uniforms, and share them with the rest of the NBA 2K community. Your customized league comes complete with everything from Expansion Drafts to modified schedules and more to ensure an authentic NBA experience."</span>, <span class="hljs-string">"2K BEATS Imagine Dragons, Grimes, Noah \u201c40\u201d Shabib of OVO Sound and Michael B. Jordan curate another electric 2K soundtrack, featuring 50 songs."</span>], <span class="hljs-attr">"description"</span>: [<span class="hljs-string">"Following the record-breaking launch of NBA 2K16, the NBA 2K franchise continues to stake its claim as the most authentic sports video game with NBA 2K17. As the franchise that \u201call sports video games should aspire to be\u201d (GamesRadar), NBA 2K17 will take the game to new heights and continue to blur the lines between video game and reality."</span>], <span class="hljs-attr">"price"</span>: <span class="hljs-number">58.0</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51wlIPcf0gL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51wlIPcf0gL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/81MtBG4xXhL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51smI92XGdL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51smI92XGdL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT02"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/81fby40wGQL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41B2Li+r-6L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41B2Li+r-6L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT05"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/71VFYALs8qL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/518ADy9h+wL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/518ADy9h+wL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT06"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/71ZbTa0QT4L._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41EsOEFBg0L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41EsOEFBg0L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT07"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/71kIQMjnwWL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41JUeBKY2EL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41JUeBKY2EL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT08"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/71RyXZvZA2L._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41aPDXtqZxL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41aPDXtqZxL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT09"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/71PdzeowO3L._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/411-B81va7L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/411-B81va7L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT10"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/81Anx48IQUL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41g1KDskmML._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41g1KDskmML.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT11"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/71mrJKrLwJL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/411DcBq41HL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/411DcBq41HL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"GLMR"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61CSnSRFIJL._SL1500_.jpg"</span>}], <span class="hljs-attr">"videos"</span>: [{<span class="hljs-attr">"title"</span>: <span class="hljs-string">"NBA 2K17 - Kobe: Haters vs Players"</span>, <span class="hljs-attr">"url"</span>: <span class="hljs-string">"https://www.amazon.com/vdp/386e44f88d0f41d99714076c93459753?ref=dp_vse_rvc_0"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">""</span>}], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"2K"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"PlayStation 4"</span>, <span class="hljs-string">"Games"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Release date"</span>: <span class="hljs-string">"September 16, 2016"</span>, <span class="hljs-attr">"Best Sellers Rank"</span>: {<span class="hljs-attr">"Video Games"</span>: <span class="hljs-number">57637</span>, <span class="hljs-attr">"PlayStation 4 Games"</span>: <span class="hljs-number">2886</span>}, <span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Product Dimensions"</span>: <span class="hljs-string">"0.4 x 5.3 x 6.6 inches; 1.6 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"Video Game"</span>, <span class="hljs-attr">"Rated"</span>: <span class="hljs-string">"Everyone"</span>, <span class="hljs-attr">"Item model number"</span>: <span class="hljs-string">"47793"</span>, <span class="hljs-attr">"Is Discontinued By Manufacturer"</span>: <span class="hljs-string">"No"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"1.6 ounces"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"2K Games"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"April 13, 2016"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B00Z9TLVK0"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Nintendo Selects: The Legend of Zelda Ocarina of Time 3D (Renewed)"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">4.9</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">22</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Authentic Nintendo Selects: The Legend of Zelda Ocarina of Time 3D"</span>, <span class="hljs-string">"Does not come with original case or manuals. Cartridge only"</span>, <span class="hljs-string">"Cartridge and label are in nice condition"</span>, <span class="hljs-string">"Fully tested and guaranteed"</span>], <span class="hljs-attr">"description"</span>: [], <span class="hljs-attr">"price"</span>: <span class="hljs-number">37.42</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51raO0wAe8L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51raO0wAe8L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/81dM82yx6wL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51ag4Lai25L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51ag4Lai25L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT01"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41D7zacd5cL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41D7zacd5cL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT02"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41sNSMvZGAL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41sNSMvZGAL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT03"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"Amazon Renewed"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"Legacy Systems"</span>, <span class="hljs-string">"Nintendo Systems"</span>, <span class="hljs-string">"Nintendo 3DS &amp; 2DS"</span>, <span class="hljs-string">"Games"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Best Sellers Rank"</span>: {<span class="hljs-attr">"Video Games"</span>: <span class="hljs-number">51019</span>, <span class="hljs-attr">"Nintendo 3DS &amp; 2DS Games"</span>: <span class="hljs-number">432</span>}, <span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Product Dimensions"</span>: <span class="hljs-string">"0.5 x 5.4 x 4.9 inches; 2.05 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"Video Game"</span>, <span class="hljs-attr">"Rated"</span>: <span class="hljs-string">"Everyone 10+"</span>, <span class="hljs-attr">"Is Discontinued By Manufacturer"</span>: <span class="hljs-string">"No"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"2.04 ounces"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"Nintendo"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"June 14, 2019"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B07SZJZV88"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Thrustmaster Elite Fitness Pack for Nintendo Wii"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">3.0</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Includes (9) Total Accessories"</span>, <span class="hljs-string">"Pedometer"</span>, <span class="hljs-string">"Wii Fit Balance Board Stepper"</span>, <span class="hljs-string">"Floor Mat made from high density Woven Foam"</span>, <span class="hljs-string">"(2) flexible Arm/Leg Weights"</span>], <span class="hljs-attr">"description"</span>: [<span class="hljs-string">"The Thrustmaster Motion Plus Elite Fitness Pack for Wii is Ideal for Nintendo Wii Fit &amp; Wii Fit Plus games such as EA Active (EA), U Shape &amp; My Fitness Coach (UbiSoft). Ultimate pack with 9 accessories for the Nintendo Wii Fit Balance Board including: (1) floor mat made from woven foam Size (inches) : 70x20, (2) flexible ankle or wrist weights, (1) stepper for the Wii Balance Board, (1) pedometer to count your steps during each in-game exercise or train without games, (1) armband for Wiimote or Wiimote with MotionPlus - for use in menus without stepping away from the training area, (1) leg band for the Nunchuck controller (1) lanyard to your MP3 player around your neck and (1) carry bag featuring trendy sport design with two internal pockets: ideal for storing, protecting and transporting your Wii Balance Board with one game and ALL Elite Fitness pack accessories! 2 Year Warranty!"</span>], <span class="hljs-attr">"price"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31spO9JKluL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31spO9JKluL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31rX51CAv5L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31rX51CAv5L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT01"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31rNKdcmUQL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31rNKdcmUQL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT02"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31xkaqpKS+L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31xkaqpKS+L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT03"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/314yku+VEIL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/314yku+VEIL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT04"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41ezKm50QUL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41ezKm50QUL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT05"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31u0pX5P+BL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31u0pX5P+BL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT06"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31byOVYmfUL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31byOVYmfUL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT07"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/3160QI-NIXL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/3160QI-NIXL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT08"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"THRUSTMASTER"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"Legacy Systems"</span>, <span class="hljs-string">"Nintendo Systems"</span>, <span class="hljs-string">"Wii"</span>, <span class="hljs-string">"Accessories"</span>, <span class="hljs-string">"Fitness Accessories"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Release date"</span>: <span class="hljs-string">"November 1, 2009"</span>, <span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Product Dimensions"</span>: <span class="hljs-string">"19.8 x 14 x 4.75 inches; 7.35 Pounds"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"Video Game"</span>, <span class="hljs-attr">"Language"</span>: <span class="hljs-string">"English, French"</span>, <span class="hljs-attr">"Item model number"</span>: <span class="hljs-string">"4660368"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"7.35 pounds"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"Thrustmaster VG"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"September 11, 2009"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B002WH4ZJG"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Grand Prix 4"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">3.7</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Operating System: Windows 98, ME, XP"</span>, <span class="hljs-string">"Developer: Geoff Crammond"</span>, <span class="hljs-string">"Publisher: Infogrames"</span>, <span class="hljs-string">"Genre: Formula 1"</span>], <span class="hljs-attr">"description"</span>: [<span class="hljs-string">"Grand Prix 4 is the fourth installment in the GP-Series by Geoff Crammond. However, this time around, Microprose had a much larger role in the development of the game. For the first time in the Grand-Prix-Series, Grand Prix 4 had to go directly head-to-head with an EA-Sports offering, in the form of F1 2002. The flame wars and heated debate about which is better has not stopped since. Grand Prix 4 is not a revolution over Grand Prix 3, but more an evolution, as was Grand Prix 3 over Grand Prix 2. Today the game still lives on with plenty of new downloads and updates available to bring the game up to the latest season."</span>], <span class="hljs-attr">"price"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51167J4AQSL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51167J4AQSL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/5128X6W23SL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/5128X6W23SL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT01"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51XE41TZXDL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51XE41TZXDL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT03"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51PE3CA5B7L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51PE3CA5B7L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT04"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31BDm2VqflL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31BDm2VqflL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"GLMR"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51WzbguWjjL._SL1500_.jpg"</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"PC"</span>, <span class="hljs-string">"Games"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Package Dimensions"</span>: <span class="hljs-string">"7.64 x 5.43 x 1.42 inches; 7.04 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"Video Game"</span>, <span class="hljs-attr">"Is Discontinued By Manufacturer"</span>: <span class="hljs-string">"No"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"7 ounces"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"November 28, 2011"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B00005Y3OJ"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Spongebob Squarepants, Vol. 1"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">4.4</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">32</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Bubblestand: SpongeBob shows Patrick and Squidward his unique talent for blowing bubbles. Squidward attempts to surpass SpongeBobs expertise but not everything goes according to plan!"</span>, <span class="hljs-string">"Ripped Pants: When SpongeBob tries to impress Sandy Cheeks at Mussel Beach, he accidentally rips his pants. The beach crowd loves the unintentional joke until SpongeBob pushes it too far."</span>, <span class="hljs-string">"Jellyfishing: While Squidward is recovering from an accident, SpongeBob and Patrick take him jellyfishing. But the two unwittingly thrust poor Squidward into the hazardous rigors of their favorite pastime."</span>, <span class="hljs-string">"Plankton: When evil Plankton takes control of his brain, SpongeBob must fight his own body to prevent himself from revealing the top secret Krabby Patty recipe!"</span>], <span class="hljs-attr">"description"</span>: [<span class="hljs-string">"Now you can watch the wild underwater antics of SpongeBob SquarePants on your Game Boy Advance, with this collection of 4 great episodes. In \"Hall Monitor,\" an overzealous SpongeBob becomes the new Hall Monitor at Mrs. Puff's Boating School, and extends his jurisdiction to the unsuspecting citizens of Bikini Bottom. In \"Jellyfish Jam,\" SpongeBob takes a wild jellyfish home and discovers that they multiply quickly when they take over his house! In \"Jellyfishing,\" SpongeBob and Patrick unwittingly thrust poor Squidward, who is recovering from an accident, into the hazardous rigors of their favorite pastime, jellyfishing. In \"Plankton,\" evil Plankton takes control of SpongeBob's brain, and SpongeBob must fight his own body to prevent himself from revealing the top secret Krabby Patty recipe!"</span>], <span class="hljs-attr">"price"</span>: <span class="hljs-number">33.98</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/611XSBQ4RBL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/611XSBQ4RBL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31BDm2VqflL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31BDm2VqflL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"GLMR"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51WzbguWjjL._SL1500_.jpg"</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"Majesco"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"Legacy Systems"</span>, <span class="hljs-string">"Nintendo Systems"</span>, <span class="hljs-string">"Game Boy Systems"</span>, <span class="hljs-string">"Game Boy Advance"</span>, <span class="hljs-string">"Games"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Release date"</span>: <span class="hljs-string">"August 15, 2004"</span>, <span class="hljs-attr">"Best Sellers Rank"</span>: {<span class="hljs-attr">"Video Games"</span>: <span class="hljs-number">47190</span>, <span class="hljs-attr">"Game Boy Advance Games"</span>: <span class="hljs-number">142</span>}, <span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Product Dimensions"</span>: <span class="hljs-string">"5.75 x 4 x 1 inches; 0.32 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"Video Game"</span>, <span class="hljs-attr">"Rated"</span>: <span class="hljs-string">"Everyone"</span>, <span class="hljs-attr">"Item model number"</span>: <span class="hljs-string">"GAMJC 096427013426"</span>, <span class="hljs-attr">"Is Discontinued By Manufacturer"</span>: <span class="hljs-string">"Yes"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"0.32 ounces"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"Majesco Sales Inc."</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"June 1, 2004"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B0001ZNU56"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"eXtremeRate Soft Touch Top Shell Front Housing Faceplate Replacement Parts with Side Rails Panel for Xbox One X &amp; One S Controller (Shadow Purple)"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">4.5</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">3061</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Compatibility Models: Ultra fits for Xbox One X &amp; One S controller ; Not compatible with Xbox One Elite controller &amp; Standard Xbox One Controller.Check the second picture of the listing before purchase"</span>, <span class="hljs-string">"Fit Perfectly: Fit the best by far; Completely fits flush on all side; Sit properly on all the clips"</span>, <span class="hljs-string">"Package Includes: 1 * Faceplate shell ; 1 * Right side rails; 1 * Left side rails;1*Open Shell Tool;1 * T8H screwdriver; 7* screws. (IMPORTANT: The controller and other parts are not included.)"</span>, <span class="hljs-string">"Installation Skills Required: Required customers to take apart the controller to install this front housing shell; Required customers handy with controller modifications"</span>, <span class="hljs-string">"Personalized Feature: The shadow purple color looks great; Great smooth grip, soft in hand and feels silky; Anti slip, sweat free for a long period game playing"</span>], <span class="hljs-attr">"description"</span>: [], <span class="hljs-attr">"price"</span>: <span class="hljs-number">17.59</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41reviTraVL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41reviTraVL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/711FCClp7qL._SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51Y2sNaPYuL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51Y2sNaPYuL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT01"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61WZB0JSbfL._SL1000_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41yHhIt5rDL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41yHhIt5rDL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT02"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/517Xy-auRHL._SL1000_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41SlaNfN4fL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41SlaNfN4fL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT03"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61oqzfBYbVL._SL1000_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41+ZJYYRKVL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41+ZJYYRKVL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT04"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61gRCbvxyBL._SL1000_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41DKBJyb-EL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41DKBJyb-EL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT05"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61oHubD2jhL._SL1000_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/418wNkXtQ2L._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/418wNkXtQ2L.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT06"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/61fUe2N9f8L._SL1000_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/411+i-oIjIL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/411+i-oIjIL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT07"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/516v2K0Aq9L._SL1000_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41dEWqxkoWL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41dEWqxkoWL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT08"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51F+pvO+NfL._SL1000_.jpg"</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"eXtremeRate"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"Xbox One"</span>, <span class="hljs-string">"Accessories"</span>, <span class="hljs-string">"Faceplates, Protectors &amp; Skins"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Best Sellers Rank"</span>: {<span class="hljs-attr">"Video Games"</span>: <span class="hljs-number">48130</span>, <span class="hljs-attr">"Xbox One Faceplates, Protectors &amp; Skins"</span>: <span class="hljs-number">253</span>}, <span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Product Dimensions"</span>: <span class="hljs-string">"6.5 x 4.53 x 1.97 inches; 1.76 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"Video Game"</span>, <span class="hljs-attr">"Item model number"</span>: <span class="hljs-string">"ZSXOF0"</span>, <span class="hljs-attr">"Is Discontinued By Manufacturer"</span>: <span class="hljs-string">"No"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"1.76 ounces"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"Extremerate"</span>, <span class="hljs-attr">"Country of Origin"</span>: <span class="hljs-string">"China"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"September 11, 2017"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B07H93H878"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Computers"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Set of 4 Bullet Buttons Nickel+Brass for Playstation PS3 PS2 controllers"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">4.8</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"Case Color: Silver"</span>, <span class="hljs-string">"Case Material: Nickel"</span>, <span class="hljs-string">"Primer Color: Bronze"</span>, <span class="hljs-string">"Primer Material: Brass"</span>, <span class="hljs-string">"Brand of ammo shell may vary from the picture shown, but it will look very similar."</span>], <span class="hljs-attr">"description"</span>: [<span class="hljs-string">"A set of 4 bullet button to replace all the 4 buttons (Cross, Square, Triangle, Circle) of your PS3 controller. Made from 9mm luger bullet casings, to perfectly fit the PS3. The bullet buttons are already mounted on a special plastic holder that fit directly and perfectly your PS3 controller. Each cartridge shell have a small layer of clear coat that keep the bullet button ultra shiny even after many years. The clear coat also prevent the metallic odor that can be created during extended use . Case Color: Silver Case Material: Nickel Primer Color: Bronze Primer Material: Brass"</span>], <span class="hljs-attr">"price"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/410NNQMoFEL._AC_US40_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/410NNQMoFEL._AC_.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41ETKho5m-L._AC_US40_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41ETKho5m-L._AC_.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT01"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/415t4vhHyPL._AC_US40_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/415t4vhHyPL._AC_.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT02"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/91sScW8kwwL._AC_SL1500_.jpg"</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41EFsAYd8ZL._AC_US40_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/41EFsAYd8ZL._AC_.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"PT03"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/812W6x6a9HL._AC_SL1500_.jpg"</span>}], <span class="hljs-attr">"videos"</span>: [], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"NEXiLUX"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"PlayStation 4"</span>, <span class="hljs-string">"Accessories"</span>, <span class="hljs-string">"Controllers"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Package Dimensions"</span>: <span class="hljs-string">"4 x 3 x 0.3 inches"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"1 pounds"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"NEXiLUX"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"September 17, 2012"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B009C9E8JY"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
{<span class="hljs-attr">"main_category"</span>: <span class="hljs-string">"Video Games"</span>, <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Konami Collector's Series: Castlevania &amp; Contra - PC"</span>, <span class="hljs-attr">"average_rating"</span>: <span class="hljs-number">3.6</span>, <span class="hljs-attr">"rating_number"</span>: <span class="hljs-number">19</span>, <span class="hljs-attr">"features"</span>: [<span class="hljs-string">"This collection of classic 8-bit games includes five all-time greats - Castlevania, Castlevania II, Castlevania - Dracula's Curse, Contra and Super C"</span>, <span class="hljs-string">"Customize controls at any time, during any game"</span>, <span class="hljs-string">"Quick-save lets players save their progress from any point in the game"</span>, <span class="hljs-string">"Get back into the games you loved with this collection of old-school classics!"</span>], <span class="hljs-attr">"description"</span>: [<span class="hljs-string">"The Konami Collector's Series: Castlevania &amp; Contra brings back the classic games that first appeared on the NES for a new generation of computer gamers!"</span>], <span class="hljs-attr">"price"</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">"images"</span>: [{<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/21CERVWQ5DL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/21CERVWQ5DL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"MAIN"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-literal">null</span>}, {<span class="hljs-attr">"thumb"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31BDm2VqflL._SX38_SY50_CR,0,0,38,50_.jpg"</span>, <span class="hljs-attr">"large"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/31BDm2VqflL.jpg"</span>, <span class="hljs-attr">"variant"</span>: <span class="hljs-string">"GLMR"</span>, <span class="hljs-attr">"hi_res"</span>: <span class="hljs-string">"https://m.media-amazon.com/images/I/51WzbguWjjL._SL1500_.jpg"</span>}], <span class="hljs-attr">"videos"</span>: [{<span class="hljs-attr">"title"</span>: <span class="hljs-string">"Konami Collector's Series: Arcade Advanced"</span>, <span class="hljs-attr">"url"</span>: <span class="hljs-string">"https://www.amazon.com/vdp/0dd0015b33fb49d4b3c1aa5c17ec497c?ref=dp_vse_rvc_0"</span>, <span class="hljs-attr">"user_id"</span>: <span class="hljs-string">""</span>}], <span class="hljs-attr">"store"</span>: <span class="hljs-string">"Square Enix"</span>, <span class="hljs-attr">"categories"</span>: [<span class="hljs-string">"Video Games"</span>, <span class="hljs-string">"PC"</span>, <span class="hljs-string">"Games"</span>], <span class="hljs-attr">"details"</span>: {<span class="hljs-attr">"Release date"</span>: <span class="hljs-string">"December 2, 2002"</span>, <span class="hljs-attr">"Best Sellers Rank"</span>: {<span class="hljs-attr">"Video Games"</span>: <span class="hljs-number">154968</span>, <span class="hljs-attr">"PC-compatible Games"</span>: <span class="hljs-number">8771</span>}, <span class="hljs-attr">"Pricing"</span>: <span class="hljs-string">"The strikethrough price is the List Price. Savings represents a discount off the List Price."</span>, <span class="hljs-attr">"Product Dimensions"</span>: <span class="hljs-string">"24 x 24 x 24 inches; 3.99 Ounces"</span>, <span class="hljs-attr">"Type of item"</span>: <span class="hljs-string">"Video Game"</span>, <span class="hljs-attr">"Rated"</span>: <span class="hljs-string">"Everyone"</span>, <span class="hljs-attr">"Item model number"</span>: <span class="hljs-string">"KONAMI GAMES"</span>, <span class="hljs-attr">"Is Discontinued By Manufacturer"</span>: <span class="hljs-string">"Yes"</span>, <span class="hljs-attr">"Item Weight"</span>: <span class="hljs-string">"3.99 ounces"</span>, <span class="hljs-attr">"Manufacturer"</span>: <span class="hljs-string">"Konami"</span>, <span class="hljs-attr">"Date First Available"</span>: <span class="hljs-string">"December 13, 2002"</span>}, <span class="hljs-attr">"parent_asin"</span>: <span class="hljs-string">"B00006969T"</span>, <span class="hljs-attr">"bought_together"</span>: <span class="hljs-literal">null</span>}
</code></pre><h1 id="40-points-Tasks-on-Spark-DataFrame"><a class="anchor hidden-xs" href="#40-points-Tasks-on-Spark-DataFrame" title="40-points-Tasks-on-Spark-DataFrame"><i class="fa fa-link"></i></a>[40 points] Tasks on Spark DataFrame</h1><div class="alert alert-danger">
<p><b>NOTE:</b></p>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<p>Such BLOCK outlines the results of the task that need to be presented as an evidence for grading purposes. They need to be followed as part of the tasks.</p>
</blockquote>
</blockquote>
</div><div class="alert alert-warning">
<p><strong>Note: In this list of exercises, you have to use the <code>pyspark.sql.DataFrame</code> API. You need to perform the analysis using Spark DataFrame API.</strong></p>
</div><div class="alert alert-success">
<ol>
<li>Build a <em>proper</em> schema for both datasets and use the schema to read the dataset files. The proper schema should consider the datatype for each column as mentioned in the description and do not store them as strings. Read the dataframes given the schema.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the schema of the dataframes after creating them.</li>
<li>Show the first 10 rows of each dataframe.</li>
</ol>
</blockquote>
</blockquote>
<ol start="2">
<li>You must take a 10% sample of the products dataframe and use it for analysis where your SID will be utilized as seed for the random state of the <code>pyspark.sql.DataFrame.sample</code> function. The shared notebook contains the code snippets to take the sample as follows:</li>
</ol>
<pre><code class="python hljs"><span class="hljs-comment"># df_products is the dataframe after successfully reading it from the file products.jsonl using the schema</span>
<span class="hljs-comment"># Rename some columns</span>
df_products = df_products.withColumnsRenamed(
    {
      <span class="hljs-string">"title"</span>: <span class="hljs-string">"product_title"</span>,
      <span class="hljs-string">"images"</span>: <span class="hljs-string">"product_images"</span>
    }
)


df_products_sample = df_products.sample(withReplacement=<span class="hljs-literal">False</span>, fraction = <span class="hljs-number">0.1</span>, seed = SID)

<span class="hljs-comment"># Now you can delete the original dataframe</span>
<span class="hljs-keyword">del</span> df_products 
</code></pre>
<pre><code class="wrap python hljs"><span class="hljs-comment"># df_reviews is the dataframe after successfully reading it from the file reviews.jsonl using the schema</span>
<span class="hljs-comment"># Rename some columns</span>
df_reviews = df_reviews.withColumnsRenamed(
    {
      <span class="hljs-string">"title"</span>: <span class="hljs-string">"review_title"</span>,
      <span class="hljs-string">"text"</span>: <span class="hljs-string">"review_text"</span>,
      <span class="hljs-string">"timestamp"</span>: <span class="hljs-string">"review_timestamp"</span>,
      <span class="hljs-string">"images"</span>: <span class="hljs-string">"reviewed_product_images"</span>
     }
)


cols = df_reviews.columns

<span class="hljs-comment"># Find the reviews of this dataframe</span>
df_reviews_sample = df_reviews.join(df_products_sample, on=<span class="hljs-string">'parent_asin'</span>,how=<span class="hljs-string">'inner'</span>).select(cols)

<span class="hljs-comment"># Now you can delete the original dataframe</span>
<span class="hljs-keyword">del</span> df_reviews


<span class="hljs-comment"># Now you must use only these samples for all analysis tasks.</span>
</code></pre>
<ol start="3">
<li>We want to understand whether average ratings changes by product category. Analyze the average ratings for products within each main category. Identify categories with the best ratings and worst ratings.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this analysis task.</li>
<li>Show the top 10 product categories with the best ratings</li>
<li>Show the top 10 product categories with the worst ratings</li>
<li>Add your recommendation/conclusion of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<!--  Group products by price ranges and compare their average sentiment. -->
<ol start="4">
<li>Investigate if there is a linear correlation between the price of a product and the average ratings. This will help us to observe the impact of price on ratings. We consider both variables on ratio scale.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this analysis task.</li>
<li>Show the top 10 expensive products with distribution of average ratings.</li>
<li>Show the top 10 cheap products with distribution of average ratings.</li>
<li>Add your conclusion/recommendation of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<ol start="5">
<li>Here, we will analyze product release trends. You can get the product release dates from the field <code>details</code>. Explore the distribution of product release dates. Are there certain years or periods (seasons or months) with a higher number of releases? Are there any trends in the categories of products released over time?</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this analysis task.</li>
<li>Show the analysis results for the top 10 products and product categories</li>
<li>Add your conclusion/recommendation of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<ol start="6">
<li>We want to find similar products based only on the description. For that we want to extract some structured information (e.g. keywords or tags) from the description. You can use different methods to extract this structured info from the description of the product. You can use external packages here but notice that the library you use here must support working with Spark DataFrames and it is not accepted to use libraries that do not use Spark DataFrames. Define a python function <code>extract_info</code> which will return the top structured info (list or array of textual info) for a specific product description (text).  <!-- Check this [guide](https://www.johnsnowlabs.com/the-experts-guide-to-keyword-extraction-from-texts-with-spark-nlp-and-python/) for more info. --></li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this task.</li>
<li>Show the top structured info for the first product along with its description.</li>
<li>Add your conclusion to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<!-- For iI would suggest here `YakeKeywordExtraction` in the library `sparknlp`.  -->
<ol start="7">
<li>Use the previous function <code>extract_info</code> and define a UDF for extracting structured info from the field <code>description</code> that can be used for analysis. Use the UDF to identify similar products based on matching keywords extracted from <code>description</code> field. How you aggregate the keywords extracted from each product description is up to you. For example, you can concatenate them to form a single string for each list of keywords extracted per product description. You can use <em>Levenshtein distance</em> for string matching. Check <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.levenshtein.html" target="_blank" rel="noopener">here</a> for the documentation. Is the extracted info useful to find similar products? Specify the benefits and drawbacks of using this approach.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this analysis task.</li>
<li>Take a sample of 20 products of the dataframe using the function <a href="https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.sample.html" target="_blank" rel="noopener"><code>pyspark.sql.DataFrame.sample</code></a>.</li>
<li>Select the first product (first record) <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8855-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117302" style="width: 0.692em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.727em, 1000.54em, 2.466em, -999.998em); top: -2.313em; left: 0em;"><span class="mrow" id="MathJax-Span-117303"><span class="mi" id="MathJax-Span-117304" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.318em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.054em; border-left: 0px solid; width: 0px; height: 0.631em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-8855">x</script></span> in the selected sample.</li>
<li>Find top 20 similar products for <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8856-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117305" style="width: 0.692em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.594em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.727em, 1000.54em, 2.466em, -999.998em); top: -2.313em; left: 0em;"><span class="mrow" id="MathJax-Span-117306"><span class="mi" id="MathJax-Span-117307" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.318em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.054em; border-left: 0px solid; width: 0px; height: 0.631em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-8856">x</script></span>.</li>
<li>Show the description and string matching scores for these 20 similar products.</li>
<li>Add your conclusion of this analysis result and your answers to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
</div><h1 id="15-points-Tasks-on-Spark-SQL"><a class="anchor hidden-xs" href="#15-points-Tasks-on-Spark-SQL" title="15-points-Tasks-on-Spark-SQL"><i class="fa fa-link"></i></a>[15 points] Tasks on Spark SQL</h1><div class="alert alert-danger">
<p><b>NOTE:</b></p>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<p>Such BLOCK outlines the results of the task that need to be presented as an evidence for grading purposes. They need to be followed as part of the tasks.</p>
</blockquote>
</blockquote>
</div><div class="alert alert-warning">
<p><strong>Note: In this list of exercises, you have to use the pyspark.sql API. You need to perform the analysis using Spark SQL queries. In case you needed to apply some operation that is not supported in Spark SQL queries then you can use Spark DataFrame API to apply only these operations.</strong></p>
</div><div class="alert alert-success">
<ol>
<li>We are interested in analyzing each store in the dataset. Find the distribution of products per store. The distribution of products here means the total number of products identified using <code>asin</code>.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this analysis task.</li>
<li>Show the analysis results for the top 10 stores.</li>
<li>Add your recommendation/conclusion of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<ol start="2">
<li>We want to identify top reviewers and their preferences. Find the reviewers who have written the most reviews and analyze the distribution of ratings in their reviews. Do they tend to rate higher or lower? Do they specialize in certain brands?</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this analysis task.</li>
<li>Show the analysis results for the top 10 reviewers</li>
<li>Add your recommendation/conclusion of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<!-- 2. Investigate the relationship between a product's sales rank and its average rating or sentiment. Do higher-ranked products consistently receive better reviews? -->
<ol start="3">
<li>Investigate if there’s a relationship between the length of a review (<code>reviewText</code>) and its rating. Are longer reviews more likely to have lower/higher ratings?</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Explain in your own words, how you will implement this analysis task.</li>
<li>Show the analysis results for the top 10 reviews with longest text and their distribution of higher/lower ratings.</li>
<li>Add your conclusion of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<!-- 
4. Analyze how the average rating for video games has evolved over time, using the `review_timestamp` information. You might need to extract year or month from this field.
 -->
</div><h1 id="45-points-Tasks-on-Spark-ML-library"><a class="anchor hidden-xs" href="#45-points-Tasks-on-Spark-ML-library" title="45-points-Tasks-on-Spark-ML-library"><i class="fa fa-link"></i></a>[45 points] Tasks on Spark ML library</h1><div class="alert alert-warning">
<p><strong>Note: You have to use here only Pyspark APIs. Using other packages which operate on single machines or cores are not allowed.</strong></p>
</div><div class="alert alert-warning">
<p><strong>Note:</strong> While you train the models, please take a look at Spark UI to track your Spark app.**</p>
</div><div class="alert alert-success">
<ol>
<li>Write Python functions to generate <strong>non-personalized recommendations</strong> where you need to suggest/retrieve the following products for any user.
<ul>
<li>Top-10 rated products</li>
<li>Top-10 most recently published products</li>
<li>Top-10 most most helpful reviews</li>
<li>Top-10 cheapest video games</li>
</ul>
</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Run each function only once and print the output.</li>
</ol>
</blockquote>
</blockquote>
<ol start="2">
<li><strong>Feature Encoding &amp; Regression task:</strong> Here you need to predict the price of the product from other features.
<ul>
<li>You have to use <code>products</code> dataframe.</li>
<li>Preprocess the data and encode the non-numerical features.
<ul>
<li>For encoding long text fields, use <code>TF-IDF</code> or <code>Word2Vec</code> with embedding size not less than 20 (you can find them in <code>pyspark.ml.feature</code>). You can see some example <a href="https://spark.apache.org/docs/latest/mllib-feature-extraction.html" target="_blank" rel="noopener">here</a>.</li>
<li>For encoding categorical fields, you can use <code>One-hot-encoder</code> or other proper encoders as you prefer.</li>
<li>For numerical fields like <code>price</code>, remove the missing values. <code>price</code> is the output column and you should not alter it. You take into consideration only the products whose price is known. For other numerical features, you encode as suggested.</li>
<li>For array/list or dict type fields, you can remove them if you want (for simplicity) OR you can create a row for each value in the array. You can use <code>explode</code> function for that purpose. See example <a href="https://sparkbyexamples.com/spark/explode-spark-array-and-map-dataframe-column/" target="_blank" rel="noopener">here</a>. Then you can encode with one-hot encoder or any other encoder.</li>
<li>For date/timestamp field, decompose it into three parts (day, month and year), drop the day part (and also the hour, minute and seconds parts) and keep only month and year parts, then build a custom <code>pyspark.ml.Transformer</code> for the month part whereas the year part can be treated as a numerical feature. Check this <a href="https://csyhuang.github.io/2020/08/01/custom-transformer/" target="_blank" rel="noopener">example</a> to see how you can build a custom transformer. For month part of the date field, use the <code>sin and cos transformation</code> (one of the common ways to encode cyclical features). This transformation encodes each input into two components, one component on <code>sin</code> wave and the other one on <code>cos</code> wave. After encoding, you will get two columns for month as follows (<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8417-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115962" style="width: 4.636em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.99em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.99em, 2.643em, -999.997em); top: -2.314em; left: 0em;"><span class="mrow" id="MathJax-Span-115963"><span class="mi" id="MathJax-Span-115964" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-115965" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-115966" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-115967" style="font-family: MathJax_Math-italic;">t</span><span class="msubsup" id="MathJax-Span-115968"><span style="display: inline-block; position: relative; width: 1.673em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-115969" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-115970"><span class="mrow" id="MathJax-Span-115971"><span class="mi" id="MathJax-Span-115972" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-115973" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-115974" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.32em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>i</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-8417">month_{sin}</script></span>, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8418-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi><mi>s</mi></mrow></msub></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115975" style="width: 4.582em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.936em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1003.94em, 2.643em, -999.997em); top: -2.314em; left: 0em;"><span class="mrow" id="MathJax-Span-115976"><span class="mi" id="MathJax-Span-115977" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-115978" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-115979" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-115980" style="font-family: MathJax_Math-italic;">t</span><span class="msubsup" id="MathJax-Span-115981"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-115982" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-115983"><span class="mrow" id="MathJax-Span-115984"><span class="mi" id="MathJax-Span-115985" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-115986" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-115987" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.32em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>s</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-8418">month_{cos}</script></span>). It is given by <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8419-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>p</mi><mi>y</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>r</mi><mi>k</mi><mo>.</mo><mi>s</mi><mi>q</mi><mi>l</mi><mo>.</mo><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>.</mo><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo>(</mo><mfrac><mrow><mn>2</mn><mo>&amp;#x2217;</mo><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mo>.</mo><mi>p</mi><mi>i</mi><mo>&amp;#x2217;</mo><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow><mn>12</mn></mfrac><mo>)</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115988" style="width: 32.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.074em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.835em, 1027.86em, 4.582em, -999.997em); top: -3.446em; left: 0em;"><span class="mrow" id="MathJax-Span-115989"><span class="mi" id="MathJax-Span-115990" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-115991" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-115992" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-115993" style="font-family: MathJax_Math-italic;">t</span><span class="msubsup" id="MathJax-Span-115994"><span style="display: inline-block; position: relative; width: 1.673em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-115995" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-115996"><span class="mrow" id="MathJax-Span-115997"><span class="mi" id="MathJax-Span-115998" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-115999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-116000" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-116001" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-116002" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">p</span><span class="mi" id="MathJax-Span-116003" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-116004" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-116005" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-116006" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-116007" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-116008" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-116009" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116010" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">s</span><span class="mi" id="MathJax-Span-116011" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-116012" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-116013" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116014" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-116015" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-116016" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-116017" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-116018" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-116019" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-116020" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-116021" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-116022" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-116023" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116024" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">s</span><span class="mi" id="MathJax-Span-116025" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-116026" style="font-family: MathJax_Math-italic;">n</span><span class="mrow" id="MathJax-Span-116027" style="padding-left: 0.164em;"><span class="mo" id="MathJax-Span-116028" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-116029"><span style="display: inline-block; position: relative; width: 9.054em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1008.89em, 4.367em, -999.997em); top: -4.685em; left: 50%; margin-left: -4.469em;"><span class="mrow" id="MathJax-Span-116030"><span class="mn" id="MathJax-Span-116031" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-116032" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-116033" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mi" id="MathJax-Span-116034" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-116035" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-116036" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-116037" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116038" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mi" id="MathJax-Span-116039" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-116040" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-116041" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mi" id="MathJax-Span-116042" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-116043" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-116044" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-116045" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.97em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.482em;"><span class="mn" id="MathJax-Span-116046" style="font-family: MathJax_Main;">12</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1009.05em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.054em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-116047" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.451em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>p</mi><mi>y</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>r</mi><mi>k</mi><mo>.</mo><mi>s</mi><mi>q</mi><mi>l</mi><mo>.</mo><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>.</mo><mi>s</mi><mi>i</mi><mi>n</mi><mrow><mo>(</mo><mfrac><mrow><mn>2</mn><mo>∗</mo><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mo>.</mo><mi>p</mi><mi>i</mi><mo>∗</mo><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow><mn>12</mn></mfrac><mo>)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8419">month_{sin} = pyspark.sql.functions.sin\left(\frac{2 * math.pi * month}{12}\right)</script></span> <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8420-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi><mi>s</mi></mrow></msub><mo>=</mo><mi>p</mi><mi>y</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>r</mi><mi>k</mi><mo>.</mo><mi>s</mi><mi>q</mi><mi>l</mi><mo>.</mo><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>.</mo><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo>(</mo><mfrac><mrow><mn>2</mn><mo>&amp;#x2217;</mo><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mo>.</mo><mi>p</mi><mi>i</mi><mo>&amp;#x2217;</mo><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow><mn>12</mn></mfrac><mo>)</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-116048" style="width: 32.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.966em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.835em, 1027.75em, 4.582em, -999.997em); top: -3.446em; left: 0em;"><span class="mrow" id="MathJax-Span-116049"><span class="mi" id="MathJax-Span-116050" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-116051" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-116052" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-116053" style="font-family: MathJax_Math-italic;">t</span><span class="msubsup" id="MathJax-Span-116054"><span style="display: inline-block; position: relative; width: 1.619em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.54em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-116055" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.823em; left: 0.595em;"><span class="texatom" id="MathJax-Span-116056"><span class="mrow" id="MathJax-Span-116057"><span class="mi" id="MathJax-Span-116058" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-116059" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-116060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mo" id="MathJax-Span-116061" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-116062" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">p</span><span class="mi" id="MathJax-Span-116063" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-116064" style="font-family: MathJax_Math-italic;">s</span><span class="mi" id="MathJax-Span-116065" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-116066" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-116067" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-116068" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-116069" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116070" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">s</span><span class="mi" id="MathJax-Span-116071" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-116072" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-116073" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116074" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-116075" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-116076" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-116077" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-116078" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-116079" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-116080" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-116081" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-116082" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-116083" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116084" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">c</span><span class="mi" id="MathJax-Span-116085" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-116086" style="font-family: MathJax_Math-italic;">s</span><span class="mrow" id="MathJax-Span-116087" style="padding-left: 0.164em;"><span class="mo" id="MathJax-Span-116088" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-116089"><span style="display: inline-block; position: relative; width: 9.054em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.128em, 1008.89em, 4.367em, -999.997em); top: -4.685em; left: 50%; margin-left: -4.469em;"><span class="mrow" id="MathJax-Span-116090"><span class="mn" id="MathJax-Span-116091" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-116092" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-116093" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mi" id="MathJax-Span-116094" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-116095" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-116096" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-116097" style="font-family: MathJax_Main;">.</span><span class="mi" id="MathJax-Span-116098" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">p</span><span class="mi" id="MathJax-Span-116099" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-116100" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mi" id="MathJax-Span-116101" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">m</span><span class="mi" id="MathJax-Span-116102" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-116103" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-116104" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-116105" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1000.97em, 4.151em, -999.997em); top: -3.284em; left: 50%; margin-left: -0.482em;"><span class="mn" id="MathJax-Span-116106" style="font-family: MathJax_Main;">12</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1009.05em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.054em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-116107" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.451em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><msub><mi>h</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>s</mi></mrow></msub><mo>=</mo><mi>p</mi><mi>y</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>r</mi><mi>k</mi><mo>.</mo><mi>s</mi><mi>q</mi><mi>l</mi><mo>.</mo><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>.</mo><mi>c</mi><mi>o</mi><mi>s</mi><mrow><mo>(</mo><mfrac><mrow><mn>2</mn><mo>∗</mo><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mo>.</mo><mi>p</mi><mi>i</mi><mo>∗</mo><mi>m</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>h</mi></mrow><mn>12</mn></mfrac><mo>)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8420">month_{cos} = pyspark.sql.functions.cos\left(\frac{2 * math.pi * month}{12}\right)</script></span></li>
<li>Do not forget to scale the data if necessary.<br>
<strong>Note:</strong> You can use scalers in <code>pyspark.ml.feature</code> to scale the data or any additional methods to increase the performance of the system.</li>
<li>Split the dataset into 70% training and 30% test.</li>
<li>Build an estimator of your choice for predicting the price (use only train data).</li>
<li>Evaluate the performance of the estimator using <code>rmse</code> metric (use only test data).</li>
<li>Perform a cross validation using Grid search with 3 folds to tune the hyperparameters. The Grid must contain at least 2 hyperparameters and each hyperparameter should be optimized using a list of 2 candidates at least. At minimum, you should have <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8421-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mo>&amp;#x00D7;</mo><mn>2</mn><mo>=</mo><mn>4</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-116108" style="width: 4.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1003.99em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-116109"><span class="mn" id="MathJax-Span-116110" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-116111" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mn" id="MathJax-Span-116112" style="font-family: MathJax_Main; padding-left: 0.218em;">2</span><span class="mo" id="MathJax-Span-116113" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-116114" style="font-family: MathJax_Main; padding-left: 0.272em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mo>×</mo><mn>2</mn><mo>=</mo><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-8421">2 \times 2 = 4</script></span> combinations and within each combination you have 3 cross validations. The best model’s performance here should be improved in comparison to the first model’s performance.</li>
<li>Evaluate the performance of the best estimator using <code>rmse</code> metric (use only test data).</li>
<li>For one of the video games you select, predict the price using the optimized model.</li>
</ul>
</li>
</ul>
</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the first 10 samples of <code>products</code> dataframe before encoding.</li>
<li>Show the first 10 samples of <code>products</code> dataframe <strong>after</strong> encoding. Use <code>vertical=True</code> and <code>Truncate=False</code>.</li>
<li>Show the size of the train and test dataframes (only number of rows).</li>
<li>Show the value of <code>rmse</code> for the first model (before optimization).</li>
<li>Show the value of the hyperparameters/settings before and after optimization.</li>
<li>Show the value of <code>rmse</code> for the first model (<strong>after</strong> optimization).</li>
<li>Show the predicted price of one game you select. Also show the original price of the game.</li>
<li>Add your recommendation/conclusion of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
<ol start="3">
<li><strong>Matrix factorization based collaborative filtering:</strong> Here you need to implement a matrix factorization method and use it for generating recommendations.
<ul>
<li>Use ALS algorithm from <code>pyspark.ml.recommendation</code> to fit the rating data.</li>
<li>Split the data into 80% training and 20% test set. Do not forget to seed the random state.</li>
<li>Find top-5 personalized recommendations (recommended products) for the first 10 users.</li>
<li>Evaluate the performance of the system using <code>meanAveragePrecision</code> for the top-5 results. Use the test data.</li>
<li>Test 3 different settings for ALS algorithm and add add your observations as comments to your code.</li>
<li>Select the best model and calculate its performance on the test data.</li>
</ul>
</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the size of the train and test dataframes (only number of rows).</li>
<li>Show the first 10 samples of <code>rating</code> train data.</li>
<li>Show the first 10 unique users from your dataset.</li>
<li>Show top-5 recommended products for the first 10 users. You should show all records of the dataframe.</li>
<li>Show the value of <code>meanAveragePrecision</code> for the <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8422-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>=</mo><mn>5</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-116115" style="width: 2.81em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.416em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.53em, 1002.37em, 2.515em, -999.998em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-116116"><span class="mi" id="MathJax-Span-116117" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-116118" style="font-family: MathJax_Main; padding-left: 0.298em;">=</span><span class="mn" id="MathJax-Span-116119" style="font-family: MathJax_Main; padding-left: 0.298em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.367em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.054em; border-left: 0px solid; width: 0px; height: 0.974em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-8422">k=5</script></span>.</li>
<li>Show the 3 different settings for ALS algorithm.</li>
<li>Show the value of <code>meanAveragePrecision</code> for each of the 3 different settings.</li>
<li>Show the performance <code>meanAveragePrecision</code> of the best model.</li>
<li>Add your conclusion of this analysis result to the notebook as markdown text.</li>
</ol>
</blockquote>
</blockquote>
</div><pre><div class="markmap-container"><svg class="mm-d8qy9u-2"><style>.mm-d8qy9u-2 a { color: #0097e6; }
.mm-d8qy9u-2 a:hover { color: #00a8ff; }
.mm-d8qy9u-2-g &gt; path { fill: none; }
.mm-d8qy9u-2-fo &gt; div { display: inline-block; font: 300 16px/20px sans-serif; white-space: nowrap; }
.mm-d8qy9u-2-fo code { padding: .2em .4em; font-size: calc(1em - 2px); color: #555; background-color: #f0f0f0; border-radius: 2px; }
.mm-d8qy9u-2-fo del { text-decoration: line-through; }
.mm-d8qy9u-2-fo em { font-style: italic; }
.mm-d8qy9u-2-fo strong { font-weight: bolder; }
.mm-d8qy9u-2-fo pre { margin: 0; }
.mm-d8qy9u-2-fo pre[class*=language-] { padding: 0; }
.mm-d8qy9u-2-g &gt; g { cursor: pointer; }

</style><g class="mm-d8qy9u-2-g" transform="translate(46.932891845703125,150) scale(2)"><g transform="translate(80,-10.5)"><rect x="-1" y="19" width="91" height="4" fill="rgb(31, 119, 180)"></rect><foreignObject class="mm-d8qy9u-2-fo" x="8" y="0" height="21" width="73" style="opacity: 1;"><div xmlns="http://www.w3.org/1999/xhtml">THE END</div></foreignObject></g></g></svg></div></pre></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Assignment-3---Apache-Spark-SQL-amp-MLlib" title="Assignment 3 - Apache Spark SQL &amp; MLlib">Assignment 3 - Apache Spark SQL &amp; MLlib</a></li>
<li class=""><a href="#Dataset" title="Dataset">Dataset</a></li>
<li class=""><a href="#Assignment-3-Colab-notebook" title="Assignment 3 Colab notebook">Assignment 3 Colab notebook</a></li>
<li class=""><a href="#Moodle-submission" title="Moodle submission">Moodle submission</a></li>
<li class=""><a href="#Agenda" title="Agenda">Agenda</a></li>
<li class=""><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li class=""><a href="#Instructions" title="Instructions">Instructions</a></li>
<li class=""><a href="#Assignment-Description" title="Assignment Description">Assignment Description</a></li>
<li class=""><a href="#Dataset-Description" title="Dataset Description">Dataset Description</a></li>
<li class=""><a href="#40-points-Tasks-on-Spark-DataFrame" title="[40 points] Tasks on Spark DataFrame">[40 points] Tasks on Spark DataFrame</a></li>
<li class=""><a href="#15-points-Tasks-on-Spark-SQL" title="[15 points] Tasks on Spark SQL">[15 points] Tasks on Spark SQL</a></li>
<li class=""><a href="#45-points-Tasks-on-Spark-ML-library" title="[45 points] Tasks on Spark ML library">[45 points] Tasks on Spark ML library</a></li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Assignment-3---Apache-Spark-SQL-amp-MLlib" title="Assignment 3 - Apache Spark SQL &amp; MLlib">Assignment 3 - Apache Spark SQL &amp; MLlib</a></li>
<li class=""><a href="#Dataset" title="Dataset">Dataset</a></li>
<li class=""><a href="#Assignment-3-Colab-notebook" title="Assignment 3 Colab notebook">Assignment 3 Colab notebook</a></li>
<li class=""><a href="#Moodle-submission" title="Moodle submission">Moodle submission</a></li>
<li class=""><a href="#Agenda" title="Agenda">Agenda</a></li>
<li class=""><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li class=""><a href="#Instructions" title="Instructions">Instructions</a></li>
<li class=""><a href="#Assignment-Description" title="Assignment Description">Assignment Description</a></li>
<li class=""><a href="#Dataset-Description" title="Dataset Description">Dataset Description</a></li>
<li class=""><a href="#40-points-Tasks-on-Spark-DataFrame" title="[40 points] Tasks on Spark DataFrame">[40 points] Tasks on Spark DataFrame</a></li>
<li class=""><a href="#15-points-Tasks-on-Spark-SQL" title="[15 points] Tasks on Spark SQL">[15 points] Tasks on Spark SQL</a></li>
<li class=""><a href="#45-points-Tasks-on-Spark-ML-library" title="[45 points] Tasks on Spark ML library">[45 points] Tasks on Spark ML library</a></li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/js/bootstrap.min.js" integrity="sha256-kJrlY+s09+QoWjpkOrXXwhxeaoDz9FW5SaxF8I0DibQ=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
