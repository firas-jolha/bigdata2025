<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        MS - Assignment 3 - Big Data Analytics using Apache Spark - CodiMD
    </title>
    <link rel="icon" type="image/png" href="http://localhost:3000/favicon.png">
    <link rel="apple-touch-icon" href="http://localhost:3000/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/css/bootstrap.min.css" integrity="sha256-H0KfTigpUV+0/5tn2HXC0CPwhhDhWgSawJdnFd0CGCo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fork-awesome/1.1.3/css/fork-awesome.min.css" integrity="sha256-ZhApazu+kejqTYhMF+1DzNKjIzP7KXu6AzyXcC1gMus=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.night .markdown-body blockquote{color:#bcbcbc}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.night .markdown-body h1,.night .markdown-body h2,.night .markdown-body h3,.night .markdown-body h4,.night .markdown-body h5,.night .markdown-body h6{color:#ddd}.markdown-body h1 .fa-link,.markdown-body h2 .fa-link,.markdown-body h3 .fa-link,.markdown-body h4 .fa-link,.markdown-body h5 .fa-link,.markdown-body h6 .fa-link{color:#000;vertical-align:middle;visibility:hidden;font-size:16px}.night .markdown-body h1 .fa-link,.night .markdown-body h2 .fa-link,.night .markdown-body h3 .fa-link,.night .markdown-body h4 .fa-link,.night .markdown-body h5 .fa-link,.night .markdown-body h6 .fa-link{color:#fff}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .fa-link,.markdown-body h2:hover .anchor .fa-link,.markdown-body h3:hover .anchor .fa-link,.markdown-body h4:hover .anchor .fa-link,.markdown-body h5:hover .anchor .fa-link,.markdown-body h6:hover .anchor .fa-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.night .markdown-body table tr{background-color:#5f5f5f}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.night .markdown-body table tr:nth-child(2n){background-color:#4f4f4f}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.night .markdown-body code,.night .markdown-body tt{color:#eee;background-color:hsla(0,0%,90.2%,.36)}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.night .markdown-body pre{filter:invert(100%)}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-webkit-inline-flex;display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.night .markdown-body .gist table tr:nth-child(2n){background-color:#ddd}.markdown-body code[data-gist-id]{background:none;padding:0;filter:invert(100%)}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.geo,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.night .markdown-body pre.graphviz .graph>polygon{fill:#333}.night .markdown-body pre.mermaid .sectionTitle,.night .markdown-body pre.mermaid .titleText,.night .markdown-body pre.mermaid text{fill:#fff}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.night .markdown-body .abc path{fill:#eee}.night .markdown-body .abc path.note_selected{fill:##4DD0E1}.night tspan{fill:#fefefe}.night pre rect{fill:transparent}.night pre.flow-chart path,.night pre.flow-chart rect{stroke:#fff}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body img{background-color:transparent}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;-webkit-transition:opacity .2s;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;-webkit-transition:opacity .2s;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.geo-map{width:100%;height:250px}.markmap-container{height:300px}.markmap-container>svg{width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.9;background-color:#ccc;border:none}.ui-toc-label,.ui-toc .open .ui-toc-label{-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#5f5f5f}.ui-toc-label:focus{opacity:1;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.night .ui-toc-dropdown .nav>li>a:focus,.night .ui-toc-dropdown .nav>li>a:hover{color:#fff;border-left-color:#fff}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.night .ui-toc-dropdown .nav>.active:focus>a,.night .ui-toc-dropdown .nav>.active:hover>a,.night .ui-toc-dropdown .nav>.active>a{color:#fff;border-left:2px solid #fff}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.night .ui-toc-dropdown .nav>li>a{color:#aaa}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:50px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a{padding-right:50px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:60px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a{padding-right:60px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:hover{padding-left:49px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:hover{padding-right:49px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-left:59px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-right:59px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>a{padding-left:48px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:48px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active>a{padding-left:58px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:58px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,"\30D2\30E9\30AE\30CE\89D2\30B4   Pro W3",Osaka,Meiryo,"\30E1\30A4\30EA\30AA",MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,"\5FAE\8EDF\6B63\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,"\5FAE\8EDF\6B63\9ED1UI",sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,"\5FAE\8F6F\96C5\9ED1UI",sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:rgba(0,0,0,.85)}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown{display:inline-block}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}.night .navbar{background:#333;border-bottom-color:#333;color:#eee}.night .navbar a{color:#eee}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid" lang="en"><h1 id="Assignment-3---Big-Data-Analytics-using-Apache-Spark"><a class="anchor hidden-xs" href="#Assignment-3---Big-Data-Analytics-using-Apache-Spark" title="Assignment-3---Big-Data-Analytics-using-Apache-Spark"><i class="fa fa-link"></i></a>Assignment 3 - Big Data Analytics using Apache Spark</h1><p><strong>Course:</strong> Big Data - IU S25<br>
<strong>Author:</strong> Firas Jolha</p><h1 id="Dataset"><a class="anchor hidden-xs" href="#Dataset" title="Dataset"><i class="fa fa-link"></i></a>Dataset</h1><ul>
<li><a href="https://disk.yandex.com/d/L0XXrehckGS-vA" target="_blank" rel="noopener">Nginx server access log</a> (3.26 GB)</li>
</ul><h1 id="Agenda"><a class="anchor hidden-xs" href="#Agenda" title="Agenda"><i class="fa fa-link"></i></a>Agenda</h1><p></p><div class="toc"><ul>
<li><a href="#Assignment-3---Big-Data-Analytics-using-Apache-Spark" title="Assignment 3 - Big Data Analytics using Apache Spark">Assignment 3 - Big Data Analytics using Apache Spark</a></li>
<li><a href="#Dataset" title="Dataset">Dataset</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li><a href="#Description" title="Description">Description</a></li>
<li><a href="#Description1" title="Description">Description</a></li>
<li><a href="#Instructions" title="Instructions">Instructions</a><ul>
<li><a href="#Plagiarism-policy" title="Plagiarism policy">Plagiarism policy</a></li>
</ul>
</li>
<li><a href="#Assignment-Tasks" title="Assignment Tasks">Assignment Tasks</a><ul>
<li><a href="#15-points-Exercises-on-Spark-RDD" title="[15 points] Exercises on Spark RDD">[15 points] Exercises on Spark RDD</a></li>
<li><a href="#35-points-Exercises-on-Spark-DataFrame" title="[35 points] Exercises on Spark DataFrame">[35 points] Exercises on Spark DataFrame</a></li>
<li><a href="#20-points-Exercises-on-Spark-SQL" title="[20 points] Exercises on Spark SQL">[20 points] Exercises on Spark SQL</a></li>
<li><a href="#30-points-Exercises-on-Spark-MLlib" title="[30 points] Exercises on Spark MLlib">[30 points] Exercises on Spark MLlib</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><p></p><h1 id="Prerequisites"><a class="anchor hidden-xs" href="#Prerequisites" title="Prerequisites"><i class="fa fa-link"></i></a>Prerequisites</h1><ul>
<li>Access to the university cluster</li>
</ul><h1 id="Description"><a class="anchor hidden-xs" href="#Description" title="Description"><i class="fa fa-link"></i></a>Description</h1><p>This assignment provides hands-on experience in using Spark to analyze a real-world dataset and extract meaningful business insights.</p><h1 id="Description1"><a class="anchor hidden-xs" href="#Description1" title="Description1"><i class="fa fa-link"></i></a>Description</h1><p>Web sever logs contain information on any event that was registered/logged. This contains a lot of insights on website visitors, behavior, crawlers accessing the site, business insights, security issues, and more. This midterm consists of two clusters (MongoDB and Hadoop). In Hadoop cluster will be used to transform the dataset and load it to the MongoDB using PySpark. In MongoDB cluster, you will analyze the data and store the results of data analytics. The data in MongoDB should be stored in a sharded collection.</p><p>The dataset can be download from <a href="#Dataset">the link</a> attached to this document. This dataset has access logs of Ngix server where each line stores the log info of a single request to the server. The typical log format in Nginx servers is as follows:</p><pre><code class="wrap clike hljs"><span class="hljs-string">'<span class="hljs-subst">$remote_addr</span> - <span class="hljs-subst">$remote_user</span> [<span class="hljs-subst">$time_local</span>] '</span> <span class="hljs-string">'"<span class="hljs-subst">$request</span>" <span class="hljs-subst">$status</span> <span class="hljs-subst">$body_bytes_sent</span> '</span> <span class="hljs-string">'"<span class="hljs-subst">$http_referer</span>" "<span class="hljs-subst">$http_user_agent</span>"'</span>;
</code></pre><p>You can see below the first 15 lines of this data file. You need to explore the dataset to understand its schema.</p><pre><code class="css hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span></div><div class="code">54.36.149.41 - - [22/Jan/2019:03:56:14 +0330] "GET /filter/27|13%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,27|%DA%A9%D9%85%D8%AA%D8%B1%20%D8%A7%D8%B2%205%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,p53 HTTP/1.1" 200 30577 "-" "Mozilla/5.0 (compatible; AhrefsBot/6.1; +http://ahrefs.com/robot/)" "-"
31.56.96.51 - - [22/Jan/2019:03:56:16 +0330] "GET /image/60844/productModel/200x200 HTTP/1.1" 200 5667 "https://www.zanbil.ir/m/filter/b113" "Mozilla/5.0 (Linux; Android 6.0; ALE-L21 Build/HuaweiALE-L21) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.158 Mobile Safari/537.36" "-"
31.56.96.51 - - [22/Jan/2019:03:56:16 +0330] "GET /image/61474/productModel/200x200 HTTP/1.1" 200 5379 "https://www.zanbil.ir/m/filter/b113" "Mozilla/5.0 (Linux; Android 6.0; ALE-L21 Build/HuaweiALE-L21) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.158 Mobile Safari/537.36" "-"
40.77.167.129 - - [22/Jan/2019:03:56:17 +0330] "GET /image/14925/productModel/100x100 HTTP/1.1" 200 1696 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
91.99.72.15 - - [22/Jan/2019:03:56:17 +0330] "GET /product/31893/62100/%D8%B3%D8%B4%D9%88%D8%A7%D8%B1-%D8%AE%D8%A7%D9%86%DA%AF%DB%8C-%D9%BE%D8%B1%D9%86%D8%B3%D9%84%DB%8C-%D9%85%D8%AF%D9%84-PR257AT HTTP/1.1" 200 41483 "-" "Mozilla/5.0 (Windows NT 6.2; Win64; x64; rv:16.0)Gecko/16.0 Firefox/16.0" "-"
40.77.167.129 - - [22/Jan/2019:03:56:17 +0330] "GET /image/23488/productModel/150x150 HTTP/1.1" 200 2654 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
40.77.167.129 - - [22/Jan/2019:03:56:18 +0330] "GET /image/45437/productModel/150x150 HTTP/1.1" 200 3688 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
40.77.167.129 - - [22/Jan/2019:03:56:18 +0330] "GET /image/576/article/100x100 HTTP/1.1" 200 14776 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
66.249.66.194 - - [22/Jan/2019:03:56:18 +0330] "GET /filter/b41,b665,c150%7C%D8%A8%D8%AE%D8%A7%D8%B1%D9%BE%D8%B2,p56 HTTP/1.1" 200 34277 "-" "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)" "-"
40.77.167.129 - - [22/Jan/2019:03:56:18 +0330] "GET /image/57710/productModel/100x100 HTTP/1.1" 200 1695 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
207.46.13.136 - - [22/Jan/2019:03:56:18 +0330] "GET /product/10214 HTTP/1.1" 200 39677 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
40.77.167.129 - - [22/Jan/2019:03:56:19 +0330] "GET /image/578/article/100x100 HTTP/1.1" 200 9831 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
178.253.33.51 - - [22/Jan/2019:03:56:19 +0330] "GET /m/product/32574/62991/%D9%85%D8%A7%D8%B4%DB%8C%D9%86-%D8%A7%D8%B5%D9%84%D8%A7%D8%AD-%D8%B5%D9%88%D8%B1%D8%AA-%D9%BE%D8%B1%D9%86%D8%B3%D9%84%DB%8C-%D9%85%D8%AF%D9%84-PR465AT HTTP/1.1" 200 20406 "https://www.zanbil.ir/m/filter/p5767%2Ct156?name=%D9%85%D8%A7%D8%B4%DB%8C%D9%86-%D8%A7%D8%B5%D9%84%D8%A7%D8%AD&amp;productType=electric-shavers" "Mozilla/5.0 (Linux; Android 5.1; HTC Desire 728 dual sim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.83 Mobile Safari/537.36" "-"
40.77.167.129 - - [22/Jan/2019:03:56:19 +0330] "GET /image/6229/productModel/100x100 HTTP/1.1" 200 1796 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)" "-"
91.99.72.15 - - [22/Jan/2019:03:56:19 +0330] "GET /product/10075/13903/%D9%85%D8%A7%DB%8C%DA%A9%D8%B1%D9%88%D9%81%D8%B1-%D8%B1%D9%88%D9%85%DB%8C%D8%B2%DB%8C-%D8%B3%D8%A7%D9%85%D8%B3%D9%88%D9%86%DA%AF-%D9%85%D8%AF%D9%84-CE288 HTTP/1.1" 200 41725 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.92 Safari/537.36" "-"
</div></div></code></pre><h1 id="Instructions"><a class="anchor hidden-xs" href="#Instructions" title="Instructions"><i class="fa fa-link"></i></a>Instructions</h1><p>You need to create and run your PySpark app on the university cluster. If you need access, please contact the instructor (@FirasJolha) on telegram.</p><p>For the sections <code>spark-rdd</code>, <code>spark-dataframe</code> and <code>spark-sql</code>, you need to prepare a Jupyter notebook <code>app.ipynb</code> using the kernel <code>Pyspark 3.11</code> on the cluster and write and execute all queries in this notebook.</p><div class="alert alert-danger">
<p><strong>Important notes:</strong></p>
<ol>
<li>The cells of the notebook should be have been executed and also should have had outputs. The cells which do not have an output or not executed or edited but not executed again will <strong>not</strong> be evaluated.</li>
<li>Each cell should have at least an execution order and an output (if  it gives an output).</li>
<li>Do not forget to add your comments if it is necessary.</li>
</ol>
</div><p>For Spark MLlib section, you need to write your PySpark application in <code>app.py</code> file and submit it using <code>spark-submit</code>. You need to create a script file <code>run.sh</code> that will prepare the assignment workspace and installs all required dependencies. After that, the same script <code>run.sh</code> will run the application using the <code>yarn</code> resource manager as master and <code>client</code> deploy mode. Redirect the  <code>stdout</code> and <code>stderr</code> (<code>&amp;&gt;</code>) of the command <code>spark-submit</code> to a file <code>output.txt</code>. This fille will contain the output of this app. You can keep the log level to <code>ERROR</code> in the application if you prefer.</p><p>Submit to Moodle four files <code>app.ipynb</code>, <code>app.py</code>, <code>run.py</code>, and <code>output.txt</code>. Do not zip these files when you submit.</p><h2 id="Plagiarism-policy"><a class="anchor hidden-xs" href="#Plagiarism-policy" title="Plagiarism-policy"><i class="fa fa-link"></i></a>Plagiarism policy</h2><p>It is <strong>allowed</strong> to use any support tools but not recommended to us GenAI tools for generating text or code. You can use these generative tools to proofread your report or check the syntax of the code. All solutions must be submitted individually. We will perform a plagiarism check on the code and report and you will be penalized if your submission is found to be plagiarized.</p><h1 id="Assignment-Tasks"><a class="anchor hidden-xs" href="#Assignment-Tasks" title="Assignment-Tasks"><i class="fa fa-link"></i></a>Assignment Tasks</h1><div class="alert alert-danger">
<p><b>NOTE:</b></p>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<p>Such BLOCK outlines the results of the task that need to be presented as an evidence for grading purposes. They need to be followed as part of the tasks.</p>
</blockquote>
</blockquote>
</div><h2 id="15-points-Exercises-on-Spark-RDD"><a class="anchor hidden-xs" href="#15-points-Exercises-on-Spark-RDD" title="15-points-Exercises-on-Spark-RDD"><i class="fa fa-link"></i></a>[15 points] Exercises on Spark RDD</h2><div class="alert alert-warning">
<p><strong>Note: In this list of exercises, you have to use the <code>pyspark.rdd</code> API. You need to perform the analysis using Spark RDD API.</strong></p>
</div><div class="alert alert-success">
<ol>
<li>Download the dataset from the given link in the beginning of this document and put it in HDFS in a folder <code>/data/&lt;your-name&gt;</code>. List the content of the folder <code>/data/&lt;your-name&gt;</code> in HDFS using <code>hdfs dfs</code> command.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the content of the folder <code>/data/&lt;your-name&gt;</code> in HDFS.</li>
</ol>
</blockquote>
</blockquote>
<ol start="2">
<li>Create a Python virtual environment using <code>venv</code> and add any packages you need.</li>
<li>Write a PySpark application which will read the data from HDFS, transform each line or the log of each request in the data file into an RDD of dictionaries where each item in the RDD is stored as a dictionary. We want to keep only the information <code>(remote_addr, time_local, request, url, status, body_bytes_sent)</code> per request. For example, the first line in the file should be transformed into:</li>
</ol>
<pre><code class="wrap python hljs">{<span class="hljs-string">'remote_addr'</span>: <span class="hljs-string">'54.36.149.41'</span>, <span class="hljs-comment"># str</span>
 <span class="hljs-string">'time_local'</span>: { <span class="hljs-comment"># dict</span>
     <span class="hljs-string">'year'</span>: <span class="hljs-number">2019</span>, <span class="hljs-comment"># int</span>
     <span class="hljs-string">'month'</span>: <span class="hljs-number">1</span>, <span class="hljs-comment"># int</span>
     <span class="hljs-string">'day'</span>: <span class="hljs-number">22</span>, <span class="hljs-comment"># int</span>
     <span class="hljs-string">'hours'</span>: <span class="hljs-number">3</span>, <span class="hljs-comment"># int</span>
     <span class="hljs-string">'minutes'</span>: <span class="hljs-number">56</span>, <span class="hljs-comment"># int</span>
     <span class="hljs-string">'seconds'</span>: <span class="hljs-number">14</span> <span class="hljs-comment"># int</span>
 },
 <span class="hljs-string">'request'</span>: <span class="hljs-string">'GET'</span>, <span class="hljs-comment"># str</span>
 <span class="hljs-string">'url'</span>: <span class="hljs-string">'/filter/27|13%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,27|%DA%A9%D9%85%D8%AA%D8%B1%20%D8%A7%D8%B2%205%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,p53'</span>,  <span class="hljs-comment"># str</span>
 <span class="hljs-string">'status'</span>: <span class="hljs-number">200</span>, <span class="hljs-comment"># int</span>
 <span class="hljs-string">'body_bytes_sent'</span>: <span class="hljs-number">30577</span> <span class="hljs-comment"># int</span>
}
</code></pre>
<p>Here I dropped some of the metadata from the request line. We assume that we need to keep only the fields mentioned in the example <code>(remote_addr, time_local, request, url, status, body_bytes_sent)</code>.</p>
<!-- Read the data as Spark DataFrame, show the size of the dataframes (rows and columns) for each one, and check that you parsed the fields with correct datatypes (build an appropriate schema). Check if cleaning the data is required for some fields. Do not remove the sample if  some of its fields are not nan.  Show some samples of the dataframes. -->
<p><strong>Note:</strong> It is not allowed to change the format/schema or the data types of the fields, so they should be stored as the given schema and datatypes for the fields.</p>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the number of items in the RDD.</li>
<li>Show first 10 items of the RDD.</li>
</ol>
</blockquote>
</blockquote>
<ol start="4">
<li>Create an RDD that contains the number of GET requests per year.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the first 10 results from the RDD sorted by most recent years.</li>
</ol>
</blockquote>
</blockquote>
<ol start="5">
<li>Create an RDD that contains the unique ip addresses that has top 10 most successful GET requests.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the first 10 results from the RDD sorted by top 10 most successful GET requests…</li>
</ol>
</blockquote>
</blockquote>
</div><h2 id="35-points-Exercises-on-Spark-DataFrame"><a class="anchor hidden-xs" href="#35-points-Exercises-on-Spark-DataFrame" title="35-points-Exercises-on-Spark-DataFrame"><i class="fa fa-link"></i></a>[35 points] Exercises on Spark DataFrame</h2><div class="alert alert-warning">
<p><strong>Note: In this list of exercises, you have to use the <code>pyspark.sql.DataFrame</code> API. You need to perform the analysis using Spark DataFrame API.</strong></p>
</div><div class="alert alert-success">
<ol>
<li>Create a Spark DataFrame with appropriate column names and data types based on the parsed data. For example, the first line in the file should be transformed into:</li>
</ol>
<pre><code class="wrap python hljs">{<span class="hljs-string">'remote_addr'</span>: <span class="hljs-string">'54.36.149.41'</span>, <span class="hljs-comment"># StringType</span>
 <span class="hljs-string">'time_local'</span>: { <span class="hljs-comment"># StructType</span>
     <span class="hljs-string">'year'</span>: <span class="hljs-number">2019</span>, <span class="hljs-comment"># IntegerType</span>
     <span class="hljs-string">'month'</span>: <span class="hljs-number">1</span>, <span class="hljs-comment"># IntegerType</span>
     <span class="hljs-string">'day'</span>: <span class="hljs-number">22</span>, <span class="hljs-comment"># IntegerType</span>
     <span class="hljs-string">'hours'</span>: <span class="hljs-number">3</span>, <span class="hljs-comment"># IntegerType</span>
     <span class="hljs-string">'minutes'</span>: <span class="hljs-number">56</span>, <span class="hljs-comment"># IntegerType</span>
     <span class="hljs-string">'seconds'</span>: <span class="hljs-number">14</span> <span class="hljs-comment"># IntegerType</span>
 },
 <span class="hljs-string">'request'</span>: <span class="hljs-string">'GET'</span>, <span class="hljs-comment"># StringType</span>
 <span class="hljs-string">'url'</span>: <span class="hljs-string">'/filter/27|13%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,27|%DA%A9%D9%85%D8%AA%D8%B1%20%D8%A7%D8%B2%205%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,p53'</span>,  <span class="hljs-comment"># StringType</span>
 <span class="hljs-string">'status'</span>: <span class="hljs-number">200</span>, <span class="hljs-comment"># IntegerType</span>
 <span class="hljs-string">'body_bytes_sent'</span>: <span class="hljs-number">30577</span> <span class="hljs-comment"># IntegerType</span>
}
</code></pre>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the size of the dataframe (rows and columns).</li>
<li>Show the schema of the dataframes after reading.</li>
<li>Show first 10 samples of the dataframes.</li>
</ol>
</blockquote>
</blockquote>
<ol start="2">
<li>Filter the DataFrame to show only the log entries with a status code of 200.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the number of records in the dataframe.</li>
<li>Show first 10 samples of the dataframes.</li>
</ol>
</blockquote>
</blockquote>
<ol start="3">
<li>Find all requests that resulted in a 4xx error (status code between 400 and 499).</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the number of records in the dataframe.</li>
<li>Show first 10 samples of the dataframes.</li>
</ol>
</blockquote>
</blockquote>
<ol start="4">
<li>Categorize the requests based on the status code (e.g., “Success” for 2xx, “Client Error” for 4xx, “Server Error” for 5xx).</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show first 10 samples of the dataframe.</li>
<li>Show the number of records per category in the dataframe.</li>
</ol>
</blockquote>
</blockquote>
<ol start="5">
<li>Calculate the total <code>body_bytes_sent</code> by each <code>remote_addr</code>.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show first 10 samples of the dataframe sorted by maximum total of bytes of log body.</li>
</ol>
</blockquote>
</blockquote>
<ol start="6">
<li>Analyse the linear correlation between total number of successful requests and the average body size for the logs per year and explain whether the correlation coefficient is significant or not. Use 5% significance level.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show first 10 values for both variables (total number of successful requests, average body size) before calculating the correlation coefficient.</li>
<li>Show the number of the values for which the correlation will be calculated.</li>
<li>Show the final correlation coefficient.</li>
<li>Show the result of statistical significance of the correlation coefficient.</li>
</ol>
</blockquote>
</blockquote>
<ol start="7">
<li>Define a UDF for extracting the first part from the request endpoint. For example, the request endpoint <code>/filter/27|13%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,27|%DA%A9%D9%85%D8%AA%D8%B1%20%D8%A7%D8%B2%205%20%D9%85%DA%AF%D8%A7%D9%BE%DB%8C%DA%A9%D8%B3%D9%84,p53</code> has the first part as <code>/filter</code>. Your UDF should extract this part for all log lines.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the results for first 10 records after applying the UDF on the dataframe. In the output the column before and after applying the UDF should be displayed.</li>
</ol>
</blockquote>
</blockquote>
<!-- 8. Search in the request paths for requests that contains `image` videos for the links and mentiones and display the links and mentiones for each video as a list. Sort the result according to the video title in ascending order.
25. Find the videos which were trend in two consecutive days.
 -->
<!-- **Note:** Try to do  -->
<!-- **Note:** For videos which has more than one stat info, you need to select the most recent ones if this is not mentioned in the exercise. -->
</div><h2 id="20-points-Exercises-on-Spark-SQL"><a class="anchor hidden-xs" href="#20-points-Exercises-on-Spark-SQL" title="20-points-Exercises-on-Spark-SQL"><i class="fa fa-link"></i></a>[20 points] Exercises on Spark SQL</h2><div class="alert alert-warning">
<p><strong>Note: In this list of exercises, you have to use the <code>spark.sql</code> function. You need to perform the analysis using Spark SQL queries.</strong></p>
</div><div class="alert alert-success">
<ol>
<li>Register the DataFrame created in the DataFrame tasks as a temporary SQL view (e.g., <code>nginx_logs</code>).</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show all tables in the catalog.</li>
</ol>
</blockquote>
</blockquote>
<ol start="2">
<li>Write a SQL query to select all columns from the <code>nginx_logs</code> view.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the first 10 records of this view.</li>
</ol>
</blockquote>
</blockquote>
<ol start="3">
<li>Write a SQL query to find all <code>GET</code> requests for resources under the <code>/product/</code> path.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the first 10 results of this query.</li>
</ol>
</blockquote>
</blockquote>
<ol start="4">
<li>Write a SQL query to find the top 10 most frequent ip addresses by number of requests.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the top 10 results of this query.</li>
</ol>
</blockquote>
</blockquote>
<ol start="5">
<li>Write a SQL query to find the top 10 most requested resources (<code>request path</code>) that resulted in a 404 error.</li>
</ol>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the top 10 results of this query.</li>
</ol>
</blockquote>
</blockquote>
</div><h2 id="30-points-Exercises-on-Spark-MLlib"><a class="anchor hidden-xs" href="#30-points-Exercises-on-Spark-MLlib" title="30-points-Exercises-on-Spark-MLlib"><i class="fa fa-link"></i></a>[30 points] Exercises on Spark MLlib</h2><div class="alert alert-warning">
<p><strong>Note: In this list of exercises, you have to use the <code>pyspark.ml</code> and/or <code>pyspark.mllib</code> modules.</strong></p>
</div><div class="alert alert-success">
<ol>
<li>Create a Pipeline of data transformers (<code>pyspark.ml.Transformer</code>) to encode all the following features in the dataframe.</li>
</ol>
<pre><code class="tex hljs">remote address (categorical feature)
request method (categorical feature)
request uri (text feature)
status (categorical feature)
body_bytes_sent (numerical feature)
</code></pre>
<p>For categorical features you can use one-hot-encoding or any other appropriate encoding method. For text features, you can use <code>word2vec</code> or any other appropriate method but not <code>one-hot-encoding</code>. For numerical features, you need to scale it using an appropriate scaler. Add any other transformers needed here. Fit and transform the dataframe.<br>
2. Create a new column <code>label</code> to indicate whether the request had 200 status code. Encode this column using an appropriate transformer.<br>
3. Build two different classifier to classify the successfulness of requests. The classifiers should be based on different classification methods like Decision Tree and Support Vector Machine.<br>
4. Split the dataset and use the training set for training and test set for reporting the performance of the models.<br>
5. Train the models.<br>
6. Evaluate the performance of both classifiers using <code>accuracy</code> and <code>f1</code> metrics. Use the test data. Which model is better in terms of <code>f1</code>?<br>
7. Using the best model, predict the success of a specific request from the test set.</p>
<blockquote>
<p><i style="color:red;"> Proof of implementation </i></p>
<blockquote>
<ol>
<li>Show the first 10 samples of <code>nginx_logs</code> dataframe before encoding.</li>
<li>Show the first 10 samples of <code>nginx_logs</code> dataframe <strong>after</strong> encoding.</li>
<li>Show the size of the train and test dataframes (only number of rows).</li>
<li>Show the value of <code>f1</code> and <code>accuracy</code> for the first model.</li>
<li>Show the value of <code>f1</code> and <code>accuracy</code> for the second model.</li>
<li>Answer the question.</li>
<li>Show the prediction result for the selected request. The output should have the label and the predicted label.</li>
</ol>
</blockquote>
</blockquote>
</div><h1 id="References"><a class="anchor hidden-xs" href="#References" title="References"><i class="fa fa-link"></i></a>References</h1><ul>
<li>Zaker, Farzin, 2019, “Online Shopping Store - Web Server Logs”, <a href="https://doi.org/10.7910/DVN/3QBYB5" target="_blank" rel="noopener">https://doi.org/10.7910/DVN/3QBYB5</a>, Harvard Dataverse, V1</li>
<li><a href="https://spark.apache.org/docs/latest/api/python/index.html" target="_blank" rel="noopener">Spark 3 Python API Docs</a></li>
</ul></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Assignment-3---Big-Data-Analytics-using-Apache-Spark" title="Assignment 3 - Big Data Analytics using Apache Spark">Assignment 3 - Big Data Analytics using Apache Spark</a></li>
<li class=""><a href="#Dataset" title="Dataset">Dataset</a></li>
<li class=""><a href="#Agenda" title="Agenda">Agenda</a></li>
<li class=""><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li class=""><a href="#Description" title="Description">Description</a></li>
<li class=""><a href="#Description1" title="Description">Description</a></li>
<li class=""><a href="#Instructions" title="Instructions">Instructions</a><ul class="nav">
<li class=""><a href="#Plagiarism-policy" title="Plagiarism policy">Plagiarism policy</a></li>
</ul>
</li>
<li class=""><a href="#Assignment-Tasks" title="Assignment Tasks">Assignment Tasks</a><ul class="nav">
<li class=""><a href="#15-points-Exercises-on-Spark-RDD" title="[15 points] Exercises on Spark RDD">[15 points] Exercises on Spark RDD</a></li>
<li class=""><a href="#35-points-Exercises-on-Spark-DataFrame" title="[35 points] Exercises on Spark DataFrame">[35 points] Exercises on Spark DataFrame</a></li>
<li class=""><a href="#20-points-Exercises-on-Spark-SQL" title="[20 points] Exercises on Spark SQL">[20 points] Exercises on Spark SQL</a></li>
<li class=""><a href="#30-points-Exercises-on-Spark-MLlib" title="[30 points] Exercises on Spark MLlib">[30 points] Exercises on Spark MLlib</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Assignment-3---Big-Data-Analytics-using-Apache-Spark" title="Assignment 3 - Big Data Analytics using Apache Spark">Assignment 3 - Big Data Analytics using Apache Spark</a></li>
<li class=""><a href="#Dataset" title="Dataset">Dataset</a></li>
<li class=""><a href="#Agenda" title="Agenda">Agenda</a></li>
<li class=""><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li class=""><a href="#Description" title="Description">Description</a></li>
<li class=""><a href="#Description1" title="Description">Description</a></li>
<li class=""><a href="#Instructions" title="Instructions">Instructions</a><ul class="nav">
<li class=""><a href="#Plagiarism-policy" title="Plagiarism policy">Plagiarism policy</a></li>
</ul>
</li>
<li class=""><a href="#Assignment-Tasks" title="Assignment Tasks">Assignment Tasks</a><ul class="nav">
<li class=""><a href="#15-points-Exercises-on-Spark-RDD" title="[15 points] Exercises on Spark RDD">[15 points] Exercises on Spark RDD</a></li>
<li class=""><a href="#35-points-Exercises-on-Spark-DataFrame" title="[35 points] Exercises on Spark DataFrame">[35 points] Exercises on Spark DataFrame</a></li>
<li class=""><a href="#20-points-Exercises-on-Spark-SQL" title="[20 points] Exercises on Spark SQL">[20 points] Exercises on Spark SQL</a></li>
<li class=""><a href="#30-points-Exercises-on-Spark-MLlib" title="[30 points] Exercises on Spark MLlib">[30 points] Exercises on Spark MLlib</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/js/bootstrap.min.js" integrity="sha256-kJrlY+s09+QoWjpkOrXXwhxeaoDz9FW5SaxF8I0DibQ=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
