<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        MS Lab 5 - Apache Spark MLlib - CodiMD
    </title>
    <link rel="icon" type="image/png" href="http://localhost:3000/favicon.png">
    <link rel="apple-touch-icon" href="http://localhost:3000/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/css/bootstrap.min.css" integrity="sha256-H0KfTigpUV+0/5tn2HXC0CPwhhDhWgSawJdnFd0CGCo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fork-awesome/1.1.3/css/fork-awesome.min.css" integrity="sha256-ZhApazu+kejqTYhMF+1DzNKjIzP7KXu6AzyXcC1gMus=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,600,600italic,300italic,300|Source+Serif+Pro|Source+Code+Pro:400,300,500&subset=latin,latin-ext);.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{padding:0 1em;color:#777;border-left:.25em solid #ddd}.night .markdown-body blockquote{color:#bcbcbc}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.night .markdown-body h1,.night .markdown-body h2,.night .markdown-body h3,.night .markdown-body h4,.night .markdown-body h5,.night .markdown-body h6{color:#ddd}.markdown-body h1 .fa-link,.markdown-body h2 .fa-link,.markdown-body h3 .fa-link,.markdown-body h4 .fa-link,.markdown-body h5 .fa-link,.markdown-body h6 .fa-link{color:#000;vertical-align:middle;visibility:hidden;font-size:16px}.night .markdown-body h1 .fa-link,.night .markdown-body h2 .fa-link,.night .markdown-body h3 .fa-link,.night .markdown-body h4 .fa-link,.night .markdown-body h5 .fa-link,.night .markdown-body h6 .fa-link{color:#fff}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .fa-link,.markdown-body h2:hover .anchor .fa-link,.markdown-body h3:hover .anchor .fa-link,.markdown-body h4:hover .anchor .fa-link,.markdown-body h5:hover .anchor .fa-link,.markdown-body h6:hover .anchor .fa-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.night .markdown-body table tr{background-color:#5f5f5f}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.night .markdown-body table tr:nth-child(2n){background-color:#4f4f4f}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.night .markdown-body code,.night .markdown-body tt{color:#eee;background-color:hsla(0,0%,90.2%,.36)}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\A0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body pre{border:inherit!important}.night .markdown-body pre{filter:invert(100%)}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-webkit-inline-flex;display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.night .markdown-body .gist table tr:nth-child(2n){background-color:#ddd}.markdown-body code[data-gist-id]{background:none;padding:0;filter:invert(100%)}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.geo,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.night .markdown-body pre.graphviz .graph>polygon{fill:#333}.night .markdown-body pre.mermaid .sectionTitle,.night .markdown-body pre.mermaid .titleText,.night .markdown-body pre.mermaid text{fill:#fff}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.night .markdown-body .abc path{fill:#eee}.night .markdown-body .abc path.note_selected{fill:##4DD0E1}.night tspan{fill:#fefefe}.night pre rect{fill:transparent}.night pre.flow-chart path,.night pre.flow-chart rect{stroke:#fff}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body img{background-color:transparent}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;-webkit-transition:opacity .2s;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;-webkit-transition:opacity .2s;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.geo-map{width:100%;height:250px}.markmap-container{height:300px}.markmap-container>svg{width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:758px;margin-top:25px;margin-bottom:-25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:10000}.ui-toc-label{opacity:.9;background-color:#ccc;border:none}.ui-toc-label,.ui-toc .open .ui-toc-label{-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#5f5f5f}.ui-toc-label:focus{opacity:1;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;-webkit-transition:opacity .2s;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.night .ui-toc-dropdown .nav>li>a:focus,.night .ui-toc-dropdown .nav>li>a:hover{color:#fff;border-left-color:#fff}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.night .ui-toc-dropdown .nav>.active:focus>a,.night .ui-toc-dropdown .nav>.active:hover>a,.night .ui-toc-dropdown .nav>.active>a{color:#fff;border-left:2px solid #fff}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.night .ui-toc-dropdown .nav>li>a{color:#aaa}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:50px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a{padding-right:50px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:60px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a{padding-right:60px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>a:hover{padding-left:49px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>a:hover{padding-right:49px}.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-left:59px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>ul>li>ul>li>a:hover{padding-right:59px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>a{padding-left:48px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:48px}.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active>a{padding-left:58px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.active>.nav>.nav>.active>.nav>.active>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>.nav>.active>.nav>.active:hover>a{padding-right:58px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,"\30D2\30E9\30AE\30CE\89D2\30B4   Pro W3",Osaka,Meiryo,"\30E1\30A4\30EA\30AA",MS Gothic,"\FF2D\FF33   \30B4\30B7\30C3\30AF",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,"\FF2D\FF33   \FF30\30B4\30B7\30C3\30AF",sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,"\5FAE\8EDF\6B63\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,"\5FAE\8EDF\6B63\9ED1UI",sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1",sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,"\5FAE\8F6F\96C5\9ED1UI",sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:rgba(0,0,0,.85)}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}small span{line-height:22px}small .dropdown{display:inline-block}small .dropdown a:focus,small .dropdown a:hover{text-decoration:none}.unselectable{-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;user-select:none}.night .navbar{background:#333;border-bottom-color:#333;color:#eee}.night .navbar a{color:#eee}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid" lang="en"><h1 id="Lab-5---Apache-Spark-MLlib"><a class="anchor hidden-xs" href="#Lab-5---Apache-Spark-MLlib" title="Lab-5---Apache-Spark-MLlib"><i class="fa fa-link"></i></a>Lab 5 - Apache Spark MLlib</h1><p><strong>Course:</strong> Big Data - IU S25<br>
<strong>Author:</strong> Firas Jolha</p><h1 id="Agenda"><a class="anchor hidden-xs" href="#Agenda" title="Agenda"><i class="fa fa-link"></i></a>Agenda</h1><p></p><div class="toc"><ul>
<li><a href="#Lab-5---Apache-Spark-MLlib" title="Lab 5 - Apache Spark MLlib">Lab 5 - Apache Spark MLlib</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Objectives" title="Objectives">Objectives</a></li>
<li><a href="#Hadoop-YARN" title="Hadoop YARN">Hadoop YARN</a><ul>
<li><a href="#Anatomy-of-Yarn" title="Anatomy of Yarn">Anatomy of Yarn</a></li>
<li><a href="#Steps-to-run-Yarn-application" title="Steps to run Yarn application">Steps to run Yarn application</a></li>
</ul>
</li>
<li><a href="#Run-spark-application-on-the-cluster" title="Run spark application on the cluster">Run spark application on the cluster</a></li>
<li><a href="#Apache-Spark-MLlib" title="Apache Spark MLlib">Apache Spark MLlib</a></li>
<li><a href="#Basic-data-structures-in-Spark-MLlib" title="Basic data structures in Spark MLlib">Basic data structures in Spark MLlib</a><ul>
<li><a href="#Local-vector" title="Local vector">Local vector</a><ul>
<li><a href="#Math-operations" title="Math operations">Math operations</a></li>
</ul>
</li>
<li><a href="#Local-matrix" title="Local matrix">Local matrix</a></li>
<li><a href="#Distributed-matrix" title="Distributed matrix">Distributed matrix</a><ul>
<li><a href="#RowMatrix-RDD-based" title="RowMatrix [RDD-based]">RowMatrix [RDD-based]</a></li>
<li><a href="#IndexedRowMatrix-RDD-based" title="IndexedRowMatrix [RDD-based]">IndexedRowMatrix [RDD-based]</a></li>
<li><a href="#CoordinateMatrix-RDD-based" title="CoordinateMatrix [RDD-based]">CoordinateMatrix [RDD-based]</a></li>
<li><a href="#BlockMatrix-RDD-based" title="BlockMatrix [RDD-based]">BlockMatrix [RDD-based]</a></li>
<li><a href="#Compressed-Sparse-Matrices-in-pysparkmllinalg" title="Compressed Sparse Matrices in pyspark.ml.linalg">Compressed Sparse Matrices in pyspark.ml.linalg</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Feature-Extraction" title="Feature Extraction">Feature Extraction</a><ul>
<li><a href="#Pipeline" title="Pipeline">Pipeline</a></li>
<li><a href="#Example-on-TF-IDF" title="Example on TF-IDF">Example on TF-IDF</a></li>
</ul>
</li>
<li><a href="#Linear-Regression" title="Linear Regression">Linear Regression</a><ul>
<li><a href="#StringIndexer" title="StringIndexer">StringIndexer</a></li>
<li><a href="#OneHotEncoder" title="OneHotEncoder">OneHotEncoder</a></li>
<li><a href="#VectorAssembler" title="VectorAssembler">VectorAssembler</a></li>
<li><a href="#VectorIndexer" title="VectorIndexer">VectorIndexer</a></li>
</ul>
</li>
<li><a href="#Classification" title="Classification">Classification</a><ul>
<li><a href="#Data-Description" title="Data Description">Data Description</a></li>
<li><a href="#Read-the-data" title="Read the data">Read the data</a></li>
<li><a href="#Feature-extraction" title="Feature extraction">Feature extraction</a></li>
<li><a href="#Sampling" title="Sampling">Sampling</a></li>
<li><a href="#Fit-the-classifier" title="Fit the classifier">Fit the classifier</a></li>
<li><a href="#Prediction" title="Prediction">Prediction</a></li>
<li><a href="#Evaluation" title="Evaluation">Evaluation</a></li>
<li><a href="#Hyper-parameter-tuning-amp-Cross-validation" title="Hyper-parameter tuning &amp; Cross validation">Hyper-parameter tuning &amp; Cross validation</a><ul>
<li><a href="#prediction" title="prediction">prediction</a></li>
<li><a href="#Evaluation1" title="Evaluation">Evaluation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><p></p><h1 id="Objectives"><a class="anchor hidden-xs" href="#Objectives" title="Objectives"><i class="fa fa-link"></i></a>Objectives</h1><ul>
<li>Run Spark application on a cluster</li>
<li>Learns methods to extract features in spark MLlib</li>
<li>Apply TF-IDF feature extraction for description of movies</li>
<li>Perform some regression tasks in spark MLlib</li>
<li>Perform some classification tasks in spark MLlib</li>
<li>Perform distributed deep learning on a cluster</li>
</ul><h1 id="Hadoop-YARN"><a class="anchor hidden-xs" href="#Hadoop-YARN" title="Hadoop-YARN"><i class="fa fa-link"></i></a>Hadoop YARN</h1><p>YARN(Yet Another Resource Negotiator) is cluster resource management system for Hadoop. YARN was introduced in Hadoop 2 to improve the MapReduce implementation and eliminate Hadoop 1 scheduling disadvantages. YARN is a connecting link between high level applications(Spark, HBase e.t.c) and low level Hadoop environment. With introduction of YARN, Hadoop transformed from only MapReduce framework to big data processing core. Some people characterized YARN as a large-scale, distributed operating system for big data applications.</p><h2 id="Anatomy-of-Yarn"><a class="anchor hidden-xs" href="#Anatomy-of-Yarn" title="Anatomy-of-Yarn"><i class="fa fa-link"></i></a>Anatomy of Yarn</h2><p>YARN provides its core services via two types of long-running daemons:<br>
<strong>1. Resource Manager (one per cluster)</strong> is responsible for tracking the resources in a cluster, and scheduling applications. Actually it responses to resource requests from <strong>Application Master (one per each Yarn application)</strong>, via requesting to Node Managers. It does not monitor and collect any job history. It is only responsible for cluster scheduling. Actually Resource Manager is a single point of failure but Hadoop2 support High Availability which can restore ResourceManager data in case of failures.<br>
<strong>2. Node Manager (one per every node)</strong> is responsible to monitor nodes and containers (slot analogue in MapReduce 1) resources such as CPU, Memory, Disk space, Network e.t.c. It also collects log data and report that information to the Resource Manager.</p><p><strong>Application Master (one per Yarn application)</strong> is another important component of Yarn. It actually runs in a separate container process on a slave node. It has one instance per application, instead of JobTracker, which was a single daemon that runs on a master node and tracks the progress of all applications which was a point of failures. Application Master is responsible to send heartbeat messages to the ResourceManager with its status and the state of the application’s resource needs. Hadoop2 supports <code>uber</code> (lightweight) tasks which can be run by Application Master on same node, without wasting time for allocation. Application Master should be implemented for each Yarn application type, in case of MapReduce it designed to execute map and reduce tasks.</p><h2 id="Steps-to-run-Yarn-application"><a class="anchor hidden-xs" href="#Steps-to-run-Yarn-application" title="Steps-to-run-Yarn-application"><i class="fa fa-link"></i></a>Steps to run Yarn application</h2><p><img src="https://hadoop.apache.org/docs/r2.8.0/hadoop-yarn/hadoop-yarn-site/yarn_architecture.gif" alt="image alt" class="md-image md-image"></p><ol>
<li>Client does a request to Resource Manager (RM) to run application.</li>
<li>RM requests Node Managers to allocate container for creating Application Master (AM) instance on available (which has enough resources) node.</li>
<li>When Application Master (AM) instance already run, itself send requests (heartbeat, app resource needs,…) to RM and manage the application.</li>
</ol><h1 id="Run-spark-application-on-the-cluster"><a class="anchor hidden-xs" href="#Run-spark-application-on-the-cluster" title="Run-spark-application-on-the-cluster"><i class="fa fa-link"></i></a>Run spark application on the cluster</h1><p>In the previous lab, we used <code>master("local[*]")</code> to run the spark application but the execution was done on the local machine and not on the cluster (where <code>*</code> means to use as many CPU cores as exist). Apache Spark supports multiple cluster managers, including standalone spark manager, Hadoop YARN, Mesos,…etc. In this lab, we will use Hadoop YARN to manage the cluster and will learn how we can track the status of Spark jobs on Spark UI.</p><p>You need to create a Zeppelin note where the default interpreter is <code>spark2</code>. To specify the cluster manager as <code>Yarn</code>, make sure that <code>yarn-client</code> is specified as master in the configuration of the interpreter. In yarn-client mode, the driver runs in the client process, and the application master is only used for requesting resources from YARN.</p><div class="alert alert-info">
<p>Spark supports two modes for running on YARN, “yarn-cluster” mode and “yarn-client” mode. Broadly, yarn-cluster mode makes sense for production jobs, while yarn-client mode makes sense for interactive and debugging uses where you want to see your application’s output immediately.</p>
</div><p><img src="https://i.imgur.com/b1CbiIR.png" alt="" class="md-image md-image"></p><center>
<p>
Yarn client mode    
</p>
</center><p><img src="https://i.imgur.com/M3o1dTd.png" alt="" class="md-image md-image"></p><center>
<p>
Yarn cluster mode    
</p>
</center><h1 id="Apache-Spark-MLlib"><a class="anchor hidden-xs" href="#Apache-Spark-MLlib" title="Apache-Spark-MLlib"><i class="fa fa-link"></i></a>Apache Spark MLlib</h1><p>In Spark, we have two different MLlib APIs, The old API which is RDD-based (<code>pyspark.mllib</code>) and the new API which is DataFrame-based (<code>pyspark.ml</code>). As of Spark 2.0, the RDD-based APIs in the <code>pyspark.mllib</code> package have entered maintenance mode. The primary Machine Learning API for Spark is now the DataFrame-based API in the <code>pyspark.ml</code> package.</p><h1 id="Basic-data-structures-in-Spark-MLlib"><a class="anchor hidden-xs" href="#Basic-data-structures-in-Spark-MLlib" title="Basic-data-structures-in-Spark-MLlib"><i class="fa fa-link"></i></a>Basic data structures in Spark MLlib</h1><p>Spark MLlib supports local vectors and matrices stored on a single machine, as well as distributed matrices backed by one or more RDDs.</p><h2 id="Local-vector"><a class="anchor hidden-xs" href="#Local-vector" title="Local-vector"><i class="fa fa-link"></i></a>Local vector</h2><p>A local vector has integer-typed and 0-based indices and double-typed values, stored on a single machine. MLlib supports two types of local vectors: <strong>dense</strong> and <strong>sparse</strong>. A dense vector is backed by a double array representing its entry values, while a sparse vector is backed by two parallel arrays: indices and values. For example, a vector <code>(1.0, 0.0, 3.0)</code> can be represented in dense format as <code>[1.0, 0.0, 3.0]</code> or in sparse format as <code>(3, [0, 2], [1.0, 3.0])</code>, where <code>3</code> is the size of the vector. MLlib recognizes NumPy’s array and Python’s list as dense vectors. You can create sparse vectors using MLlib’s <code>Vectors.SparseVector</code>.</p><pre><code class="wrap python hljs"><span class="hljs-comment">#  Create Spark Context</span>

<span class="hljs-comment"># Import SparkSession</span>
<span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> SparkSession 

<span class="hljs-comment"># Create SparkSession </span>
spark = SparkSession \
        .builder \
        .appName(<span class="hljs-string">"my spark app"</span>) \
        .master(<span class="hljs-string">"yarn"</span>)  \
        .getOrCreate()
<span class="hljs-comment"># run the application on Yarn </span>

sc = spark.sparkContext
</code></pre><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.mllib.linalg <span class="hljs-keyword">import</span> Vectors <span class="hljs-keyword">as</span> Vectors1
<span class="hljs-keyword">from</span> pyspark.ml.linalg <span class="hljs-keyword">import</span> Vectors <span class="hljs-keyword">as</span> Vectors2

<span class="hljs-comment"># Create a SparseVector.</span>
sv1 = Vectors1.sparse(<span class="hljs-number">3</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>])
print(sv1)

<span class="hljs-comment"># Create a SparseVector.</span>
sv2 = Vectors2.sparse(<span class="hljs-number">4</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1.0</span>, <span class="hljs-number">3.0</span>])
sv3 = Vectors2.dense([<span class="hljs-number">0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">3.0</span>])
print(sv2)
print(sv2.toArray())
print(sv2.indices)
print(sv2.values)
print(sv2.norm(<span class="hljs-number">1</span>)) <span class="hljs-comment"># p = 1</span>
print(sv2.norm(<span class="hljs-number">2</span>)) <span class="hljs-comment"># p = 2</span>
print(sv2.norm(<span class="hljs-number">3</span>)) <span class="hljs-comment"># p = 3</span>
print(sv3)
</code></pre><h3 id="Math-operations"><a class="anchor hidden-xs" href="#Math-operations" title="Math-operations"><i class="fa fa-link"></i></a>Math operations</h3><pre><code class="wrap python hljs"><span class="hljs-comment"># For sparse vectors we need to convert to dense vectors in order to perform math operations as follows:</span>
v = Vectors2.dense(Vectors2.sparse(<span class="hljs-number">2</span>, [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>], [<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>]).toArray())
u = Vectors2.dense(Vectors2.sparse(<span class="hljs-number">2</span>, [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>], [<span class="hljs-number">3.0</span>, <span class="hljs-number">4.0</span>]).toArray())


<span class="hljs-comment"># With dense vectors</span>
v = Vectors2.dense([<span class="hljs-number">1.0</span>, <span class="hljs-number">2.0</span>])
u = Vectors2.dense([<span class="hljs-number">3.0</span>, <span class="hljs-number">4.0</span>])

print(v + u)
print(<span class="hljs-number">2</span> - v)
print(v / <span class="hljs-number">2</span>)
print(v * u)
print(u / v)
print(u % <span class="hljs-number">2</span>)
<span class="hljs-comment"># print(-v) # Error</span>
print(<span class="hljs-number">0</span>-v) <span class="hljs-comment"># Correct</span>
</code></pre><p><img src="https://i.imgur.com/t2YxgA9.png" alt="" class="md-image md-image"></p><h2 id="Local-matrix"><a class="anchor hidden-xs" href="#Local-matrix" title="Local-matrix"><i class="fa fa-link"></i></a>Local matrix</h2><p>A local matrix has integer-typed row and column indices and double-typed values, stored on a single machine. For example, the following dense matrix<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd></mtr><mtr><mtd><mn>3.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>5.0</mn></mtd><mtd><mn>6.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 8.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.276em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(2.212em, 1006.95em, 6.36em, -999.997em); top: -4.523em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mrow" id="MathJax-Span-5" style="padding-left: 0.272em;"><span class="mo" id="MathJax-Span-6" style="vertical-align: 2.158em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.853em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.805em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.775em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span class="mtable" id="MathJax-Span-7"><span style="display: inline-block; position: relative; width: 3.559em; height: 0px; margin-right: 0.164em; margin-left: 0.164em;"><span style="position: absolute; clip: rect(2.32em, 1001.24em, 6.091em, -999.997em); top: -4.469em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1001.24em, 4.151em, -999.997em); top: -5.331em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-8"><span class="mrow" id="MathJax-Span-9"><span class="mn" id="MathJax-Span-10" style="font-family: MathJax_Main;">1.0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1001.24em, 4.151em, -999.997em); top: -3.93em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mn" id="MathJax-Span-16" style="font-family: MathJax_Main;">3.0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1001.24em, 4.151em, -999.997em); top: -2.53em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mn" id="MathJax-Span-22" style="font-family: MathJax_Main;">5.0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.475em;"></span></span><span style="position: absolute; clip: rect(2.32em, 1001.24em, 6.091em, -999.997em); top: -4.469em; left: 2.266em;"><span style="display: inline-block; position: relative; width: 1.296em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1001.24em, 4.151em, -999.997em); top: -5.331em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mn" id="MathJax-Span-13" style="font-family: MathJax_Main;">2.0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.24em, 4.151em, -999.997em); top: -3.93em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mn" id="MathJax-Span-19" style="font-family: MathJax_Main;">4.0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1001.24em, 4.151em, -999.997em); top: -2.53em; left: 50%; margin-left: -0.644em;"><span class="mtd" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mn" id="MathJax-Span-25" style="font-family: MathJax_Main;">6.0</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.475em;"></span></span></span></span><span class="mo" id="MathJax-Span-26" style="vertical-align: 2.158em;"><span style="display: inline-block; position: relative; width: 0.649em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.853em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.805em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.775em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.529em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.997em; border-left: 0px solid; width: 0px; height: 4.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1.0</mn></mtd><mtd><mn>2.0</mn></mtd></mtr><mtr><mtd><mn>3.0</mn></mtd><mtd><mn>4.0</mn></mtd></mtr><mtr><mtd><mn>5.0</mn></mtd><mtd><mn>6.0</mn></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">
A= \begin{bmatrix}
1.0 & 2.0 \\
3.0 & 4.0 \\
5.0 & 6.0
\end{bmatrix}
</script></span><br>
is stored in a one-dimensional array <code>[1.0, 3.0, 5.0, 2.0, 4.0, 6.0]</code> with the matrix size <code>(3, 2)</code>.</p><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.mllib.linalg <span class="hljs-keyword">import</span> Matrices <span class="hljs-keyword">as</span> Matrices1
<span class="hljs-keyword">from</span> pyspark.ml.linalg <span class="hljs-keyword">import</span> Matrices <span class="hljs-keyword">as</span> Matrices2

<span class="hljs-comment"># Create a dense matrix ((1.0, 2.0), (3.0, 4.0), (5.0, 6.0))</span>
dm2 = Matrices1.dense(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>])
dm3 = Matrices2.dense(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>])

<span class="hljs-comment"># Create a sparse matrix ((9.0, 0.0), (0.0, 8.0), (0.0, 6.0))</span>
sm2 = Matrices1.sparse(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>])
sm3 = Matrices2.sparse(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>])
</code></pre><h2 id="Distributed-matrix"><a class="anchor hidden-xs" href="#Distributed-matrix" title="Distributed-matrix"><i class="fa fa-link"></i></a>Distributed matrix</h2><p>A distributed matrix has long-typed row and column indices and double-typed values, stored distributively in one or more RDDs. It is very important to choose the right format to store large and distributed matrices. Converting a distributed matrix to a different format may require a global shuffle, which is quite expensive.  Four types of distributed matrices have been implemented so far.</p><p>The basic type is called <strong>RowMatrix</strong>. A RowMatrix is a row-oriented distributed matrix without meaningful row indices, e.g., a collection of feature vectors. It is backed by an RDD of its rows, where each row is a local vector. We assume that the number of columns is not huge for a RowMatrix so that a single local vector can be reasonably communicated to the driver and can also be stored / operated on a single node. An <strong>IndexedRowMatrix</strong> is similar to a RowMatrix but with row indices, which can be used for identifying rows and executing joins. A <strong>CoordinateMatrix</strong> is a distributed matrix stored in coordinate list (COO) format, backed by an RDD of its entries. A <strong>BlockMatrix</strong> is a distributed matrix backed by an RDD of <strong>MatrixBlock</strong> which is a tuple of (Int, Int, Matrix).</p><center>
<p><img src="https://matteding.github.io/images/coo.gif" alt="" title="COO sparse matrix format" width="500" height="250" class="md-image md-image"></p>
</center><h3 id="RowMatrix-RDD-based"><a class="anchor hidden-xs" href="#RowMatrix-RDD-based" title="RowMatrix-RDD-based"><i class="fa fa-link"></i></a>RowMatrix [RDD-based]</h3><p>A RowMatrix is a row-oriented distributed matrix without meaningful row indices, backed by an RDD of its rows, where each row is a local vector. Since each row is represented by a local vector, the number of columns is limited by the integer range but it should be much smaller in practice.</p><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.mllib.linalg.distributed <span class="hljs-keyword">import</span> RowMatrix

<span class="hljs-comment"># Create an RDD of vectors.</span>
rows = sc.parallelize([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>], [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]])

<span class="hljs-comment"># Create a RowMatrix from an RDD of vectors.</span>
mat = RowMatrix(rows)

<span class="hljs-comment"># Get its size.</span>
m = mat.numRows()  <span class="hljs-comment"># 4</span>
n = mat.numCols()  <span class="hljs-comment"># 3</span>

<span class="hljs-comment"># Get the rows as an RDD of vectors again.</span>
rowsRDD = mat.rows
</code></pre><h3 id="IndexedRowMatrix-RDD-based"><a class="anchor hidden-xs" href="#IndexedRowMatrix-RDD-based" title="IndexedRowMatrix-RDD-based"><i class="fa fa-link"></i></a>IndexedRowMatrix [RDD-based]</h3><p>An IndexedRowMatrix is similar to a RowMatrix but with meaningful row indices. It is backed by an RDD of indexed rows, so that each row is represented by its index (long-typed) and a local vector.</p><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.mllib.linalg.distributed <span class="hljs-keyword">import</span> IndexedRow, IndexedRowMatrix

<span class="hljs-comment"># Create an RDD of vectors.</span>
rows = sc.parallelize([IndexedRow(<span class="hljs-number">0</span>,[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]), 
                       IndexedRow(<span class="hljs-number">1</span>,[<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]), 
                       IndexedRow(<span class="hljs-number">2</span>,[<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]), 
                       IndexedRow(<span class="hljs-number">3</span>,[<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>])])

<span class="hljs-comment"># Create a RowMatrix from an RDD of vectors.</span>
mat = IndexedRowMatrix(rows)

<span class="hljs-comment"># Get its size.</span>
m = mat.numRows()  <span class="hljs-comment"># 4</span>
n = mat.numCols()  <span class="hljs-comment"># 3</span>

<span class="hljs-comment"># Get the rows as an RDD of vectors again.</span>
rowsRDD = mat.rows
</code></pre><h3 id="CoordinateMatrix-RDD-based"><a class="anchor hidden-xs" href="#CoordinateMatrix-RDD-based" title="CoordinateMatrix-RDD-based"><i class="fa fa-link"></i></a>CoordinateMatrix [RDD-based]</h3><p>A CoordinateMatrix is a distributed matrix backed by an RDD of its entries. Each entry is a tuple of (i: Long, j: Long, value: Double), where i is the row index, j is the column index, and value is the entry value. A CoordinateMatrix should be used only when both dimensions of the matrix are huge and the matrix is very sparse.</p><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.mllib.linalg.distributed <span class="hljs-keyword">import</span> CoordinateMatrix, MatrixEntry

<span class="hljs-comment"># Create an RDD of coordinate entries.</span>
<span class="hljs-comment">#   - This can be done explicitly with the MatrixEntry class:</span>
entries = sc.parallelize([MatrixEntry(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1.2</span>), MatrixEntry(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2.1</span>), MatrixEntry(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.7</span>)])
<span class="hljs-comment">#   - or using (long, long, float) tuples:</span>
entries = sc.parallelize([(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1.2</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2.1</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3.7</span>)])

<span class="hljs-comment"># Create a CoordinateMatrix from an RDD of MatrixEntries.</span>
mat = CoordinateMatrix(entries)

<span class="hljs-comment"># Get its size.</span>
m = mat.numRows()  <span class="hljs-comment"># 3</span>
n = mat.numCols()  <span class="hljs-comment"># 2</span>

<span class="hljs-comment"># Get the entries as an RDD of MatrixEntries.</span>
entriesRDD = mat.entries

<span class="hljs-comment"># Convert to a RowMatrix.</span>
rowMat = mat.toRowMatrix()

<span class="hljs-comment"># Convert to an IndexedRowMatrix.</span>
indexedRowMat = mat.toIndexedRowMatrix()

<span class="hljs-comment"># Convert to a BlockMatrix.</span>
blockMat = mat.toBlockMatrix()
</code></pre><h3 id="BlockMatrix-RDD-based"><a class="anchor hidden-xs" href="#BlockMatrix-RDD-based" title="BlockMatrix-RDD-based"><i class="fa fa-link"></i></a>BlockMatrix [RDD-based]</h3><p>A BlockMatrix is a distributed matrix backed by an RDD of MatrixBlocks, where a MatrixBlock is a tuple of ((Int, Int), Matrix), where the (Int, Int) is the index of the block, and Matrix is the sub-matrix at the given index with size rowsPerBlock x colsPerBlock. BlockMatrix supports methods such as add and multiply with another BlockMatrix. BlockMatrix also has a helper function validate which can be used to check whether the BlockMatrix is set up properly.</p><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.mllib.linalg <span class="hljs-keyword">import</span> Matrices
<span class="hljs-keyword">from</span> pyspark.mllib.linalg.distributed <span class="hljs-keyword">import</span> BlockMatrix

<span class="hljs-comment"># Create an RDD of sub-matrix blocks.</span>
blocks = sc.parallelize([((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), Matrices.dense(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])),
                         ((<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), Matrices.dense(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]))])

<span class="hljs-comment"># Create a BlockMatrix from an RDD of sub-matrix blocks.</span>
mat = BlockMatrix(blocks, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>)

<span class="hljs-comment"># Get its size.</span>
m = mat.numRows()  <span class="hljs-comment"># 6</span>
n = mat.numCols()  <span class="hljs-comment"># 2</span>

<span class="hljs-comment"># Get the blocks as an RDD of sub-matrix blocks.</span>
blocksRDD = mat.blocks

<span class="hljs-comment"># Convert to a LocalMatrix.</span>
localMat = mat.toLocalMatrix()

<span class="hljs-comment"># Convert to an IndexedRowMatrix.</span>
indexedRowMat = mat.toIndexedRowMatrix()

<span class="hljs-comment"># Convert to a CoordinateMatrix.</span>
coordinateMat = mat.toCoordinateMatrix()
</code></pre><div class="alert alert-warning">
<p>We recommend to use local vectors and store them in distributed dataframes. Feel free to use distributed matrices if needed but avoid using local matrices which operate only on a single machine.</p>
</div><h3 id="Compressed-Sparse-Matrices-in-pysparkmllinalg"><a class="anchor hidden-xs" href="#Compressed-Sparse-Matrices-in-pysparkmllinalg" title="Compressed-Sparse-Matrices-in-pysparkmllinalg"><i class="fa fa-link"></i></a>Compressed Sparse Matrices in pyspark.ml.linalg</h3><p>Sparse Matrix stored in CSC format.</p><center>
<p><img src="https://matteding.github.io/images/csc.gif" alt="" title="CSC sparse matrix format" width="500" height="250" class="md-image md-image"></p>
</center><p>Adjacent pairs of index pointers determine two things. First, their position in the pointer array is the row number. Second, these values represent the [start:stop] slice of the indices array, and their difference is the NNZ elements in each row. Using the pointers, look up the indices to determine the column for each element in the data.</p><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.ml.linalg <span class="hljs-keyword">import</span> SparseMatrix, DenseMatrix, Matrices

mat = SparseMatrix(<span class="hljs-number">7</span>, <span class="hljs-number">5</span>, [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>], [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">8</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>])

rows = mat.numRows
cols = mat.numCols

numpyArray = mat.toArray()

denseMat = mat.toDense()
</code></pre><h1 id="Feature-Extraction"><a class="anchor hidden-xs" href="#Feature-Extraction" title="Feature-Extraction"><i class="fa fa-link"></i></a>Feature Extraction</h1><p>For most ML pipelines, feature extraction is one of the first stages to do. The need to extract features from the data has multiple advantages. One of them is to reduce the dimensionality of the data, and also to increase the performance of ML models.</p><h2 id="Pipeline"><a class="anchor hidden-xs" href="#Pipeline" title="Pipeline"><i class="fa fa-link"></i></a>Pipeline</h2><p>A simple pipeline, which acts as an estimator. A Pipeline consists of a sequence of stages, each of which is either an <strong>Estimator</strong> or a <strong>Transformer</strong>. When <code>Pipeline.fit()</code> is called, the stages are executed in order. If a stage is an <strong>Estimator</strong>, its <code>Estimator.fit()</code> method will be called on the input dataset to fit a model. Then the model, which is a transformer, will be used to transform the dataset as the input to the next stage. If a stage is a <strong>Transformer</strong>, its <code>Transformer.transform()</code> method will be called to produce the dataset for the next stage. <em><strong>The fitted model from a Pipeline is a PipelineModel</strong></em>, which consists of fitted models and transformers, corresponding to the pipeline stages. If stages is an empty list, the pipeline acts as an identity transformer.</p><h2 id="Example-on-TF-IDF"><a class="anchor hidden-xs" href="#Example-on-TF-IDF" title="Example-on-TF-IDF"><i class="fa fa-link"></i></a>Example on TF-IDF</h2><p>Term frequency-inverse document frequency (TF-IDF) is a feature vectorization method widely used in text mining to reflect the importance of a term to a document in the corpus. It is give by the following formula:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>:</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mspace linebreak=&quot;newline&quot; /><mi>d</mi><mo>:</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mspace linebreak=&quot;newline&quot; /><mi>D</mi><mo>:</mo><mi>c</mi><mi>o</mi><mi>r</mi><mi>p</mi><mi>u</mi><mi>s</mi><mspace linebreak=&quot;newline&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>:</mo><mtext>number of elements in the corpus</mtext><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mo>:</mo><mtext>Term Frequency: the number of times that term &amp;#x1D461; appears in document d</mtext><mspace linebreak=&quot;newline&quot; /><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>:</mo><mtext>Document Frequency: the number of documents that contains term &amp;#x1D461;</mtext><mspace linebreak=&quot;newline&quot; /><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>:</mo><mtext>Inverse Document Frequency is a numerical measure of how much</mtext><mspace linebreak=&quot;newline&quot; /><mtext>information a term provides</mtext></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-27" style="width: 41.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 35.725em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(10.455em, 1035.72em, 21.07em, -999.997em); top: -11.258em; left: 0em;"><span class="mrow" id="MathJax-Span-28"><span style="display: inline-block; position: relative; width: 35.725em; height: 0px;"><span style="position: absolute; clip: rect(3.182em, 1003.34em, 4.151em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">t</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1005.66em, 4.151em, -999.997em); top: -2.799em; left: 0em;"><span class="mspace" id="MathJax-Span-35" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1004.53em, 4.367em, -999.997em); top: -1.56em; left: 0em;"><span class="mspace" id="MathJax-Span-46" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">c</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1016.44em, 4.421em, -999.997em); top: -0.213em; left: 0em;"><span class="mspace" id="MathJax-Span-55" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-56"><span class="mrow" id="MathJax-Span-57"><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">D</span><span class="texatom" id="MathJax-Span-60"><span class="mrow" id="MathJax-Span-61"><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mtext" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.272em;">number of elements in the corpus</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1035.72em, 4.421em, -999.997em); top: 1.242em; left: 0em;"><span class="mspace" id="MathJax-Span-65" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mtext" id="MathJax-Span-74" style="font-family: MathJax_Main; padding-left: 0.272em;">Term Frequency: the number of times that term <span style="font-family: MathJax_Math-italic;">t</span> appears in document d</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1034.43em, 4.421em, -999.997em); top: 2.643em; left: 0em;"><span class="mspace" id="MathJax-Span-75" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mtext" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.272em;">Document Frequency: the number of documents that contains term <span style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1033.68em, 4.421em, -999.997em); top: 4.098em; left: 0em;"><span class="mspace" id="MathJax-Span-85" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mtext" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.272em;">Inverse Document Frequency is a numerical measure of how much</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1012.02em, 4.367em, -999.997em); top: 5.445em; left: 0em;"><span class="mspace" id="MathJax-Span-96" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-97" style="font-family: MathJax_Main;">information a term provides</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 11.263em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -11.247em; border-left: 0px solid; width: 0px; height: 12.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>:</mo><mi>t</mi><mi>e</mi><mi>r</mi><mi>m</mi><mspace linebreak="newline"></mspace><mi>d</mi><mo>:</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mspace linebreak="newline"></mspace><mi>D</mi><mo>:</mo><mi>c</mi><mi>o</mi><mi>r</mi><mi>p</mi><mi>u</mi><mi>s</mi><mspace linebreak="newline"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>:</mo><mtext>number of elements in the corpus</mtext><mspace linebreak="newline"></mspace><mi>T</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo><mo>:</mo><mtext>Term Frequency: the number of times that term 𝑡 appears in document d</mtext><mspace linebreak="newline"></mspace><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>:</mo><mtext>Document Frequency: the number of documents that contains term 𝑡</mtext><mspace linebreak="newline"></mspace><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>:</mo><mtext>Inverse Document Frequency is a numerical measure of how much</mtext><mspace linebreak="newline"></mspace><mtext>information a term provides</mtext></math></span></span><script type="math/tex" id="MathJax-Element-2">t: term \\ d: document \\ D: corpus \\ |D|: \text{number of elements in the corpus} \\ TF(t, d):\text{Term Frequency: the number of times that term 𝑡 appears in document d}\\ DF(t,D): \text{Document Frequency: the number of documents that contains term 𝑡}\\  IDF(t,D): \text{Inverse Document Frequency is a numerical measure of how much}\\\text{information a term provides}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" style="width: 14.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.772em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.757em, 1012.77em, 3.505em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">l</span><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-112"><span style="display: inline-block; position: relative; width: 5.498em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1003.02em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.56em;"><span class="mrow" id="MathJax-Span-113"><span class="texatom" id="MathJax-Span-114"><span class="mrow" id="MathJax-Span-115"><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-italic;">D</span><span class="texatom" id="MathJax-Span-118"><span class="mrow" id="MathJax-Span-119"><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1005.34em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -2.691em;"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1005.5em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.498em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">
IDF(t,D) = log \frac{|D|+1}{DF(t,d)+1}
</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi><mi>F</mi><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>:</mo><mtext>the product of TF and IDF</mtext></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 23.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.83em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1019.78em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span class="mtext" id="MathJax-Span-149" style="font-family: MathJax_Main; padding-left: 0.272em;">the product of TF and IDF</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>F</mi><mi mathvariant="normal">_</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>:</mo><mtext>the product of TF and IDF</mtext></math></span></span><script type="math/tex" id="MathJax-Element-4">TF\_IDF(t,d,D): \text{the product of TF and IDF}</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>T</mi><mi>F</mi><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>T</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x00D7;</mo><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-150" style="width: 20.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.998em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.457em, 1017.89em, 2.804em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main; padding-left: 0.218em;">×</span><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math-italic; padding-left: 0.218em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mi>F</mi><mi mathvariant="normal">_</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo><mo>×</mo><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">
TF\_IDF(t,d,D) = TF(t, d)\times IDF(t,D)
</script></span></p><p>Example:<br>
We have two documents:</p><ol>
<li>“Python python Spark Spark”</li>
<li>“Python SQL”</li>
</ol><p>Then,</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D466;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D461;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x210E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45B;</mo></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D451;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D450;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D462;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45A;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D452;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45B;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D461;</mo></mrow><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>,</mo><mi>T</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D460;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D44E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D458;</mo></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D451;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D450;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D462;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45A;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D452;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45B;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D461;</mo></mrow><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn><mo>,</mo><mi>T</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D460;</mo></mrow><mi>q</mi><mi>l</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D451;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45C;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D450;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D462;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45A;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D452;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45B;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D461;</mo></mrow><mn>2</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mspace linebreak=&quot;newline&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D437;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D439;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D44E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D458;</mo></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D437;</mo></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D437;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D439;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>y</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>n</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D437;</mo></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D437;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D439;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D460;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D459;</mo></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D437;</mo></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mspace linebreak=&quot;newline&quot; /><mi>I</mi><mi>D</mi><mi>F</mi><mo>:</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-182" style="width: 41.22em; display: inline-block;"><span style="display: inline-block; position: relative; width: 35.509em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(3.613em, 1035.45em, 7.492em, -999.997em); top: -4.523em; left: 0em;"><span class="mrow" id="MathJax-Span-183"><span style="display: inline-block; position: relative; width: 35.509em; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1035.45em, 4.421em, -999.997em); top: -3.984em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-187"><span class="mrow" id="MathJax-Span-188"><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="texatom" id="MathJax-Span-190"><span class="mrow" id="MathJax-Span-191"><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">y</span></span></span><span class="texatom" id="MathJax-Span-193"><span class="mrow" id="MathJax-Span-194"><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">t</span></span></span><span class="texatom" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Math-italic;">h</span></span></span><span class="texatom" id="MathJax-Span-199"><span class="mrow" id="MathJax-Span-200"><span class="mo" id="MathJax-Span-201" style="font-family: MathJax_Math-italic;">o</span></span></span><span class="texatom" id="MathJax-Span-202"><span class="mrow" id="MathJax-Span-203"><span class="mo" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">n</span></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-206" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-207"><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">d</span></span></span><span class="texatom" id="MathJax-Span-209"><span class="mrow" id="MathJax-Span-210"><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Math-italic;">o</span></span></span><span class="texatom" id="MathJax-Span-212"><span class="mrow" id="MathJax-Span-213"><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">c</span></span></span><span class="texatom" id="MathJax-Span-215"><span class="mrow" id="MathJax-Span-216"><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">u</span></span></span><span class="texatom" id="MathJax-Span-218"><span class="mrow" id="MathJax-Span-219"><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Math-italic;">m</span></span></span><span class="texatom" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Math-italic;">e</span></span></span><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">n</span></span></span><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Math-italic;">t</span></span></span><span class="mn" id="MathJax-Span-230" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-233" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-238"><span class="mrow" id="MathJax-Span-239"><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">s</span></span></span><span class="texatom" id="MathJax-Span-241"><span class="mrow" id="MathJax-Span-242"><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="texatom" id="MathJax-Span-244"><span class="mrow" id="MathJax-Span-245"><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Math-italic;">a</span></span></span><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">r</span></span></span><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">k</span></span></span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-254" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-255"><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Math-italic;">d</span></span></span><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mo" id="MathJax-Span-259" style="font-family: MathJax_Math-italic;">o</span></span></span><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Math-italic;">c</span></span></span><span class="texatom" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Math-italic;">u</span></span></span><span class="texatom" id="MathJax-Span-266"><span class="mrow" id="MathJax-Span-267"><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Math-italic;">m</span></span></span><span class="texatom" id="MathJax-Span-269"><span class="mrow" id="MathJax-Span-270"><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Math-italic;">e</span></span></span><span class="texatom" id="MathJax-Span-272"><span class="mrow" id="MathJax-Span-273"><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">n</span></span></span><span class="texatom" id="MathJax-Span-275"><span class="mrow" id="MathJax-Span-276"><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Math-italic;">t</span></span></span><span class="mn" id="MathJax-Span-278" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-281" style="font-family: MathJax_Main; padding-left: 0.272em;">2</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-286"><span class="mrow" id="MathJax-Span-287"><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Math-italic;">s</span></span></span><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-292" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-293"><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Math-italic;">d</span></span></span><span class="texatom" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">o</span></span></span><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Math-italic;">c</span></span></span><span class="texatom" id="MathJax-Span-301"><span class="mrow" id="MathJax-Span-302"><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Math-italic;">u</span></span></span><span class="texatom" id="MathJax-Span-304"><span class="mrow" id="MathJax-Span-305"><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">m</span></span></span><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Math-italic;">e</span></span></span><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Math-italic;">n</span></span></span><span class="texatom" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Math-italic;">t</span></span></span><span class="mn" id="MathJax-Span-316" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-319" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1023.55em, 4.421em, -999.997em); top: -2.53em; left: 0em;"><span class="mspace" id="MathJax-Span-320" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-321"><span class="mrow" id="MathJax-Span-322"><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">D</span></span></span><span class="texatom" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Math-italic;">F</span></span></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">s</span><span class="texatom" id="MathJax-Span-329"><span class="mrow" id="MathJax-Span-330"><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="texatom" id="MathJax-Span-332"><span class="mrow" id="MathJax-Span-333"><span class="mo" id="MathJax-Span-334" style="font-family: MathJax_Math-italic;">a</span></span></span><span class="texatom" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">r</span></span></span><span class="texatom" id="MathJax-Span-338"><span class="mrow" id="MathJax-Span-339"><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">k</span></span></span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-342" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-343"><span class="mo" id="MathJax-Span-344" style="font-family: MathJax_Math-italic;">D</span></span></span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.272em;">2</span><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-349" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-350"><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Math-italic;">D</span></span></span><span class="texatom" id="MathJax-Span-352"><span class="mrow" id="MathJax-Span-353"><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Math-italic;">F</span></span></span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-361" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-363" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-364"><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Math-italic;">D</span></span></span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-367" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-368" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-370" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-371"><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Math-italic;">D</span></span></span><span class="texatom" id="MathJax-Span-373"><span class="mrow" id="MathJax-Span-374"><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Math-italic;">F</span></span></span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-377"><span class="mrow" id="MathJax-Span-378"><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">s</span></span></span><span class="texatom" id="MathJax-Span-380"><span class="mrow" id="MathJax-Span-381"><span class="mo" id="MathJax-Span-382" style="font-family: MathJax_Math-italic;">q</span></span></span><span class="texatom" id="MathJax-Span-383"><span class="mrow" id="MathJax-Span-384"><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">l</span></span></span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-387" style="padding-left: 0.164em;"><span class="mrow" id="MathJax-Span-388"><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Math-italic;">D</span></span></span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-392" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1002.53em, 4.151em, -999.997em); top: -1.183em; left: 0em;"><span class="mspace" id="MathJax-Span-393" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main; padding-left: 0.272em;">:</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.529em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.309em; border-left: 0px solid; width: 0px; height: 4.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>F</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑝</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑦</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑡</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>ℎ</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑜</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑛</mo></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑑</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑜</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑐</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑢</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑚</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑒</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑛</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑡</mo></mrow><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>,</mo><mi>T</mi><mi>F</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑠</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑝</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑎</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑟</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑘</mo></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑑</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑜</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑐</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑢</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑚</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑒</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑛</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑡</mo></mrow><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>,</mo><mi>T</mi><mi>F</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑠</mo></mrow><mi>q</mi><mi>l</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑑</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑜</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑐</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑢</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑚</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑒</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑛</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑡</mo></mrow><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mrow class="MJX-TeXAtom-ORD"><mo>𝐷</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝐹</mo></mrow><mo stretchy="false">(</mo><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>𝑝</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑎</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑟</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑘</mo></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝐷</mo></mrow><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝐷</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝐹</mo></mrow><mo stretchy="false">(</mo><mi>p</mi><mi>y</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>n</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝐷</mo></mrow><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝐷</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝐹</mo></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑠</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑞</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑙</mo></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝐷</mo></mrow><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mi>I</mi><mi>D</mi><mi>F</mi><mo>:</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">TF(𝑝𝑦𝑡ℎ𝑜𝑛, 𝑑𝑜𝑐𝑢𝑚𝑒𝑛𝑡1) = 1, TF(𝑠𝑝𝑎𝑟𝑘, 𝑑𝑜𝑐𝑢𝑚𝑒𝑛𝑡1)=2, TF(𝑠ql, 𝑑𝑜𝑐𝑢𝑚𝑒𝑛𝑡2)=1\\𝐷𝐹(s𝑝𝑎𝑟𝑘, 𝐷) = 2, 𝐷𝐹(python, 𝐷)=1, 𝐷𝐹(𝑠𝑞𝑙, 𝐷)=1\\IDF:</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>y</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>n</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-398" style="width: 26.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.416em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.757em, 1022.36em, 3.505em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-399"><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-413" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">l</span><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-417"><span style="display: inline-block; position: relative; width: 5.498em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1003.02em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.56em;"><span class="mrow" id="MathJax-Span-418"><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mo" id="MathJax-Span-421" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic;">D</span><span class="texatom" id="MathJax-Span-423"><span class="mrow" id="MathJax-Span-424"><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-427" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1005.34em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -2.691em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-433" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-437" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1005.5em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.498em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">l</span><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-442"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1002.16em, 4.259em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-443"><span class="mn" id="MathJax-Span-444" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-446" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1002.16em, 4.259em, -999.997em); top: -3.284em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-447"><span class="mn" id="MathJax-Span-448" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-450" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.32em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.32em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-452" style="font-family: MathJax_Main; padding-left: 0.272em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>p</mi><mi>y</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>n</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">
IDF(python, D)=log \frac{|D|+1}{DF(t,d)+1}=log \frac{2+1}{2+1}=0
</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D446;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D44E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D458;</mo></mrow><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>0.405465</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-453" style="width: 29.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.272em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.757em, 1025.22em, 3.505em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-454"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-459"><span class="mrow" id="MathJax-Span-460"><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Math-italic;">S</span></span></span><span class="texatom" id="MathJax-Span-462"><span class="mrow" id="MathJax-Span-463"><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="texatom" id="MathJax-Span-465"><span class="mrow" id="MathJax-Span-466"><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Math-italic;">a</span></span></span><span class="texatom" id="MathJax-Span-468"><span class="mrow" id="MathJax-Span-469"><span class="mo" id="MathJax-Span-470" style="font-family: MathJax_Math-italic;">r</span></span></span><span class="texatom" id="MathJax-Span-471"><span class="mrow" id="MathJax-Span-472"><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">k</span></span></span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">l</span><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-481"><span style="display: inline-block; position: relative; width: 5.498em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1003.02em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.56em;"><span class="mrow" id="MathJax-Span-482"><span class="texatom" id="MathJax-Span-483"><span class="mrow" id="MathJax-Span-484"><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math-italic;">D</span><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mo" id="MathJax-Span-489" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-491" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1005.34em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -2.691em;"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-499" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-501" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1005.5em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.498em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">l</span><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-506"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1002.16em, 4.259em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-507"><span class="mn" id="MathJax-Span-508" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-510" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1002.16em, 4.259em, -999.997em); top: -3.284em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-511"><span class="mn" id="MathJax-Span-512" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-514" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.32em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.32em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-516" style="font-family: MathJax_Main; padding-left: 0.272em;">0.405465</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑆</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑝</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑎</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑟</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑘</mo></mrow><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>0.405465</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">
IDF(𝑆𝑝𝑎𝑟𝑘, D)=log \frac{|D|+1}{DF(t,d)+1}=log \frac{2+1}{1+1}=0.405465
</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D446;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D44E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D458;</mo></mrow><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>0.405465</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-517" style="width: 29.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.272em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.757em, 1025.22em, 3.505em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-518"><span class="mi" id="MathJax-Span-519" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-523"><span class="mrow" id="MathJax-Span-524"><span class="mo" id="MathJax-Span-525" style="font-family: MathJax_Math-italic;">S</span></span></span><span class="texatom" id="MathJax-Span-526"><span class="mrow" id="MathJax-Span-527"><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="texatom" id="MathJax-Span-529"><span class="mrow" id="MathJax-Span-530"><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Math-italic;">a</span></span></span><span class="texatom" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;">r</span></span></span><span class="texatom" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;">k</span></span></span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-540" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">l</span><span class="mi" id="MathJax-Span-543" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-544" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-545"><span style="display: inline-block; position: relative; width: 5.498em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.074em, 1003.02em, 4.421em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.56em;"><span class="mrow" id="MathJax-Span-546"><span class="texatom" id="MathJax-Span-547"><span class="mrow" id="MathJax-Span-548"><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">D</span><span class="texatom" id="MathJax-Span-551"><span class="mrow" id="MathJax-Span-552"><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-554" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-555" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1005.34em, 4.421em, -999.997em); top: -3.284em; left: 50%; margin-left: -2.691em;"><span class="mrow" id="MathJax-Span-556"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1005.5em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.498em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic; padding-left: 0.272em;">l</span><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-570"><span style="display: inline-block; position: relative; width: 2.32em; height: 0px; margin-right: 0.11em; margin-left: 0.11em;"><span style="position: absolute; clip: rect(3.182em, 1002.16em, 4.259em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-571"><span class="mn" id="MathJax-Span-572" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-574" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.182em, 1002.16em, 4.259em, -999.997em); top: -3.284em; left: 50%; margin-left: -1.129em;"><span class="mrow" id="MathJax-Span-575"><span class="mn" id="MathJax-Span-576" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main; padding-left: 0.218em;">+</span><span class="mn" id="MathJax-Span-578" style="font-family: MathJax_Main; padding-left: 0.218em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1002.32em, 1.242em, -999.997em); top: -1.29em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.32em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-580" style="font-family: MathJax_Main; padding-left: 0.272em;">0.405465</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑆</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑝</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑎</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑟</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑘</mo></mrow><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></mrow><mrow><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mn>2</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>1</mn><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>0.405465</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">
IDF(𝑆𝑝𝑎𝑟𝑘, D)=log \frac{|D|+1}{DF(t,d)+1}=log \frac{2+1}{1+1}=0.405465
</script></span></p><p>So <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi><mi>F</mi><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mi>I</mi><mi>D</mi><mi>F</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-581" style="width: 4.69em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1004.04em, 2.589em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-582"><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-584" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-585" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-588" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mi>F</mi><mi mathvariant="normal">_</mi><mi>I</mi><mi>D</mi><mi>F</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">TF\_IDF</script></span> is:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>T</mi><mi>F</mi><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>y</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>n</mi><mo>,</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>3</mn><mo>&amp;#x2217;</mo><mn>0</mn><mo>=</mo><mn>0</mn><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>F</mi><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D460;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D44E;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D45F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D458;</mo></mrow><mo>,</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn><mo>&amp;#x2217;</mo><mn>0.405465</mn><mo>=</mo><mn>0.81093</mn><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>F</mi><mi mathvariant=&quot;normal&quot;>&amp;#x005F;</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x1D460;</mo></mrow><mi>q</mi><mi>l</mi><mo>,</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mn>2</mn><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>1</mn><mo>&amp;#x2217;</mo><mn>0.405465</mn><mo>=</mo><mn>0.405465</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-589" style="width: 100%; display: inline-block; min-width: 28.936em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(3.936em, 1024.89em, 8.138em, -999.997em); top: -4.846em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-590"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.074em, 1019.4em, 4.421em, -999.997em); top: -3.984em; left: 50%; margin-left: -9.696em;"><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-600" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math-italic;">t</span><span class="mn" id="MathJax-Span-613" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-618" style="font-family: MathJax_Main; padding-left: 0.272em;">3</span><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mn" id="MathJax-Span-620" style="font-family: MathJax_Main; padding-left: 0.218em;">0</span><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.272em;">0</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1024.89em, 4.421em, -999.997em); top: -2.53em; left: 50%; margin-left: -12.497em;"><span class="mspace" id="MathJax-Span-623" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-625" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-628" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-630" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-631"><span class="mrow" id="MathJax-Span-632"><span class="mo" id="MathJax-Span-633" style="font-family: MathJax_Math-italic;">s</span></span></span><span class="texatom" id="MathJax-Span-634"><span class="mrow" id="MathJax-Span-635"><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="texatom" id="MathJax-Span-637"><span class="mrow" id="MathJax-Span-638"><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Math-italic;">a</span></span></span><span class="texatom" id="MathJax-Span-640"><span class="mrow" id="MathJax-Span-641"><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Math-italic;">r</span></span></span><span class="texatom" id="MathJax-Span-643"><span class="mrow" id="MathJax-Span-644"><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Math-italic;">k</span></span></span><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-650" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-654" style="font-family: MathJax_Math-italic;">t</span><span class="mn" id="MathJax-Span-655" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-656" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-657" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-658" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-659" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-660" style="font-family: MathJax_Main; padding-left: 0.272em;">2</span><span class="mo" id="MathJax-Span-661" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mn" id="MathJax-Span-662" style="font-family: MathJax_Main; padding-left: 0.218em;">0.405465</span><span class="mo" id="MathJax-Span-663" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.272em;">0.81093</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; clip: rect(3.074em, 1024.14em, 4.421em, -999.997em); top: -1.129em; left: 50%; margin-left: -12.12em;"><span class="mspace" id="MathJax-Span-665" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-667" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-669" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mi" id="MathJax-Span-670" style="font-family: MathJax_Math-italic;">D</span><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span><span class="mo" id="MathJax-Span-672" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-673"><span class="mrow" id="MathJax-Span-674"><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Math-italic;">s</span></span></span><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-677" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-681" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-685" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Math-italic;">t</span><span class="mn" id="MathJax-Span-687" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-689" style="font-family: MathJax_Math-italic; padding-left: 0.164em;">D</span><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-692" style="font-family: MathJax_Main; padding-left: 0.272em;">1</span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main; padding-left: 0.218em;">∗</span><span class="mn" id="MathJax-Span-694" style="font-family: MathJax_Main; padding-left: 0.218em;">0.405465</span><span class="mo" id="MathJax-Span-695" style="font-family: MathJax_Main; padding-left: 0.272em;">=</span><span class="mn" id="MathJax-Span-696" style="font-family: MathJax_Main; padding-left: 0.272em;">0.405465</span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.852em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.684em; border-left: 0px solid; width: 0px; height: 4.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mi>F</mi><mi mathvariant="normal">_</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mi>p</mi><mi>y</mi><mi>t</mi><mi>h</mi><mi>o</mi><mi>n</mi><mo>,</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn><mo>∗</mo><mn>0</mn><mo>=</mo><mn>0</mn><mspace linebreak="newline"></mspace><mi>T</mi><mi>F</mi><mi mathvariant="normal">_</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑠</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑝</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑎</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑟</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>𝑘</mo></mrow><mo>,</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>∗</mo><mn>0.405465</mn><mo>=</mo><mn>0.81093</mn><mspace linebreak="newline"></mspace><mi>T</mi><mi>F</mi><mi mathvariant="normal">_</mi><mi>I</mi><mi>D</mi><mi>F</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo>𝑠</mo></mrow><mi>q</mi><mi>l</mi><mo>,</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><mn>2</mn><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>∗</mo><mn>0.405465</mn><mo>=</mo><mn>0.405465</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">
TF\_IDF(python, document1, D) = 3 * 0 = 0\\
TF\_IDF(𝑠𝑝𝑎𝑟𝑘, document1, D) = 2 * 0.405465 = 0.81093\\
TF\_IDF(𝑠ql, document2, D) = 1 * 0.405465 = 0.405465
</script></span></p><ol>
<li>Import packages</li>
</ol><pre><code class="wrap python hljs"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> SparkSession
</code></pre><ol start="2">
<li>Create session and get SparkContext</li>
</ol><pre><code class="wrap python hljs">spark = SparkSession \
        .builder \
        .appName(<span class="hljs-string">"my spark app"</span>) \
        .master(<span class="hljs-string">"yarn"</span>) \
        .getOrCreate()
sc = spark.sparkContex
</code></pre><ol start="3">
<li>Test on the previous example.</li>
</ol><p><strong>Count Vectorizer:</strong> is a popular alogoritm used to generate term frequency vectors. It basically convert documents into a numerical representation which can be fed directly or with further processing into other algorithms like LDA (topic modeling).</p><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.ml <span class="hljs-keyword">import</span> Pipeline
<span class="hljs-keyword">from</span> pyspark.ml.feature <span class="hljs-keyword">import</span> CountVectorizer, HashingTF, IDF, Tokenizer, StopWordsRemover

<span class="hljs-comment"># Create dataframe to hold the sentences</span>
sentenceData = spark.createDataFrame([
    (<span class="hljs-number">0</span>, <span class="hljs-string">"Python python Spark Spark"</span>),
    (<span class="hljs-number">1</span>, <span class="hljs-string">"Python SQL"</span>)],
    [<span class="hljs-string">"document"</span>, <span class="hljs-string">"sentence"</span>]
)

<span class="hljs-comment"># Tokenization</span>
tokenizer = Tokenizer(inputCol=<span class="hljs-string">"sentence"</span>, outputCol=<span class="hljs-string">"words"</span>)

<span class="hljs-comment"># Count vectorizer</span>
vectorizer = CountVectorizer(inputCol=<span class="hljs-string">"words"</span>, outputCol=<span class="hljs-string">"rawFeatures"</span>)

<span class="hljs-comment"># HashingTF</span>
<span class="hljs-comment"># vectorizer = HashingTF(inputCol="words", outputCol="rawFeatures")</span>

<span class="hljs-comment"># TF-IDF</span>
idf = IDF(inputCol=<span class="hljs-string">"rawFeatures"</span>, outputCol=<span class="hljs-string">"features"</span>)
pipeline = Pipeline(stages=[tokenizer, vectorizer, idf])

<span class="hljs-comment"># Fit the pipeline</span>
model = pipeline.fit(sentenceData)

<span class="hljs-comment"># Calculate the total count of each term in all documents </span>
total_counts = model.transform(sentenceData)\
.select(<span class="hljs-string">'rawFeatures'</span>).rdd\
.map(<span class="hljs-keyword">lambda</span> row: row[<span class="hljs-string">'rawFeatures'</span>].toArray())\
.reduce(<span class="hljs-keyword">lambda</span> x,y: [x[i]+y[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(y))])


<span class="hljs-comment"># Return the vocabulary of CountVectorizer</span>
vocabList = model.stages[<span class="hljs-number">1</span>].vocabulary

<span class="hljs-comment"># Create dict with total counts for the terms</span>
d = {<span class="hljs-string">'vocabList'</span>:vocabList,<span class="hljs-string">'counts'</span>:total_counts}

<span class="hljs-comment"># Can show it as a dataframe</span>
spark.createDataFrame(np.array(list(d.values())).T.tolist(),list(d.keys())).show()

<span class="hljs-comment"># Output of CountVectorizer</span>
counts = model.transform(sentenceData).select(<span class="hljs-string">'rawFeatures'</span>).collect()


<span class="hljs-comment"># Return the TF-IDF in column `features`</span>
model.transform(sentenceData).show(truncate=<span class="hljs-literal">False</span>)
</code></pre><ol start="4">
<li>Retrieve the terms from indices</li>
</ol><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.sql.types <span class="hljs-keyword">import</span> ArrayType, StringType, DoubleType, IntegerType
<span class="hljs-keyword">import</span> pyspark.sql.functions <span class="hljs-keyword">as</span> F

<span class="hljs-comment"># Get output of Count Vectorizer</span>
rawFeatures = model.transform(sentenceData).select(<span class="hljs-string">'rawFeatures'</span>)

<span class="hljs-comment"># show the dataframe</span>
rawFeatures.show()

<span class="hljs-comment"># Create a function for the conversion</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">termsIdx2Term</span><span class="hljs-params">(vocabulary)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">termsIdx2Term</span><span class="hljs-params">(termIndices)</span>:</span>
        <span class="hljs-keyword">return</span> [vocabulary[int(index)] <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> termIndices]
    <span class="hljs-keyword">return</span> F.udf(termsIdx2Term, ArrayType(StringType()))


<span class="hljs-comment"># register the UDFs</span>
indices_udf = F.udf(<span class="hljs-keyword">lambda</span> vector: vector.indices.tolist(), ArrayType(IntegerType()))

values_udf = F.udf(<span class="hljs-keyword">lambda</span> vector: vector.toArray().tolist(), ArrayType(DoubleType()))


<span class="hljs-comment"># Apply the UDFs</span>
temp = rawFeatures.withColumn(<span class="hljs-string">'indices'</span>,indices_udf(F.col(<span class="hljs-string">'rawFeatures'</span>)))\
    .withColumn(<span class="hljs-string">'values'</span>, values_udf(F.col(<span class="hljs-string">'rawFeatures'</span>)))\
    .withColumn(<span class="hljs-string">"Terms"</span>, termsIdx2Term(vocabList)(<span class="hljs-string">"indices"</span>))
    
<span class="hljs-comment"># show the result</span>
temp.show()
</code></pre><ol start="5">
<li>Test on a larger dataset. Upload <a href="https://raw.githubusercontent.com/reisanar/datasets/master/HollywoodMovies.csv" target="_blank" rel="noopener"><code>HollywoodMovies.csv</code></a> to HDFS.</li>
<li>Read from HDFS</li>
</ol><pre><code class="wrap python hljs"><span class="hljs-comment"># %pyspark</span>
<span class="hljs-comment"># </span>
path = <span class="hljs-string">"HollywoodMovies.csv"</span> <span class="hljs-comment"># HDFS</span>
df = spark.read.load(path, format=<span class="hljs-string">"csv"</span>, sep = <span class="hljs-string">","</span>, inferSchema = <span class="hljs-string">"true"</span>, header = <span class="hljs-string">"true"</span>)

df.show()
</code></pre><ol start="5">
<li>Select <code>movies</code> column</li>
</ol><pre><code class="wrap python hljs">filmsdf = df.select(<span class="hljs-string">"Movie"</span>)
filmsdf.show(truncate=<span class="hljs-literal">False</span>)
</code></pre><ol start="6">
<li>Build the pipeline</li>
</ol><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.ml <span class="hljs-keyword">import</span> Pipeline
<span class="hljs-keyword">from</span> pyspark.ml.feature <span class="hljs-keyword">import</span> CountVectorizer, HashingTF, IDF, Tokenizer, StopWordsRemover

<span class="hljs-comment"># Tokenize the movie titles</span>
tokenizer = Tokenizer(inputCol=<span class="hljs-string">"Movie"</span>, outputCol=<span class="hljs-string">"words"</span>)

<span class="hljs-comment"># Remove the stop words</span>
swremoval = StopWordsRemover(inputCol=<span class="hljs-string">"words"</span>, outputCol=<span class="hljs-string">"stremoved"</span>)

<span class="hljs-comment"># Tokenize the movie titles</span>
vectorizer = CountVectorizer(inputCol=<span class="hljs-string">"stremoved"</span>, outputCol=<span class="hljs-string">"rawFeatures"</span>)
idf = IDF(inputCol=<span class="hljs-string">"rawFeatures"</span>, outputCol=<span class="hljs-string">"features"</span>)
pipeline = Pipeline(stages = [tokenizer, swremoval, vectorizer, idf])

model = pipeline.fit(filmsdf)

model.write().overwrite().save(<span class="hljs-string">"models/tfidfmodel"</span>)

model
</code></pre><div class="alert alert-info">
<p>HashingTF is also an algorithm used to generate the term frequency vectors but with some differences. HashingTF is irreversible and it is a dimensionality reduction algorithm with possible collisions.</p>
</div><ol start="7">
<li>Transform the data</li>
</ol><pre><code class="wrap python hljs">films = model.transform(filmsdf)

<span class="hljs-comment"># Show first ten transformed features of films</span>
films.show(<span class="hljs-number">10</span>)

<span class="hljs-comment"># Show first ten values of column `words`</span>
films.select(<span class="hljs-string">'words'</span>).show(<span class="hljs-number">10</span>, truncate = <span class="hljs-literal">False</span>)

<span class="hljs-comment"># Show first ten values of column `stremoved`</span>
films.select(<span class="hljs-string">'stremoved'</span>).show(<span class="hljs-number">10</span>, truncate = <span class="hljs-literal">False</span>)

<span class="hljs-comment"># Show first ten values of column `rawFeatures`</span>
films.select(<span class="hljs-string">'rawFeatures'</span>).show(<span class="hljs-number">10</span>, truncate = <span class="hljs-literal">False</span>)

<span class="hljs-comment"># Get the real values of the Spark DataFrame</span>
films.select(<span class="hljs-string">'rawFeatures'</span>).rdd.flatMap(<span class="hljs-keyword">lambda</span> x : x).map(<span class="hljs-keyword">lambda</span> x : x.toArray()).collect()

</code></pre><ol start="8">
<li>Get the total counts for each column</li>
</ol><pre><code class="wrap python hljs">
<span class="hljs-comment"># Getting the total count for each term</span>

total_counts = model.transform(filmsdf) \
    .select(<span class="hljs-string">'rawFeatures'</span>).rdd \
    .map(<span class="hljs-keyword">lambda</span> row: row[<span class="hljs-string">'rawFeatures'</span>].toArray()) \
    .reduce(<span class="hljs-keyword">lambda</span> x,y: [x[i]+y[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(y))])
total_counts
</code></pre><ol start="9">
<li>Get the vocabulary along with count</li>
</ol><pre><code class="wrap python hljs">
<span class="hljs-comment"># Get the vocabulary along with the counts</span>

vocabList = model.stages[<span class="hljs-number">2</span>].vocabulary
d = {<span class="hljs-string">'vocabList'</span>:vocabList,<span class="hljs-string">'counts'</span>:total_counts}

spark.createDataFrame(np.array(list(d.values())).T.tolist(),list(d.keys())).show()

</code></pre><ol start="10">
<li>Get the vectorized and raw representation of the movies data</li>
</ol><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.sql.types <span class="hljs-keyword">import</span> ArrayType, StringType

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">termsIdx2Term</span><span class="hljs-params">(vocabulary)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">termsIdx2Term</span><span class="hljs-params">(termIndices)</span>:</span>
        <span class="hljs-keyword">return</span> [vocabulary[int(index)] <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> termIndices]
    <span class="hljs-keyword">return</span> udf(termsIdx2Term, ArrayType(StringType()))

vectorizerModel = model.stages[<span class="hljs-number">2</span>]
vocabList = vectorizerModel.vocabulary
print(vocabList)

rawFeatures = model.transform(filmsdf).select(<span class="hljs-string">'rawFeatures'</span>)

<span class="hljs-keyword">from</span> pyspark.sql.functions <span class="hljs-keyword">import</span> udf
<span class="hljs-keyword">import</span> pyspark.sql.functions <span class="hljs-keyword">as</span> F
<span class="hljs-keyword">from</span> pyspark.sql.types <span class="hljs-keyword">import</span> StringType, DoubleType, IntegerType
indices_udf = udf(<span class="hljs-keyword">lambda</span> vector: vector.indices.tolist(), ArrayType(IntegerType()))
values_udf = udf(<span class="hljs-keyword">lambda</span> vector: vector.toArray().tolist(), ArrayType(DoubleType()))
rawFeatures.withColumn(<span class="hljs-string">'indices'</span>, indices_udf(F.col(<span class="hljs-string">'rawFeatures'</span>))) \
    .withColumn(<span class="hljs-string">'values'</span>, values_udf(F.col(<span class="hljs-string">'rawFeatures'</span>))) \
    .withColumn(<span class="hljs-string">"Terms"</span>, termsIdx2Term(vocabList)(<span class="hljs-string">"indices"</span>)).show()


</code></pre><h1 id="Linear-Regression"><a class="anchor hidden-xs" href="#Linear-Regression" title="Linear-Regression"><i class="fa fa-link"></i></a>Linear Regression</h1><p>We will predict the AudienceScore from <code>Movie</code>, <code>LeadStudio</code> and <code>RottenTomatoes</code> columns using Linear Regression from Spark MLlib.</p><h2 id="StringIndexer"><a class="anchor hidden-xs" href="#StringIndexer" title="StringIndexer"><i class="fa fa-link"></i></a>StringIndexer</h2><p>A label indexer that maps a string column of labels to an ML column of label indices. If the input column is numeric, we cast it to string and index the string values. The indices are in [0, numLabels). By default, this is ordered by label frequencies so the most frequent label gets index 0.</p><h2 id="OneHotEncoder"><a class="anchor hidden-xs" href="#OneHotEncoder" title="OneHotEncoder"><i class="fa fa-link"></i></a>OneHotEncoder</h2><p>A one-hot encoder that maps a column of category indices to a column of binary vectors, with at most a single one-value per row that indicates the input category index. For example with 5 categories, an input value of 2.0 would map to an output vector of [0.0, 0.0, 1.0, 0.0]. The last category is not included by default (configurable via dropLast), because it makes the vector entries sum up to one, and hence linearly dependent. So an input value of 4.0 maps to [0.0, 0.0, 0.0, 0.0].</p><h2 id="VectorAssembler"><a class="anchor hidden-xs" href="#VectorAssembler" title="VectorAssembler"><i class="fa fa-link"></i></a>VectorAssembler</h2><p>A feature transformer that merges multiple columns into a vector column.</p><h2 id="VectorIndexer"><a class="anchor hidden-xs" href="#VectorIndexer" title="VectorIndexer"><i class="fa fa-link"></i></a>VectorIndexer</h2><p>Class for indexing categorical feature columns in a dataset of Vector<br>
This has 2 usage modes:</p><ol>
<li>Automatically identify categorical features (default behavior)
<ul>
<li>This helps process a dataset of unknown vectors into a dataset with some continuous features and some categorical features. The choice between continuous and categorical is based upon a maxCategories parameter</li>
<li>Set maxCategories to the maximum number of categorical any categorical feature should have.</li>
<li>E.g.: Feature 0 has unique values {-1.0, 0.0}, and feature 1 values {1.0, 3.0, 5.0}. If maxCategories = 2, then feature 0 will be declared categorical and use indices {0, 1}, and feature 1 will be declared continuous.</li>
</ul>
</li>
<li>Index all features, if all features are categorical
<ul>
<li>If maxCategories is set to be very large, then this will build an index of unique values for all features.</li>
<li>Warning: This can cause problems if features are continuous since this will collect ALL unique values to the driver.</li>
<li>E.g.: Feature 0 has unique values {-1.0, 0.0}, and feature 1 values {1.0, 3.0, 5.0}. If maxCategories &gt;= 3, then both features will be declared categorical.</li>
</ul>
</li>
</ol><pre><code class="wrap python hljs"><span class="hljs-comment"># Select some features with the label</span>
dfvec = df.select([<span class="hljs-string">"Movie"</span>, <span class="hljs-string">"LeadStudio"</span>,  <span class="hljs-string">"RottenTomatoes"</span>, <span class="hljs-string">"AudienceScore"</span>])

<span class="hljs-comment"># Rename the label column</span>
dfvec = dfvec.withColumnRenamed(<span class="hljs-string">"AudienceScore"</span>,<span class="hljs-string">"label"</span>)

<span class="hljs-comment"># Separate the categorical features from numerical ones</span>
categoricalCols = [<span class="hljs-string">'Movie'</span>, <span class="hljs-string">'LeadStudio'</span>]
others = [c <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> dfvec.columns <span class="hljs-keyword">if</span> c <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> categoricalCols]

<span class="hljs-comment"># Drop the label from the features list</span>
others.remove(<span class="hljs-string">"label"</span>)

<span class="hljs-keyword">from</span> pyspark.ml <span class="hljs-keyword">import</span> Pipeline
<span class="hljs-keyword">from</span> pyspark.ml.feature <span class="hljs-keyword">import</span> StringIndexer, OneHotEncoder, VectorAssembler
<span class="hljs-keyword">from</span> pyspark.sql.functions <span class="hljs-keyword">import</span> col

<span class="hljs-comment"># Create String indexer to assign index for the string fields where each unique string will get a unique index</span>
<span class="hljs-comment"># String Indexer is required as an input for One-Hot Encoder </span>
<span class="hljs-comment"># We set the case as `skip` for any string out of the input strings</span>
indexers = [ StringIndexer(inputCol=c, outputCol=<span class="hljs-string">"{0}_indexed"</span>.format(c)).setHandleInvalid(<span class="hljs-string">"skip"</span>) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> categoricalCols ]

<span class="hljs-comment"># Encode the strings using One Hot encoding</span>
<span class="hljs-comment"># default setting: dropLast=True ==&gt; For example with 5 categories, an input value of 2.0 would map to an output vector of [0.0, 0.0, 1.0, 0.0]. The last category is not included by default (configurable via dropLast), because it makes the vector entries sum up to one, and hence linearly dependent. So an input value of 4.0 maps to [0.0, 0.0, 0.0, 0.0].</span>
encoders = [ OneHotEncoder(inputCol=indexer.getOutputCol(), outputCol=<span class="hljs-string">"{0}_encoded"</span>.format(indexer.getOutputCol())) <span class="hljs-keyword">for</span> indexer <span class="hljs-keyword">in</span> indexers ]

<span class="hljs-comment"># This will concatenate the input cols into a single column.</span>
assembler = VectorAssembler(inputCols=[encoder.getOutputCol() <span class="hljs-keyword">for</span> encoder <span class="hljs-keyword">in</span> encoders] + others, outputCol= <span class="hljs-string">"features"</span>)

<span class="hljs-comment"># You can create a pipeline to use only a single fit and transform on the data.</span>
pipeline = Pipeline(stages=indexers + encoders + [assembler])

<span class="hljs-comment"># Drop null values for any row contain NULL in any column</span>
dfvec = dfvec.na.drop()

<span class="hljs-comment"># Fit the pipeline ==&gt; This will call the fit functions for all transformers if exist</span>
model=pipeline.fit(dfvec)
<span class="hljs-comment"># Fit the pipeline ==&gt; This will call the transform functions for all transformers</span>
data = model.transform(dfvec)

<span class="hljs-comment"># We delete all features and keep only the features and label columns</span>
data = data.select([<span class="hljs-string">"features"</span>, <span class="hljs-string">"label"</span>])


<span class="hljs-keyword">from</span> pyspark.ml.regression <span class="hljs-keyword">import</span> LinearRegression
<span class="hljs-keyword">from</span> pyspark.ml.feature <span class="hljs-keyword">import</span> VectorIndexer
<span class="hljs-keyword">from</span> pyspark.ml.evaluation <span class="hljs-keyword">import</span> RegressionEvaluator

<span class="hljs-comment"># Automatically identify categorical features, and index them.</span>
<span class="hljs-comment"># We specify maxCategories so features with &gt; 4</span>
<span class="hljs-comment"># distinct values are treated as continuous.</span>
featureIndexer = VectorIndexer(inputCol=<span class="hljs-string">"features"</span>, outputCol=<span class="hljs-string">"indexedFeatures"</span>, maxCategories=<span class="hljs-number">4</span>).fit(data)
transformed = featureIndexer.transform(data)

<span class="hljs-comment"># Display the output Spark DataFrame</span>
transformed.show()


<span class="hljs-comment">#  split the data into 60% training and 40% test (it is not stratified)</span>
(trainingData, testData) = transformed.randomSplit([<span class="hljs-number">0.6</span>, <span class="hljs-number">0.4</span>])

<span class="hljs-comment"># Create Linear Regression Model</span>
lr = LinearRegression()

<span class="hljs-comment"># Add the last indexer with the model to the pipeline</span>
pipeline = Pipeline(stages=[featureIndexer, lr])

<span class="hljs-comment"># Fit the data to the pipeline stages</span>
model = pipeline.fit(trainingData)

<span class="hljs-comment"># Transform the data (Prediction)</span>
predictions = model.transform(testData)

<span class="hljs-comment"># Display the predictions</span>
predictions.show()

<span class="hljs-keyword">from</span> pyspark.ml.evaluation <span class="hljs-keyword">import</span> RegressionEvaluator 

<span class="hljs-comment"># Evaluate the performance of the model</span>
evaluator = RegressionEvaluator(labelCol=<span class="hljs-string">"label"</span>, predictionCol=<span class="hljs-string">"prediction"</span>, metricName=<span class="hljs-string">"rmse"</span>)
rmse = evaluator.evaluate(predictions)
print(<span class="hljs-string">"Root Mean Squared Error (RMSE) on test data = {}"</span>.format(rmse))
</code></pre><h1 id="Classification"><a class="anchor hidden-xs" href="#Classification" title="Classification"><i class="fa fa-link"></i></a>Classification</h1><p>Here we will build a decision tree classifier and train it to predict the result for the home team (WIN, LOSE, DRAW).</p><h2 id="Data-Description"><a class="anchor hidden-xs" href="#Data-Description" title="Data-Description"><i class="fa fa-link"></i></a>Data Description</h2><p>This dataset includes <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>44</mn><mo>,</mo><mn>341</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-697" style="width: 3.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.966em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1002.91em, 2.751em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-698"><span class="mn" id="MathJax-Span-699" style="font-family: MathJax_Main;">44</span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-701" style="font-family: MathJax_Main; padding-left: 0.164em;">341</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>44</mn><mo>,</mo><mn>341</mn></math></span></span><script type="math/tex" id="MathJax-Element-12">44,341</script></span> results of international football matches starting from the very first official match in <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1872</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-702" style="width: 2.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1001.94em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-703"><span class="mn" id="MathJax-Span-704" style="font-family: MathJax_Main;">1872</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1872</mn></math></span></span><script type="math/tex" id="MathJax-Element-13">1872</script></span> up to <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2022</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-705" style="width: 2.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.996em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.565em, 1001.94em, 2.535em, -999.997em); top: -2.368em; left: 0em;"><span class="mrow" id="MathJax-Span-706"><span class="mn" id="MathJax-Span-707" style="font-family: MathJax_Main;">2022</span></span><span style="display: inline-block; width: 0px; height: 2.373em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2022</mn></math></span></span><script type="math/tex" id="MathJax-Element-14">2022</script></span>. The matches range from FIFA World Cup to FIFI Wild Cup to regular friendly matches. The matches are strictly men’s full internationals and the data does not include Olympic Games or matches where at least one of the teams was the nation’s B-team, U-23 or a league select team.</p><p><strong>results.csv</strong> includes the following columns:</p><ul>
<li><strong>date</strong> - date of the match</li>
<li><strong>home_team</strong> - the name of the home team</li>
<li><strong>away_team</strong> - the name of the away team</li>
<li><strong>home_score</strong> - full-time home team score including extra time, not including penalty-shootouts</li>
<li><strong>away_score</strong> - full-time away team score including extra time, not including penalty-shootouts</li>
<li><strong>tournament</strong> - the name of the tournament</li>
<li><strong>city</strong> - the name of the city/town/administrative unit where the match was played</li>
<li><strong>country</strong> - the name of the country where the match was played</li>
<li><strong>neutral</strong> - TRUE/FALSE column indicating whether the match was played at a neutral venue</li>
</ul><p>You can download the dataset from <a href="https://raw.githubusercontent.com/aminebennaji19/FIFA-World-Cup-Qatar-2022/main/data/results.csv" target="_blank" rel="noopener">here</a>. For the dataset of scorers and shootouts you can check this <a href="https://www.kaggle.com/datasets/martj42/international-football-results-from-1872-to-2017" target="_blank" rel="noopener">Kaggle data card</a>.</p><h2 id="Read-the-data"><a class="anchor hidden-xs" href="#Read-the-data" title="Read-the-data"><i class="fa fa-link"></i></a>Read the data</h2><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.sql.types <span class="hljs-keyword">import</span> StructType, StructField, IntegerType, StringType, BooleanType, DateType

<span class="hljs-comment"># define a schema for the dataframe</span>
schema = StructType([
    StructField(<span class="hljs-string">"date"</span>, DateType(), nullable=<span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"home_team"</span>, StringType(), nullable=<span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"away_team"</span>, StringType(), nullable=<span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"home_score"</span>, IntegerType(), <span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"away_score"</span>, IntegerType(), <span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"tournament"</span>, StringType(), <span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"city"</span>, StringType(), <span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"country"</span>, StringType(), <span class="hljs-literal">False</span>),
    StructField(<span class="hljs-string">"neutral"</span>, BooleanType(), <span class="hljs-literal">False</span>),
])

<span class="hljs-comment">#read data</span>
df = spark.read.format(<span class="hljs-string">"csv"</span>).load(<span class="hljs-string">"results.csv"</span>, header = <span class="hljs-literal">True</span>, schema = schema)

df
</code></pre><p>We observe that nullable constraint is not preserved according to the defined schema and this result is related to a bug. We still can remove the nulls using dropna() in pyspark.sql.DataFrame.</p><pre><code class="wrap python hljs"><span class="hljs-comment"># away_score has some null values</span>

df.filter(<span class="hljs-string">"away_score is NULL"</span>)


<span class="hljs-comment"># drop all records which contain nulls</span>
df = df.na.drop()
df
</code></pre><h2 id="Feature-extraction"><a class="anchor hidden-xs" href="#Feature-extraction" title="Feature-extraction"><i class="fa fa-link"></i></a>Feature extraction</h2><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.ml.feature <span class="hljs-keyword">import</span> OneHotEncoder, StringIndexer, VectorAssembler, RobustScaler, MinMaxScaler
<span class="hljs-keyword">from</span> pyspark.ml <span class="hljs-keyword">import</span> Pipeline
<span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> functions <span class="hljs-keyword">as</span> F

<span class="hljs-comment"># Encoding the Labels of the boolean feature</span>
df = df.withColumn(<span class="hljs-string">'neutral'</span>, F.col(<span class="hljs-string">'neutral'</span>).cast(<span class="hljs-string">'integer'</span>))

<span class="hljs-comment">#   </span>
df = df.withColumn(<span class="hljs-string">'home_result'</span>,
                   F.when(F.col(<span class="hljs-string">'home_score'</span>) &gt; F.col(<span class="hljs-string">'away_score'</span>), <span class="hljs-string">'WIN'</span>)
                   .when(F.col(<span class="hljs-string">'home_score'</span>) &lt; F.col(<span class="hljs-string">'away_score'</span>),<span class="hljs-string">'LOSE'</span>)
                   .otherwise(<span class="hljs-string">'DRAW'</span>)
                   )

<span class="hljs-comment"># non-numerical features 'tournament',</span>
features = [<span class="hljs-string">'away_team'</span>, <span class="hljs-string">'home_team'</span>, <span class="hljs-string">'city'</span>, <span class="hljs-string">'country'</span>]

indexer = StringIndexer()
indexer.setInputCols(features)
features_idx = list(map(<span class="hljs-keyword">lambda</span> x : x + <span class="hljs-string">"_idx"</span>, features))
indexer.setOutputCols(features_idx)

encoders = []
<span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features_idx:
  encoders.append(OneHotEncoder(inputCol = f, outputCol=f + <span class="hljs-string">"_enc"</span>))



<span class="hljs-comment"># # We excluded date field</span>
<span class="hljs-comment"># # Scale the columns 'home_score' and 'away_score'</span>
score_assembler = VectorAssembler(
    inputCols = [<span class="hljs-string">'home_score'</span>, <span class="hljs-string">'away_score'</span>],
    outputCol=<span class="hljs-string">'score'</span>
    )


final_assembler = VectorAssembler(inputCols = [<span class="hljs-string">'score'</span>] + list(map(<span class="hljs-keyword">lambda</span> x : x + <span class="hljs-string">"_enc"</span>, features_idx)), outputCol = <span class="hljs-string">"features_unscaled"</span>)

scaler = MinMaxScaler(inputCol = <span class="hljs-string">"features_unscaled"</span>, outputCol = <span class="hljs-string">"features"</span>)

pipeline = Pipeline(stages = [indexer] + encoders + [score_assembler, final_assembler, scaler])


features_pipeline_model = pipeline.fit(df)

<span class="hljs-comment"># We need to save it for decoding these features later</span>
features_pipeline_model.write().overwrite().save(<span class="hljs-string">"features_pipeline_model"</span>)

df_enc = features_pipeline_model.transform(df)



<span class="hljs-comment"># Encode labels</span>
label = <span class="hljs-string">'home_result'</span>

<span class="hljs-comment"># index the labels</span>
indexer = StringIndexer()
indexer.setInputCol(label)
indexer.setOutputCol(<span class="hljs-string">'label'</span>)
label_idx_model = indexer.fit(df_enc)

<span class="hljs-comment"># Save indexer model</span>
label_idx_model.write().overwrite().save(<span class="hljs-string">"label_idx_model"</span>)

<span class="hljs-comment"># Apply the indexer</span>
df_labeled = label_idx_model.transform(df_enc)

df_proj = df_labeled.select(<span class="hljs-string">'features'</span>, <span class="hljs-string">'label'</span>)
df_proj


df_in = df_proj

<span class="hljs-comment"># check number of distinct classes</span>
print(<span class="hljs-string">"We have {} classes"</span>.format(df_in.select(<span class="hljs-string">'label'</span>).distinct().count()))
</code></pre><h2 id="Sampling"><a class="anchor hidden-xs" href="#Sampling" title="Sampling"><i class="fa fa-link"></i></a>Sampling</h2><pre><code class="wrap python hljs"><span class="hljs-comment"># This split is not stratified</span>
<span class="hljs-comment"># We do not have a stratified feature for split operation</span>
<span class="hljs-comment"># Can you build a stratified train-test split? :)</span>

trainRatio = <span class="hljs-number">0.8</span>

train_df, test_df = df_in.randomSplit([trainRatio, <span class="hljs-number">1</span> - trainRatio], seed = <span class="hljs-number">9</span>)

train_df.count(), test_df.count()
</code></pre><h2 id="Fit-the-classifier"><a class="anchor hidden-xs" href="#Fit-the-classifier" title="Fit-the-classifier"><i class="fa fa-link"></i></a>Fit the classifier</h2><pre><code class="wrap python hljs"><span class="hljs-keyword">from</span> pyspark.ml.classification <span class="hljs-keyword">import</span> DecisionTreeClassifier, LinearSVC

<span class="hljs-comment"># Fit and transform</span>

classifier = DecisionTreeClassifier()

model = classifier.fit(train_df)
model.write().overwrite().save(<span class="hljs-string">"spark_ml_model"</span>)

model
</code></pre><h2 id="Prediction"><a class="anchor hidden-xs" href="#Prediction" title="Prediction"><i class="fa fa-link"></i></a>Prediction</h2><pre><code class="wrap python hljs"><span class="hljs-comment"># predictions = model.transform(train_df)</span>
<span class="hljs-comment"># predictions</span>

predictions = model.transform(test_df)
predictions
</code></pre><h2 id="Evaluation"><a class="anchor hidden-xs" href="#Evaluation" title="Evaluation"><i class="fa fa-link"></i></a>Evaluation</h2><pre><code class="wrap python hljs"><span class="hljs-comment"># Evaluate using pyspark.ml.evaluation.MulticlassClassificationEvaluator</span>
<span class="hljs-keyword">from</span> pyspark.ml.evaluation <span class="hljs-keyword">import</span> MulticlassClassificationEvaluator

evaluator = MulticlassClassificationEvaluator()\
  .setLabelCol(<span class="hljs-string">"label"</span>)\
  .setPredictionCol(<span class="hljs-string">"prediction"</span>)\
  .setMetricName(<span class="hljs-string">"f1"</span>)

<span class="hljs-comment"># Check here more metrics</span>
<span class="hljs-comment"># https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.ml.evaluation.MulticlassClassificationEvaluator.html#pyspark.ml.evaluation.MulticlassClassificationEvaluator.metricName</span>

f1 = evaluator.evaluate(predictions)


f1
</code></pre><h2 id="Hyper-parameter-tuning-amp-Cross-validation"><a class="anchor hidden-xs" href="#Hyper-parameter-tuning-amp-Cross-validation" title="Hyper-parameter-tuning-amp-Cross-validation"><i class="fa fa-link"></i></a>Hyper-parameter tuning &amp; Cross validation</h2><pre><code class="wrap python hljs"><span class="hljs-comment"># Hyper-parameter tuning using Cross Validation</span>

<span class="hljs-keyword">from</span> pyspark.ml.tuning <span class="hljs-keyword">import</span> ParamGridBuilder, CrossValidator

grid = ParamGridBuilder()
grid = grid.addGrid(model.maxDepth, [<span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">10</span>]).build()

cv = CrossValidator(estimator = classifier, 
                    estimatorParamMaps = grid, 
                    evaluator = evaluator,
                    parallelism = <span class="hljs-number">5</span>,
                    numFolds=<span class="hljs-number">3</span>)

cvModel = cv.fit(train_df)
bestModel = cvModel.bestModel
bestModel
</code></pre><h3 id="prediction"><a class="anchor hidden-xs" href="#prediction" title="prediction"><i class="fa fa-link"></i></a>prediction</h3><pre><code class="wrap python hljs">predictions = bestModel.transform(test_df)
predictions
</code></pre><h3 id="Evaluation1"><a class="anchor hidden-xs" href="#Evaluation1" title="Evaluation1"><i class="fa fa-link"></i></a>Evaluation</h3><pre><code class="wrap python hljs"><span class="hljs-comment"># Evaluate using pyspark.ml.evaluation.MulticlassClassificationEvaluator</span>
<span class="hljs-keyword">from</span> pyspark.ml.evaluation <span class="hljs-keyword">import</span> MulticlassClassificationEvaluator

evaluator = MulticlassClassificationEvaluator()\
  .setLabelCol(<span class="hljs-string">"label"</span>)\
  .setPredictionCol(<span class="hljs-string">"prediction"</span>)\
  .setMetricName(<span class="hljs-string">"f1"</span>)

<span class="hljs-comment"># Check here more metrics</span>
<span class="hljs-comment"># https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.ml.evaluation.MulticlassClassificationEvaluator.html#pyspark.ml.evaluation.MulticlassClassificationEvaluator.metricName</span>

f1 = evaluator.evaluate(predictions)


f1
</code></pre><div class="alert alert-warning">
<p>You can continue learning classification, clustering, other ML models from the <a href="https://runawayhorse001.github.io/LearningApacheSpark/index.html" target="_blank" rel="noopener">book</a>.</p>
</div><h1 id="References"><a class="anchor hidden-xs" href="#References" title="References"><i class="fa fa-link"></i></a>References</h1><ul>
<li><a href="https://spark.apache.org" target="_blank" rel="noopener">Apache Spark</a></li>
<li><a href="https://matteding.github.io/2019/04/25/sparse-matrices/" target="_blank" rel="noopener">Formats of Sparse Matrices</a></li>
<li><a href="https://sparkbyexamples.com/pyspark-tutorial/" target="_blank" rel="noopener">Spark with Python (PySpark) Tutorial For Beginners</a></li>
</ul></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#Lab-5---Apache-Spark-MLlib" title="Lab 5 - Apache Spark MLlib">Lab 5 - Apache Spark MLlib</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Objectives" title="Objectives">Objectives</a></li>
<li><a href="#Hadoop-YARN" title="Hadoop YARN">Hadoop YARN</a><ul class="nav">
<li><a href="#Anatomy-of-Yarn" title="Anatomy of Yarn">Anatomy of Yarn</a></li>
<li><a href="#Steps-to-run-Yarn-application" title="Steps to run Yarn application">Steps to run Yarn application</a></li>
</ul>
</li>
<li><a href="#Run-spark-application-on-the-cluster" title="Run spark application on the cluster">Run spark application on the cluster</a></li>
<li><a href="#Apache-Spark-MLlib" title="Apache Spark MLlib">Apache Spark MLlib</a></li>
<li><a href="#Basic-data-structures-in-Spark-MLlib" title="Basic data structures in Spark MLlib">Basic data structures in Spark MLlib</a><ul class="nav">
<li><a href="#Local-vector" title="Local vector">Local vector</a><ul class="nav">
<li><a href="#Math-operations" title="Math operations">Math operations</a></li>
</ul>
</li>
<li><a href="#Local-matrix" title="Local matrix">Local matrix</a></li>
<li><a href="#Distributed-matrix" title="Distributed matrix">Distributed matrix</a><ul class="nav">
<li><a href="#RowMatrix-RDD-based" title="RowMatrix [RDD-based]">RowMatrix [RDD-based]</a></li>
<li><a href="#IndexedRowMatrix-RDD-based" title="IndexedRowMatrix [RDD-based]">IndexedRowMatrix [RDD-based]</a></li>
<li><a href="#CoordinateMatrix-RDD-based" title="CoordinateMatrix [RDD-based]">CoordinateMatrix [RDD-based]</a></li>
<li><a href="#BlockMatrix-RDD-based" title="BlockMatrix [RDD-based]">BlockMatrix [RDD-based]</a></li>
<li><a href="#Compressed-Sparse-Matrices-in-pysparkmllinalg" title="Compressed Sparse Matrices in pyspark.ml.linalg">Compressed Sparse Matrices in pyspark.ml.linalg</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#Feature-Extraction" title="Feature Extraction">Feature Extraction</a><ul class="nav">
<li><a href="#Pipeline" title="Pipeline">Pipeline</a></li>
<li class=""><a href="#Example-on-TF-IDF" title="Example on TF-IDF">Example on TF-IDF</a></li>
</ul>
</li>
<li class=""><a href="#Linear-Regression" title="Linear Regression">Linear Regression</a><ul class="nav">
<li class=""><a href="#StringIndexer" title="StringIndexer">StringIndexer</a></li>
<li class=""><a href="#OneHotEncoder" title="OneHotEncoder">OneHotEncoder</a></li>
<li class=""><a href="#VectorAssembler" title="VectorAssembler">VectorAssembler</a></li>
<li class=""><a href="#VectorIndexer" title="VectorIndexer">VectorIndexer</a></li>
</ul>
</li>
<li class=""><a href="#Classification" title="Classification">Classification</a><ul class="nav">
<li class=""><a href="#Data-Description" title="Data Description">Data Description</a></li>
<li class=""><a href="#Read-the-data" title="Read the data">Read the data</a></li>
<li><a href="#Feature-extraction" title="Feature extraction">Feature extraction</a></li>
<li><a href="#Sampling" title="Sampling">Sampling</a></li>
<li><a href="#Fit-the-classifier" title="Fit the classifier">Fit the classifier</a></li>
<li><a href="#Prediction" title="Prediction">Prediction</a></li>
<li><a href="#Evaluation" title="Evaluation">Evaluation</a></li>
<li><a href="#Hyper-parameter-tuning-amp-Cross-validation" title="Hyper-parameter tuning &amp; Cross validation">Hyper-parameter tuning &amp; Cross validation</a><ul class="nav">
<li><a href="#prediction" title="prediction">prediction</a></li>
<li><a href="#Evaluation1" title="Evaluation">Evaluation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li><a href="#Lab-5---Apache-Spark-MLlib" title="Lab 5 - Apache Spark MLlib">Lab 5 - Apache Spark MLlib</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Objectives" title="Objectives">Objectives</a></li>
<li><a href="#Hadoop-YARN" title="Hadoop YARN">Hadoop YARN</a><ul class="nav">
<li><a href="#Anatomy-of-Yarn" title="Anatomy of Yarn">Anatomy of Yarn</a></li>
<li><a href="#Steps-to-run-Yarn-application" title="Steps to run Yarn application">Steps to run Yarn application</a></li>
</ul>
</li>
<li><a href="#Run-spark-application-on-the-cluster" title="Run spark application on the cluster">Run spark application on the cluster</a></li>
<li><a href="#Apache-Spark-MLlib" title="Apache Spark MLlib">Apache Spark MLlib</a></li>
<li><a href="#Basic-data-structures-in-Spark-MLlib" title="Basic data structures in Spark MLlib">Basic data structures in Spark MLlib</a><ul class="nav">
<li><a href="#Local-vector" title="Local vector">Local vector</a><ul class="nav">
<li><a href="#Math-operations" title="Math operations">Math operations</a></li>
</ul>
</li>
<li><a href="#Local-matrix" title="Local matrix">Local matrix</a></li>
<li><a href="#Distributed-matrix" title="Distributed matrix">Distributed matrix</a><ul class="nav">
<li><a href="#RowMatrix-RDD-based" title="RowMatrix [RDD-based]">RowMatrix [RDD-based]</a></li>
<li><a href="#IndexedRowMatrix-RDD-based" title="IndexedRowMatrix [RDD-based]">IndexedRowMatrix [RDD-based]</a></li>
<li><a href="#CoordinateMatrix-RDD-based" title="CoordinateMatrix [RDD-based]">CoordinateMatrix [RDD-based]</a></li>
<li><a href="#BlockMatrix-RDD-based" title="BlockMatrix [RDD-based]">BlockMatrix [RDD-based]</a></li>
<li><a href="#Compressed-Sparse-Matrices-in-pysparkmllinalg" title="Compressed Sparse Matrices in pyspark.ml.linalg">Compressed Sparse Matrices in pyspark.ml.linalg</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#Feature-Extraction" title="Feature Extraction">Feature Extraction</a><ul class="nav">
<li><a href="#Pipeline" title="Pipeline">Pipeline</a></li>
<li class=""><a href="#Example-on-TF-IDF" title="Example on TF-IDF">Example on TF-IDF</a></li>
</ul>
</li>
<li class=""><a href="#Linear-Regression" title="Linear Regression">Linear Regression</a><ul class="nav">
<li class=""><a href="#StringIndexer" title="StringIndexer">StringIndexer</a></li>
<li class=""><a href="#OneHotEncoder" title="OneHotEncoder">OneHotEncoder</a></li>
<li class=""><a href="#VectorAssembler" title="VectorAssembler">VectorAssembler</a></li>
<li class=""><a href="#VectorIndexer" title="VectorIndexer">VectorIndexer</a></li>
</ul>
</li>
<li class=""><a href="#Classification" title="Classification">Classification</a><ul class="nav">
<li class=""><a href="#Data-Description" title="Data Description">Data Description</a></li>
<li class=""><a href="#Read-the-data" title="Read the data">Read the data</a></li>
<li><a href="#Feature-extraction" title="Feature extraction">Feature extraction</a></li>
<li><a href="#Sampling" title="Sampling">Sampling</a></li>
<li><a href="#Fit-the-classifier" title="Fit the classifier">Fit the classifier</a></li>
<li><a href="#Prediction" title="Prediction">Prediction</a></li>
<li><a href="#Evaluation" title="Evaluation">Evaluation</a></li>
<li><a href="#Hyper-parameter-tuning-amp-Cross-validation" title="Hyper-parameter tuning &amp; Cross validation">Hyper-parameter tuning &amp; Cross validation</a><ul class="nav">
<li><a href="#prediction" title="prediction">prediction</a></li>
<li><a href="#Evaluation1" title="Evaluation">Evaluation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><div class="toc-menu" style="">
    <a class="expand-toggle expand-all" href="#">Expand all</a>
    <a class="expand-toggle collapse-all" href="#" style="display: none;">Collapse all</a>
    <a class="back-to-top" href="#">Back to top</a>
    <a class="go-to-bottom" href="#">Go to bottom</a>
</div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.0/js/bootstrap.min.js" integrity="sha256-kJrlY+s09+QoWjpkOrXXwhxeaoDz9FW5SaxF8I0DibQ=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
